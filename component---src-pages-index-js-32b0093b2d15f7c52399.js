"use strict";(self.webpackChunkblog_jh8459_com=self.webpackChunkblog_jh8459_com||[]).push([[293],{5610:function(e,t,a){a.r(t),a.d(t,{default:function(){return f}});var r=a(4506),s=a(6540),n=a(4794),o=a(6462),l=a(6263),c=a(9141),u=a(7108),i=a(603),d=a(3287),h=a(1253);var v=a(3663);var f=function(e){var t,a;let{data:f}=e;const w=f.allMarkdownRemark.edges.map(e=>{let{node:t}=e;return new h.A(t)}),{author:g,language:m}=f.site.siteMetadata,p=null===(t=f.visitorStats)||void 0===t||null===(a=t.nodes)||void 0===a?void 0:a[0],b=["All"].concat((0,r.A)((e=>{const t=new Set;return e.forEach(e=>{let{categories:a}=e;return a.forEach(e=>t.add(e))}),(0,r.A)(t).sort((e,t)=>"featured"===e?-1:"featured"===t?1:0)})(w))),S=b.findIndex(e=>"featured"===e),{0:A,1:k}=(0,s.useState)(-1===S?0:S),C=(0,o.useLocation)(),E=new URLSearchParams(C.search).get("sort")||"date-desc",{0:D,1:L}=(0,s.useState)(E),M=(0,s.useCallback)((e,t)=>k(t),[]),R=(0,s.useCallback)(e=>{const t=e.target.value;L(t);const a=new URLSearchParams(C.search);a.set("sort",t),(0,n.navigate)(`${C.pathname}?${a.toString()}`,{replace:!0})},[C]),{0:_,1:x}=(0,s.useState)({}),{0:T,1:j}=(0,s.useState)(!0);(0,s.useEffect)(()=>{j(!0);const e=(0,c.C3)(l.A),t=(0,c.KR)(e,"posts");(0,c.Jt)(t).then(e=>{e.exists()&&x(e.val())}).catch(e=>{console.error("Firebase read failed: ",e)}).finally(()=>{j(!1)})},[]);const y=(0,s.useMemo)(()=>{const e=w.map(e=>{var t;return{...e,views:(null===(t=_[e.slug.replace(/\//g,"")])||void 0===t?void 0:t.views)||0}});switch(D){case"title-asc":return e.sort((e,t)=>e.title.localeCompare(t.title));case"views-desc":return e.sort((e,t)=>t.views-e.views);case"date-asc":return e.sort((e,t)=>new Date(e.date)-new Date(t.date));default:return e.sort((e,t)=>new Date(t.date)-new Date(e.date))}},[w,_,D]);return s.createElement(u.A,null,s.createElement(i.A,{title:"JHLog"}),s.createElement(d.A,{author:g,language:m,visitorStats:p}),s.createElement(v.A,{posts:y,onChange:M,tabs:b,tabIndex:A,showMoreButton:!0,defaultThumbnail:f.defaultThumbnail,sortType:D,onSortChange:R,loadingViews:T}))}}}]);
//# sourceMappingURL=component---src-pages-index-js-32b0093b2d15f7c52399.js.map