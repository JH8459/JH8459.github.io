"use strict";(self.webpackChunkblog_jh8459_com=self.webpackChunkblog_jh8459_com||[]).push([[293],{5610:function(e,t,a){a.r(t),a.d(t,{default:function(){return w}});var r=a(4506),s=a(6540),n=a(4794),o=a(6462),l=a(6263),c=a(9141),u=a(7108),d=a(603),i=a(2720),h=a(1253);var f=a(1181);var w=function(e){let{data:t}=e;const a=t.allMarkdownRemark.edges.map(e=>{let{node:t}=e;return new h.A(t)}),{author:w,language:g}=t.site.siteMetadata,m=["All"].concat((0,r.A)((e=>{const t=new Set;return e.forEach(e=>{let{categories:a}=e;return a.forEach(e=>t.add(e))}),(0,r.A)(t).sort((e,t)=>"featured"===e?-1:"featured"===t?1:0)})(a))),v=m.findIndex(e=>"featured"===e),{0:p,1:b}=(0,s.useState)(-1===v?0:v),A=(0,o.useLocation)(),S=new URLSearchParams(A.search).get("sort")||"date-desc",{0:k,1:C}=(0,s.useState)(S),E=(0,s.useCallback)((e,t)=>b(t),[]),D=(0,s.useCallback)(e=>{const t=e.target.value;C(t);const a=new URLSearchParams(A.search);a.set("sort",t),(0,n.navigate)(`${A.pathname}?${a.toString()}`,{replace:!0})},[A]),{0:L,1:M}=(0,s.useState)({}),{0:R,1:_}=(0,s.useState)(!0);(0,s.useEffect)(()=>{_(!0);const e=(0,c.C3)(l.A),t=(0,c.KR)(e,"posts");(0,c.Jt)(t).then(e=>{e.exists()&&M(e.val())}).catch(e=>{console.error("Firebase read failed: ",e)}).finally(()=>{_(!1)})},[]);const x=(0,s.useMemo)(()=>{const e=a.map(e=>{var t;return{...e,views:(null===(t=L[e.slug.replace(/\//g,"")])||void 0===t?void 0:t.views)||0}});switch(k){case"title-asc":return e.sort((e,t)=>e.title.localeCompare(t.title));case"views-desc":return e.sort((e,t)=>t.views-e.views);case"date-asc":return e.sort((e,t)=>new Date(e.date)-new Date(t.date));default:return e.sort((e,t)=>new Date(t.date)-new Date(e.date))}},[a,L,k]);return s.createElement(u.A,null,s.createElement(d.A,{title:"JHLog"}),s.createElement(i.A,{author:w,language:g}),s.createElement(f.A,{posts:x,onChange:E,tabs:m,tabIndex:p,showMoreButton:!0,defaultThumbnail:t.defaultThumbnail,sortType:k,onSortChange:D,loadingViews:R}))}}}]);
//# sourceMappingURL=component---src-pages-index-js-b7b0a4f99f91d1d21c27.js.map