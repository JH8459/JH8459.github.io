"use strict";(self.webpackChunkblog_jh8459_com=self.webpackChunkblog_jh8459_com||[]).push([[245],{3923:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});a(590),a(8895);var r=a(7116),n=a(758),s=a(477),o=a(61),l=a(4839),c=a(4402),u=a(1402),i=a(1688),d=a(5814),h=a(8067);var g=a(1449);var m=function(e){let{data:t}=e;const a=t.allMarkdownRemark.edges.map(e=>{let{node:t}=e;return new h.A(t)}),{author:m,language:f}=t.site.siteMetadata,w=["All"].concat((0,r.A)((e=>{const t=new Set;return e.forEach(e=>{let{categories:a}=e;return a.forEach(e=>t.add(e))}),(0,r.A)(t).sort((e,t)=>"featured"===e?-1:"featured"===t?1:0)})(a))),v=w.findIndex(e=>"featured"===e),{0:p,1:b}=(0,n.useState)(-1===v?0:v),A=(0,o.useLocation)(),S=new URLSearchParams(A.search).get("sort")||"date-desc",{0:k,1:C}=(0,n.useState)(S),E=(0,n.useCallback)((e,t)=>{b(t)},[]),T=(0,n.useCallback)(e=>{const t=e.target.value;C(t);const a=new URLSearchParams(A.search);a.set("sort",t),(0,s.navigate)(A.pathname+"?"+a.toString(),{replace:!0})},[A]),{0:D,1:L}=(0,n.useState)({}),{0:M,1:R}=(0,n.useState)(!0);(0,n.useEffect)(()=>{const e=(0,c.C3)(l.A),t=(0,c.KR)(e,"posts");(0,c.Jt)(t).then(e=>{e.exists()&&L(e.val())}).catch(e=>{console.error("Firebase read failed: ",e)}).finally(()=>{R(!1)})},[]);const _=(0,n.useMemo)(()=>{const e=a.map(e=>{var t;return Object.assign({},e,{views:(null===(t=D[e.slug.replace(/\//g,"")])||void 0===t?void 0:t.views)||0})});switch(k){case"title-asc":return e.sort((e,t)=>e.title.localeCompare(t.title));case"views-desc":return e.sort((e,t)=>{var a,r;return(null!==(a=t.views)&&void 0!==a?a:0)-(null!==(r=e.views)&&void 0!==r?r:0)});case"date-asc":return e.sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime());default:return e.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())}},[a,D,k]);return n.createElement(u.A,null,n.createElement(i.A,{title:"JHLog",pathname:A.pathname}),n.createElement(d.A,{author:m,language:f}),n.createElement(g.A,{posts:_,onChange:E,tabs:w,tabIndex:p,showMoreButton:!0,defaultThumbnail:t.defaultThumbnail,sortType:k,onSortChange:T,loadingViews:M}))}}}]);
//# sourceMappingURL=component---src-pages-index-tsx-5f12dd86c505d8c049ed.js.map