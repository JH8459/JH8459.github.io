"use strict";(self.webpackChunkblog_jh8459_com=self.webpackChunkblog_jh8459_com||[]).push([[555],{8986:function(e,t,a){a.r(t),a.d(t,{default:function(){return d}});a(590),a(8895);var s=a(758),r=a(227),n=a(61),l=a(4839),o=a(4402),c=a(1655),i=a(3942),u=a(6700);var m=function(e){let{title:t,subtitle:a}=e;return s.createElement("div",{className:"flex flex-col items-center justify-center mt-[30px] mb-[30px]"},s.createElement("h1",{className:"w-fit pb-[7px] mb-[15px] text-[40px] font-bold text-center border-b-[3px] border-[var(--primary-text-color)]"},t),s.createElement("p",{className:"pb-[10px] text-[20px] font-medium text-center"},a))},p=a(7442);var d=function(e){let{pageContext:t}=e;const{edges:a,currentCategory:d,defaultThumbnail:b,categories:f}=t,g=(0,n.useLocation)(),h=new URLSearchParams(g.search).get("sort")||"date-desc",{0:x,1:v}=(0,s.useState)(h),w=(0,s.useMemo)(()=>a.map(e=>{let{node:t}=e;return new u.A(t)}),[a]),C=(0,s.useMemo)(()=>f.findIndex(e=>e===d),[f,d]),E=(0,s.useCallback)((e,t)=>{if(0===t)return(0,r.navigate)("/posts");(0,r.navigate)("/posts/"+f[t])},[f]),S=(0,s.useCallback)(e=>{const t=e.target.value;v(t);const a=new URLSearchParams(g.search);a.set("sort",t),(0,r.navigate)(g.pathname+"?"+a.toString(),{replace:!0})},[g]),{0:k,1:y}=(0,s.useState)({}),{0:A,1:j}=(0,s.useState)(!0);(0,s.useEffect)(()=>{j(!0);const e=(0,o.C3)(l.A),t=(0,o.KR)(e,"posts");(0,o.Jt)(t).then(e=>{e.exists()&&y(e.val())}).catch(e=>{console.error("Firebase read failed: ",e)}).finally(()=>{j(!1)})},[]);const _=(0,s.useMemo)(()=>{const e=w.map(e=>{var t;return Object.assign({},e,{views:(null===(t=k[e.slug.replace(/\//g,"")])||void 0===t?void 0:t.views)||0})});switch(x){case"title-asc":return e.sort((e,t)=>e.title.localeCompare(t.title));case"views-desc":return e.sort((e,t)=>t.views-e.views);default:return e.sort((e,t)=>new Date(t.date)-new Date(e.date))}},[w,k,x]);return s.createElement(c.A,null,s.createElement(i.A,{title:"Posts"}),s.createElement(m,{title:f[C],subtitle:w.length+" posts"}),s.createElement(p.A,{tabIndex:C,onChange:E,tabs:f,posts:_,defaultThumbnail:b,sortType:x,onSortChange:S,loadingViews:A}))}}}]);
//# sourceMappingURL=component---src-templates-category-template-js-fc66bb4bd071aca2f81d.js.map