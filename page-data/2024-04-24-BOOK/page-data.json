{"componentChunkName":"component---src-templates-blog-template-js","path":"/2024-04-24-BOOK/","result":{"data":{"cur":{"id":"a6da3518-701a-5046-be47-48cf2c1a4781","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 130.55555555555557%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAaABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAIDBAUB/8QAFgEBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAHSW9mZaJGU9S9wQkK//8QAHRAAAgEEAwAAAAAAAAAAAAAAAQIDABESEwQQIv/aAAgBAQABBQK7XLEUoIFciSzQPsi9ZzQ5NGmtBRA6/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFREBAQAAAAAAAAAAAAAAAAAAASD/2gAIAQIBAT8BY//EAB4QAAIBBAMBAAAAAAAAAAAAAAABMQIRIUEQIDJR/9oACAEBAAY/Apc/D0zLvxZaFUyMEyhUrXT/xAAcEAEAAgIDAQAAAAAAAAAAAAABABEhMRBBUYH/2gAIAQEAAT8hygmAljeNSiWPalPrFsHv9ibY7i4gY7ma8iQ3VnbgzKEDc//aAAwDAQACAAMAAAAQ0yi8/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAR/9oACAEDAQE/EAJk/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAEREDH/2gAIAQIBAT8QSIXCZ//EACAQAQEAAgEDBQAAAAAAAAAAAAERACExQVFxYYGRocH/2gAIAQEAAT8QRM9gNznu4Va0ner0MgWTyjWUXRnFegh5X2yM0kR1Rl+sMH9y3dykYUQXsU+ca5ZERar+4QsA28ecAUmBU9bgDAFazP/Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"book.jpeg\"\n        title=\"book.jpeg\"\n        src=\"/static/66ce7b2175da692122a2ebe6bada9cc5/80e3c/book.jpg\"\n        srcset=\"/static/66ce7b2175da692122a2ebe6bada9cc5/4ec73/book.jpg 180w,\n/static/66ce7b2175da692122a2ebe6bada9cc5/158ba/book.jpg 360w,\n/static/66ce7b2175da692122a2ebe6bada9cc5/80e3c/book.jpg 720w,\n/static/66ce7b2175da692122a2ebe6bada9cc5/4d836/book.jpg 920w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<br>\n<h2 id=\"-독서후기\" style=\"position:relative;\"><a href=\"#-%EB%8F%85%EC%84%9C%ED%9B%84%EA%B8%B0\" aria-label=\" 독서후기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📓 독서후기</h2>\n<hr>\n<p><strong>「좋은 코드, 나쁜 코드」</strong> 독서 후기</p>\n<ul>\n<li>\n<p><strong>PART 1. 이론</strong></p>\n<ul>\n<li>1장. 코드 품질</li>\n<li>2장. 추상화 계층</li>\n<li>3장. 다른 개발자와 코드 계약</li>\n<li>4장. 오류</li>\n</ul>\n</li>\n<li>\n<p><strong>PART 2. 실전</strong></p>\n<ul>\n<li>5장. 가독성 높은 코드를 작성하라</li>\n<li>6장. 예측 가능한 코드를 작성하라</li>\n</ul>\n</li>\n</ul>\n<br>\n<br>\n<p>위 기재된 챕터들을 독서한 뒤 블로그에 후기로 정리까지 해보려한다.</p>\n<p>많은 이가 그러하였듯이, 나 또한 개발 서적 중 처음 읽고 독서 후기로 남긴 도서가 <strong>「Clean Code」</strong> 였다.</p>\n<br>\n<hr>\n<details>\n<summary><strong>「Clean Code」 독서 후기 바로가기</strong></summary>\n<ul>\n<li>\n<p>🔗 <a href=\"https://blog.jh8459.com/2023-03-20-BOOK/\" target=\"_blank\">Clean Code - 1</a></p>\n</li>\n<li>\n<p>🔗 <a href=\"https://blog.jh8459.com/2023-04-02-BOOK/\" target=\"_blank\">Clean Code - 2</a></p>\n</li>\n<li>\n<p>🔗 <a href=\"https://blog.jh8459.com/2023-04-09-BOOK/\" target=\"_blank\">Clean Code - 3</a></p>\n</li>\n<li>\n<p>🔗 <a href=\"https://blog.jh8459.com/2023-04-16-BOOK/\" target=\"_blank\">Clean Code - 4</a></p>\n</li>\n</ul>\n</details>\n<hr>\n<br>\n<p>6장까지 읽은 후기를 한줄로 요약하자면, <strong>「Clean Code」</strong> 와 유사하다는 생각이 많이 들었다. (<del>아직 모두 읽진 못하였지만!</del>)</p>\n<p>하지만, 이 책의 저자는 자신의 주장을 풀어나가는 방식이 조금 달랐다. 어떻게 다른지에 대하여 자세한 내용은 아래에 기재하였다.</p>\n<br>\n<br>\n<h3 id=\"1장-코드-품질\" style=\"position:relative;\"><a href=\"#1%EC%9E%A5-%EC%BD%94%EB%93%9C-%ED%92%88%EC%A7%88\" aria-label=\"1장 코드 품질 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1장. 코드 품질</h3>\n<hr>\n<p>코드 품질이 중요한 이유(<del>당연하지만! 조금 더 구체적으로</del>)에 대해 다루며, 좋은 코드 품질을 가진 소프트웨어가 중장기적으로 가져오는 베네핏에 대해 강조한다.</p>\n<p>1장을 한줄로 요약하자면 다음과 같다고 느꼈다.</p>\n<br>\n<blockquote>\n<p>“서두르지 않으면 더 빠르다.”</p>\n</blockquote>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 143.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAdABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHuRYFgYjZiP//EABkQAQADAQEAAAAAAAAAAAAAAAABEiERIP/aAAgBAQABBQLGOQn1ddd//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAFhAAAwAAAAAAAAAAAAAAAAAAADBB/9oACAEBAAY/AiL/AP/EABsQAAIDAAMAAAAAAAAAAAAAAAABETFRIEGB/9oACAEBAAE/IWk6RGAoKRY84ywlhLD/2gAMAwEAAgADAAAAEPAPPP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EAB0QAQACAgIDAAAAAAAAAAAAAAEAEWGREFEhMfH/2gAIAQEAAT8QcreT4EUHURUKBvshkah6lD5SUdcYu5i7mDuf/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img1.jpeg\"\n        title=\"img1.jpeg\"\n        src=\"/static/04c34516bce0f7d848dca1f2d0a37733/80e3c/img1.jpg\"\n        srcset=\"/static/04c34516bce0f7d848dca1f2d0a37733/4ec73/img1.jpg 180w,\n/static/04c34516bce0f7d848dca1f2d0a37733/158ba/img1.jpg 360w,\n/static/04c34516bce0f7d848dca1f2d0a37733/80e3c/img1.jpg 720w,\n/static/04c34516bce0f7d848dca1f2d0a37733/47311/img1.jpg 1080w,\n/static/04c34516bce0f7d848dca1f2d0a37733/644c5/img1.jpg 1440w,\n/static/04c34516bce0f7d848dca1f2d0a37733/c06f5/img1.jpg 1668w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<center><strong>\"좋은 코드, 나쁜 코드\"</strong> page.25</center><br>\n<br>\n<p>1장은 이 책의 저자가 얘기하고자하는 주제인 “고품질 코드”의 중요성에 대해 언급한다.</p>\n<p>신뢰할 수 있으며, 유지보수가 용이하고 버그가 거의 없는 소프트웨어를 이루는 코드에 대해서 뻔하지만 중요한 이야기가 주된 내용이었다.</p>\n<br>\n<br>\n<h3 id=\"2장-추상화-계층\" style=\"position:relative;\"><a href=\"#2%EC%9E%A5-%EC%B6%94%EC%83%81%ED%99%94-%EA%B3%84%EC%B8%B5\" aria-label=\"2장 추상화 계층 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2장. 추상화 계층</h3>\n<hr>\n<p>이번 장은 추상화에 대한 근거있는 서술과 다양한 예시가 좋았다.</p>\n<p>이 책의 큰 장점이라하면, 다양한 예시가 특정언어로 편향되어 쓰여지지 않았다. 다양한 언어에서 아이디어를 차용한 <strong>의사코드(pseudocode)</strong>를 사용한다는게 가장 큰 장점이라 생각한다.</p>\n<p>2장은 다양한 예시(너무 큰 클래스 ~ 층이 너무 얇은 클래스)를 토대로 각각의 장단점을 꼬집는다.</p>\n<p><strong>「Clean Code」</strong> 와 비교하면(<del>계속 비교할 예정이다..</del>) 논란이 있을 만한 주제를 설명할 때는 적당한 예제와 함께 독자들을 이해시켜준다.</p>\n<p>그리고 저자의 주장은 <strong>“여러 방법론 중 하나일 뿐”</strong>이라 끊임없이 주장한다.</p>\n<p>이번 장에서 이 책이 가진 성격(?)을 고스란히 느낄 수 있었던것 같다.</p>\n<br>\n<br>\n<h3 id=\"3장-다른-개발자와-코드-계약\" style=\"position:relative;\"><a href=\"#3%EC%9E%A5-%EB%8B%A4%EB%A5%B8-%EA%B0%9C%EB%B0%9C%EC%9E%90%EC%99%80-%EC%BD%94%EB%93%9C-%EA%B3%84%EC%95%BD\" aria-label=\"3장 다른 개발자와 코드 계약 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3장. 다른 개발자와 코드 계약</h3>\n<hr>\n<p>3장부터는 “개발론”에 대한 내용이 주된 내용이었던거 같다.</p>\n<p>다른 개발자..라고 지칭하였지만, 이는 나 자신과의 계약이기도 한다.</p>\n<br>\n<blockquote>\n<p>“자신이 작성한 코드라도 1년 후에는 자세한 내용을 잊어버릴 가능성이 크다. 미래의 자신은 본질적으로 다른 개발자라고 간주해야 한다.”</p>\n</blockquote>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 143.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAdABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEDAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB7g0M0GXIixEr/8QAGRAAAgMBAAAAAAAAAAAAAAAAAAEQEiER/9oACAEBAAEFAsMOIcubFi5//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAFxABAAMAAAAAAAAAAAAAAAAAMQAQMP/aAAgBAQAGPwIxIV//xAAcEAACAgIDAAAAAAAAAAAAAAAAATFxECFhgaH/2gAIAQEAAT8haRwKeHAhtydoRLNRUUP/2gAMAwEAAgADAAAAEJMCjP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EABsQAQACAwEBAAAAAAAAAAAAAAEAESExkXGh/9oACAEBAAE/EKh8IDdSBizlKtB6wWQQB3DYgFZTsxWI320pAQa9n//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img2.jpeg\"\n        title=\"img2.jpeg\"\n        src=\"/static/a43925a9c3bba8ee9a313429d8718735/80e3c/img2.jpg\"\n        srcset=\"/static/a43925a9c3bba8ee9a313429d8718735/4ec73/img2.jpg 180w,\n/static/a43925a9c3bba8ee9a313429d8718735/158ba/img2.jpg 360w,\n/static/a43925a9c3bba8ee9a313429d8718735/80e3c/img2.jpg 720w,\n/static/a43925a9c3bba8ee9a313429d8718735/47311/img2.jpg 1080w,\n/static/a43925a9c3bba8ee9a313429d8718735/644c5/img2.jpg 1440w,\n/static/a43925a9c3bba8ee9a313429d8718735/c06f5/img2.jpg 1668w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<center><strong>\"좋은 코드, 나쁜 코드\"</strong> page.61</center><br>\n<br>\n<p>이 구문을 읽고 다음날 (<del>하필 오늘..</del>) 21개월 전 코드를 수정하다 경악을 금치 못하였다..</p>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 293px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACa0lEQVQoz11R2ZKaABDkKza7QQ6P8gABwQNUTpVDFxE2rsdWdN2kkjzm/196UrJHUnnomp6ZfpieZlJ/h6Vd0Gg4hxOeYM/28OMLnPAM093CcraI/AwPuwO2+ycE4QoDXcMhneC4nmITmjgXLk65g8sXF4xhGCQ1ZcTmCNl0jKU5gqf3kU8tel642Hk2JqqGR8/GzreRTSwMJAXNWgudehutWgvtWhOdRqfkTEtpUrPZwUhTYekKrIEGa6BjGdgoIo8i16KB0SN7qFHi9MkZ6aQqXeooCsmaRrKqUlc3qC1JpGgqMb2+gpm5ImeQkKIYWGVr7I5HHE5nnL7/oK+XFxT7J8yDKb4dFvACD36SYfvzN+6PF8zvN9icfyHKd3h+eQHTN8e0KnbYH/fY7veYrQrMXJVEQaR6vYZ6vV6i0Wi84srfZvVaDbUS1Q8d01U0TBwfwWwG1/MwHNuwhhIJgohqtQpR/Fvf+b/z/3tGEHjc3t3Qp9sbqrAscexnurtjXzlXIYHniWVZEgSBeJ4nrlIhjuNIvPYcV/JKpfKxYyRVJnuwIG8YUrPVI7nXRxRHeHjcYl0UmIUR1nmBrqrCGo8RL5cI5nO0JRnWZAIvCBAlCcIkwX2WgVF6KgInQuCEMAYWzKmDLM/hzmPYzhTOdAQ38KEPR3A8D4s4xjJNMfV8zMMQE9vG0DShGwbM8RiMJMtYJBHSPMM63yDdZAjjBEKnTz2lRbtlnyS5Q/rQxCq9Ly8J4xjpZkPFdkv+IiJerJZ2r9YZURRL/zzP41rfflU++BoMx4uoiiIEQShR6jkOLMuWuGqvSb+H8wcOQWOT3PCjswAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img3.png\"\n        title=\"img3.png\"\n        src=\"/static/d787ef10fd29325ffd2bbc89eeda9c7b/3cf3e/img3.png\"\n        srcset=\"/static/d787ef10fd29325ffd2bbc89eeda9c7b/e9ff0/img3.png 180w,\n/static/d787ef10fd29325ffd2bbc89eeda9c7b/3cf3e/img3.png 293w\"\n        sizes=\"(max-width: 293px) 100vw, 293px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<center><del>뭐지 이 애니스크립트 + 구조분해 할당은..😮‍💨</del></center><br>\n<br>\n<p>내가 쓴 코드가 맞나 싶어 <a href=\"https://www.gitkraken.com/gitlens\" target=\"_blank\">GitLens</a>를 통해 보니 내가 맞네..?? <del>21개월 전의 나의 무지가 드러나서 너무 뼈아프게 다가왔다. 🥲</del></p>\n<p>이 코드를 공유하며, 코드 리뷰를 통해 이런 코드들이 코드베이스에 병합되지 않게끔 팀원 모두 노력하자 다짐할 수 있는 계기가 되어 오히려(?) 좋았다.</p>\n<br>\n<br>\n<h3 id=\"4장-오류\" style=\"position:relative;\"><a href=\"#4%EC%9E%A5-%EC%98%A4%EB%A5%98\" aria-label=\"4장 오류 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4장. 오류</h3>\n<hr>\n<p>중요한 이야기를 담은 장이었다.</p>\n<p>저자도 이번 4장은 초입부터 길게 풀어 쓰겠다 미리 선전포고(?)를 했다.</p>\n<p>내용은 비록 길었지만 전달하고자하는 주된 내용들을 요약하자면 다음과 같았다.</p>\n<ul>\n<li>복구할 수 있는 오류와 복구할 수 없는 오류를 구분하여 처리하라.</li>\n<li>요란하게 실패하라.</li>\n<li>명시적으로 오류를 전달하라.</li>\n<li>(부록) 컴파일러 경고를 무시하지 말라.</li>\n</ul>\n<p>이 외에도 역시나 저자는 중론을 지킨다. “암시적으로 오류를 전달하는 방법”에 대해서도 소개하고 그 둘의 장단점을 꼬집는다. (<del>이젠 익숙하다</del>)</p>\n<p>다만, 위 내용을 주된 방법론이라 설명하며 그 근거에 대해서 구체적으로 서술한다.</p>\n<p>그리고 나 또한 저자의 생각과 같으며, 같은 방법론으로 예외의 상황을 처리하고 있다.</p>\n<br>\n<br>\n<h3 id=\"5장-가독성-높은-코드를-작성하라\" style=\"position:relative;\"><a href=\"#5%EC%9E%A5-%EA%B0%80%EB%8F%85%EC%84%B1-%EB%86%92%EC%9D%80-%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%9E%91%EC%84%B1%ED%95%98%EB%9D%BC\" aria-label=\"5장 가독성 높은 코드를 작성하라 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5장. 가독성 높은 코드를 작성하라</h3>\n<hr>\n<p>이번 5장 또한 <strong>「Clean Code」</strong> 와 비교하면(<del>그렇다, 또 나왔다.</del>) 전혀 다른 방향으로 방법론을 제시한다.</p>\n<p>바로 “주석”에 대한 내용이다.</p>\n<br>\n<blockquote>\n<p>“클래스와 같이 큰 단위의 코드가 무엇을 하는지 요약하는 높은 수준에서의 주석문은 유용하다.”</p>\n</blockquote>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 143.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAdABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEDAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB7g2I0GSai5Er/8QAGRABAAMBAQAAAAAAAAAAAAAAAAEREiAh/9oACAEBAAEFAqeKhPW223//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAXEAEBAQEAAAAAAAAAAAAAAAAxABAw/9oACAEBAAY/AiI4Gf/EAB4QAAIBAwUAAAAAAAAAAAAAAAABERAxUSFBYYHw/9oACAEBAAE/IWi2EBwC653RrUh+dJYE7EsH/9oADAMBAAIAAwAAABCDD4z/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxAh/8QAHBABAAICAwEAAAAAAAAAAAAAAQARIYFRYZGh/9oACAEBAAE/EGsJqch8gxfwgwpEEOWpY5IyEL3Oj6gIFxIuvsUqhudD2f/Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img5.jpeg\"\n        title=\"img5.jpeg\"\n        src=\"/static/29d76521a01e722706a08e45eb911fa3/80e3c/img5.jpg\"\n        srcset=\"/static/29d76521a01e722706a08e45eb911fa3/4ec73/img5.jpg 180w,\n/static/29d76521a01e722706a08e45eb911fa3/158ba/img5.jpg 360w,\n/static/29d76521a01e722706a08e45eb911fa3/80e3c/img5.jpg 720w,\n/static/29d76521a01e722706a08e45eb911fa3/47311/img5.jpg 1080w,\n/static/29d76521a01e722706a08e45eb911fa3/644c5/img5.jpg 1440w,\n/static/29d76521a01e722706a08e45eb911fa3/c06f5/img5.jpg 1668w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<center><strong>\"좋은 코드, 나쁜 코드\"</strong> page.127</center><br>\n<br>\n<p><strong>「Clean Code」</strong> 에서는 “주석”은 다음과 같이 표현된다.</p>\n<ul>\n<li>주석이 필요한 코드는 잘못 쓰여진 코드이다.</li>\n</ul>\n<br>\n<p>이번 책에서는 올바른 “주석” 사용법에 대해 몇가지 예시로 독자들을 설득한다.</p>\n<p>그 중 공감이 가고, 실제로 도입하고 싶은 “주석” 사용 예시를 가져와보았다.</p>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 143.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAdABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAIDAQX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB9xPYpSpZjZiP/8QAGxAAAgEFAAAAAAAAAAAAAAAAABIBEBEgITH/2gAIAQEAAQUC1S0E9xYYc//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABcQAQEBAQAAAAAAAAAAAAAAADEAEDD/2gAIAQEABj8CIjgZ/8QAHBAAAgICAwAAAAAAAAAAAAAAAAEQcRExQWGB/9oACAEBAAE/IWk4GEepOtD2eRUqKH//2gAMAwEAAgADAAAAEFsADP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABURAQEAAAAAAAAAAAAAAAAAABEg/9oACAECAQE/EGP/xAAgEAACAgEDBQAAAAAAAAAAAAAAAREhMRBBkVFxgaHx/9oACAEBAAE/EGkegT1gfAFdkp8k1a4MHYdraKZtINkTeVeil08n/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img6.jpeg\"\n        title=\"img6.jpeg\"\n        src=\"/static/bd8179dcb4fd9467d283bc1b1a8e503d/80e3c/img6.jpg\"\n        srcset=\"/static/bd8179dcb4fd9467d283bc1b1a8e503d/4ec73/img6.jpg 180w,\n/static/bd8179dcb4fd9467d283bc1b1a8e503d/158ba/img6.jpg 360w,\n/static/bd8179dcb4fd9467d283bc1b1a8e503d/80e3c/img6.jpg 720w,\n/static/bd8179dcb4fd9467d283bc1b1a8e503d/47311/img6.jpg 1080w,\n/static/bd8179dcb4fd9467d283bc1b1a8e503d/644c5/img6.jpg 1440w,\n/static/bd8179dcb4fd9467d283bc1b1a8e503d/c06f5/img6.jpg 1668w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<center><strong>\"좋은 코드, 나쁜 코드\"</strong> page.130</center><br>\n<br>\n<p>주석에 바로 #XXX 같은 이슈 넘버를 언급하는 팁이었다.</p>\n<p>어떤 코드가 왜 존재하는지 이유를 설명하기란 비즈니스 히스토리와 연관있기 때문에 쉽지 않다. 주절 주절 길게 쓰기 보다 이슈 넘버를 언급하여 짧고 간결하게 남기는 팁이다.</p>\n<p>이건..한번 도입해볼만 하다 생각하여 토론장에서 팀원들에게 공유하였고, 이는 승인되어 써봄직한 로직 부분이 발견되면 도입해볼 예정이다. 👍</p>\n<br>\n<br>\n<h3 id=\"6장-예측-가능한-코드를-작성하라\" style=\"position:relative;\"><a href=\"#6%EC%9E%A5-%EC%98%88%EC%B8%A1-%EA%B0%80%EB%8A%A5%ED%95%9C-%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%9E%91%EC%84%B1%ED%95%98%EB%9D%BC\" aria-label=\"6장 예측 가능한 코드를 작성하라 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6장. 예측 가능한 코드를 작성하라</h3>\n<hr>\n<p>이번 장은 1장의 <strong>“코드 품질”</strong>과 유사하게 흘러갔다. (<del>앞선 5장 또한 마찬가지였지만!</del>)</p>\n<p>오용할 수 있는 코드의 양을 줄이고, 별도의 인수인계 없이 유지될 수 있는 코드를 작성하라는 내용이 주된 내용이었다.</p>\n<p>또한, <strong>열거형(enum)</strong> 자료형 처리에 대해 주의하라 강조하였다. (<del>열거형(enum) 자료형을 애용하기에 너무도 반가운 주제였다! 🤩</del>)</p>\n<p>최근 나도 아래와 같은 <strong>열거형(enum)</strong> 자료형을 수정한 적이 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">enum</span> GenderEnum <span class=\"token punctuation\">{</span>\n  <span class=\"token constant\">MAN</span> <span class=\"token operator\">=</span> <span class=\"token string\">'M'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">WOMAN</span> <span class=\"token operator\">=</span> <span class=\"token string\">'W'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">GENDERLESS</span> <span class=\"token operator\">=</span><span class=\"token string\">'NONE'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 추가된 열것값</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>시대가 바뀌며 당연하다 생각하는 것들이 더이상 당연하지 아닐 수 있다. 당연하다 생각하여 <strong>열거형(enum)</strong> 자료형으로 관리하는 것은 큰 오만이다.</p>\n<p>그러므로 열것값이 추가될 수 있음을 언제나 대비하는 코드를 습관화 하라 강조한다.</p>\n<p>실제 경험했던 사례라 크게 와 닿았다.</p>\n<br>\n<br>\n<h2 id=\"-understanding\" style=\"position:relative;\"><a href=\"#-understanding\" aria-label=\" understanding permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🤔 Understanding</h2>\n<hr>\n<p>앞서 읽은 <strong>「Clean Code」</strong> 와 다르게 이번 <strong>「좋은 코드, 나쁜 코드」</strong> 는 거북하지 않고 쉽게 읽혔다.</p>\n<p>앞서 읽은 책의 예시는 모두 <strong>Java</strong>로 구성되어 있기에 예제 코드를 보면 쉽게 흥미가 떨어졌다. 하지만, 이번 책의 예시들은 <strong>의사코드(pseudocode)</strong>로 구성되어 있으며, 예시로 드는 사례에서 또한 여러 언어들(Java, C++, JavaScript, TypeScript 등등..)을 포괄적으로 언급하여 흥미도가 높았던게 큰 장점이었다.</p>\n<br>\n<blockquote>\n<p>실제로 매직값 사례로 <strong>JavaScript</strong>의 <code class=\"language-text\">indexOf()</code> 함수의 -1 리턴값이 언급될 때는 눈이 동그라졌다. 😳</p>\n</blockquote>\n<br>\n<p>절반정도 읽고 난 후기로는 1~2년차 주니어들이 읽기에는 좋은 서적(<del>특히나, 유지보수 업무를 담당하고 있다면 더욱 더</del>)이라 생각한다.</p>\n<p>총 평을 말하기엔 아직 절반 가량의 분량이 남았기에 제대로 된 독서 후기는 마저 읽고 남겨보도록하겠다.</p>\n<br>\n<br>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#-%EB%8F%85%EC%84%9C%ED%9B%84%EA%B8%B0\">📓 독서후기</a></p>\n<ul>\n<li><a href=\"#1%EC%9E%A5-%EC%BD%94%EB%93%9C-%ED%92%88%EC%A7%88\">1장. 코드 품질</a></li>\n<li><a href=\"#2%EC%9E%A5-%EC%B6%94%EC%83%81%ED%99%94-%EA%B3%84%EC%B8%B5\">2장. 추상화 계층</a></li>\n<li><a href=\"#3%EC%9E%A5-%EB%8B%A4%EB%A5%B8-%EA%B0%9C%EB%B0%9C%EC%9E%90%EC%99%80-%EC%BD%94%EB%93%9C-%EA%B3%84%EC%95%BD\">3장. 다른 개발자와 코드 계약</a></li>\n<li><a href=\"#4%EC%9E%A5-%EC%98%A4%EB%A5%98\">4장. 오류</a></li>\n<li><a href=\"#5%EC%9E%A5-%EA%B0%80%EB%8F%85%EC%84%B1-%EB%86%92%EC%9D%80-%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%9E%91%EC%84%B1%ED%95%98%EB%9D%BC\">5장. 가독성 높은 코드를 작성하라</a></li>\n<li><a href=\"#6%EC%9E%A5-%EC%98%88%EC%B8%A1-%EA%B0%80%EB%8A%A5%ED%95%9C-%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%9E%91%EC%84%B1%ED%95%98%EB%9D%BC\">6장. 예측 가능한 코드를 작성하라</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-understanding\">🤔 Understanding</a></p>\n</li>\n</ul>\n</div>","excerpt":"📓 독서후기 「좋은 코드, 나쁜 코드」 독서 후기 PART 1. 이론 1장. 코드 품질 2장. 추상화 계층 3장. 다른 개발자와 코드 계약 4장. 오류 PART 2. 실전 5장. 가독성 높은 코드를 작성하라 6장. 예측 가능한 코드를 작성하라 위 기재된 챕터들을 독서한 뒤 블로그에 후기로 정리까지 해보려한다. 많은 이가 그러하였듯이, 나 또한 개발 서적 중 처음 읽고 독서 후기로 남긴 도서가 「Clean Code」 였다. 🔗 Clean Code - 1 🔗 Clean Code - 2 🔗 Clean Code - 3 🔗 Clean Code - 4 6장까지 읽은 후기를 한줄로 요약하자면, 「Clean Code」 와 유사하다는 생각이 많이 들었다. (아직 모두 읽진 못하였지만!) 하지만, 이 책의 저자는 자신의 주장을 풀어나가는 방식이 조금 달랐다. 어떻게 다른지에 대하여 자세한 내용은 아래에 기재하였다. 1장. 코드 품질 코드 품질이 중요한 이유(당연하지만! 조금 더 구체적으로)에 대해 …","frontmatter":{"date":"2024-04-24","title":"좋은 코드, 나쁜 코드 - 1","categories":"Book","author":"JH8459","emoji":"📖"},"fields":{"slug":"/2024-04-24-BOOK/"}},"next":{"id":"de533aa6-29bd-5e31-ad82-2c37d46b2aa5","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECA//EABUBAQEAAAAAAAAAAAAAAAAAAAAF/9oADAMBAAIQAxAAAAHSaSawD//EABYQAAMAAAAAAAAAAAAAAAAAAAABIP/aAAgBAQABBQIU/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAADAAAAAAAAAAAAAAAAAAAAIDH/2gAIAQEABj8CIv8A/8QAGBAAAgMAAAAAAAAAAAAAAAAAAAERIDH/2gAIAQEAAT8hGb2Ff//aAAwDAQACAAMAAAAQHD//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAACAwEAAAAAAAAAAAAAAAABEQAgQVH/2gAIAQEAAT8QjVhju1//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"github-blog.png\"\n        title=\"github-blog.png\"\n        src=\"/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/80e3c/TIL.jpg\"\n        srcset=\"/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/4ec73/TIL.jpg 180w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/158ba/TIL.jpg 360w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/80e3c/TIL.jpg 720w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/47311/TIL.jpg 1080w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/ac614/TIL.jpg 1272w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<br>\n<h2 id=\"️-today-i-learned\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-today-i-learned\" aria-label=\"️ today i learned permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✍️ <strong>T</strong>oday <strong>I</strong> <strong>L</strong>earned</h2>\n<hr>\n<p>다중 인스턴스로 구성된 환경에서 동시에 임계 자원에 접근하려는 상황(동시성)을 제어하기 위해 도입한 방법을 간략히 정리하고 공유하기 위해 글을 남긴다.</p>\n<br>\n<br>\n<h3 id=\"1-문제점\" style=\"position:relative;\"><a href=\"#1-%EB%AC%B8%EC%A0%9C%EC%A0%90\" aria-label=\"1 문제점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 문제점</h3>\n<hr>\n<p>현재 사내에서 사용중인 서비스 구성도는 아래 사진과 같다.</p>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 470px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB/ElEQVQoz32Sy27TUBCG/VpseA0WvAMbkFjACrHoBoln6IYNCCEkFhRRFq1UoAsgkJCGJE1zt3OzfXx8rv6Q7ZAWVTDSked4/jPzz8wfHLfGJJlGSEMsFLmy/DFtNDaX7L37xLPTFoVRGGO20WKHo6j9WGgC/mNKawrv6FxMGU3D+p9S/8SXxIJc14yklKRpihBid+I4rmJHh/t8PX1T+ZvN+i9M+SbP1SVDbVx1yaTEOYf3fnfKIqV9OfvGr2F3V/gqxjlfvd0lNNZXFyOS6y0rVRVZhSGLeYh1Dq31NZwW6bZlQ2C0YbqOufP8kF60Bmfx2yFb6/Basff2hP2TBoVWOF8TqL8Fx90h918fIZVmk0gCISRhkvKq1WORSbRSFZOKYa4w1vChO6YxW4L3u3lZa7Fa8XMccdDsY4wiWiYEwliKcUh69wn6Y4NyRXYrDWMtOk1pP3hI89Fj/JUtO2spx5XLKdl8gFeWZZwRpFKBtoT3niJevKdMZbWptKWdI1+veXnjJge3buOLy4RlsXIk5/Mhn89+kOWKVZmwbEHmGZPxCCEF3luKYrsolddSWS4QSS0ho7c6LDzWaPIsI5zN8FazigXB2SCi3Z/R7E5odSd0hwuG84RRlHI+WdMZhLQHc9rn88ofzDZVrMR0LiJavSnfO6MqR6sf8Rutb0XGT6KBTAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"architecture.png\"\n        title=\"architecture.png\"\n        src=\"/static/5d663c6ef87387829a1ca53f405f22e9/f96db/architecture.png\"\n        srcset=\"/static/5d663c6ef87387829a1ca53f405f22e9/e9ff0/architecture.png 180w,\n/static/5d663c6ef87387829a1ca53f405f22e9/f21e7/architecture.png 360w,\n/static/5d663c6ef87387829a1ca53f405f22e9/f96db/architecture.png 470w\"\n        sizes=\"(max-width: 470px) 100vw, 470px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<br>\n<p>이 구성도 내부에서 <strong>API Server</strong>는 Docker compose 환경에서 <code class=\"language-text\">replicas</code> 옵션으로 구성하여 쓰레드 갯수 만큼 다중 인스턴스 환경으로 구성되고 있다.</p>\n<p>여러개의 인스턴스로 구성되어 있기 때문에 스케쥴링 작업 등 여러개의 인스턴스가 동시에 같은 자원을 요구하는 작업에서 반복적인 에러가 리포팅되고 있었다.</p>\n<br>\n<br>\n<h3 id=\"2-해결방안\" style=\"position:relative;\"><a href=\"#2-%ED%95%B4%EA%B2%B0%EB%B0%A9%EC%95%88\" aria-label=\"2 해결방안 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 해결방안</h3>\n<hr>\n<p>우선 키워드를 먼저 언급하자면 <strong>“동시성 제어(concurrency control)”</strong>였다.</p>\n<p>비슷한 레퍼런스를 찾고자하니 많은 솔루션들이 나왔다.</p>\n<p>기억나는 솔루션 중 참고 될 만한 자료들은 링크로 따로 남겨두겠다.</p>\n<br>\n<blockquote>\n<p><a href=\"https://medium.com/nodejs-server/node-schedule-pm2-8f7831ed231e\" target=\"_blank\">🔗 PM2 환경에서 중복되지 않는 스케쥴링 구현</a></p>\n<p><a href=\"https://sg-choi.tistory.com/602\" target=\"_blank\">🔗 스프링 환경에서 스케쥴러 락 (ShedLock)</a></p>\n</blockquote>\n<br>\n<p>위 두가지 방법들이 대다수가 사용하는 솔루션이었다.</p>\n<p>각각 내포하는 뜻은 다음과 같다.</p>\n<br>\n<ol>\n<li><code class=\"language-text\">replicas</code> 옵션으로 복제된 각각의 인스턴스의 컨테이너 번호를 알아내어 특정 번호의 인스턴스만 실행되게 한다.</li>\n<li>스케쥴링 작업이 실행되기 전 우선권을 얻은 뒤 우선권을 얻은 인스턴스만 스케쥴링 작업이 실행되게 한다.</li>\n</ol>\n<br>\n<p><code class=\"language-text\">replicas</code> 옵션은 유동적으로 변하기도하고 각각 내부 인스턴스의 상황은 그때 그때 변하기 때문에 고정 번호의 인스턴스만 실행되게하는건 리스크가 있다 판단하였다. 따라서, 두번째 방향으로 리팩토링을 진행하였다.</p>\n<p>여러개의 인스턴스가 공통으로 사용하는 자원을 활용하여 우선권을 선점여부를 판단하여 “Lock”을 걸어야하므로 <strong>Redis</strong>를 활용하였다.</p>\n<p>스프링 환경의 <code class=\"language-text\">ShedLock</code> 기능과 유사한 <strong>“분산락”</strong>을 구현해보았다.</p>\n<br>\n<br>\n<h3 id=\"3-변경점\" style=\"position:relative;\"><a href=\"#3-%EB%B3%80%EA%B2%BD%EC%A0%90\" aria-label=\"3 변경점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 변경점</h3>\n<hr>\n<p>검색해보니 RedLock 알고리즘(권장) 등 이러한 분산 환경에서 쓰이는 여러 알고리즘들이 있다는걸 알게되었다.</p>\n<p>우선 현재 사용중인 스케줄링들은 정산이나 비용에 관련된 데이터 정합성에 아주 민감한 비즈니스 로직은 아니므로 간단한 알고리즘으로 구현해보았다.</p>\n<br>\n<ul>\n<li>\n<p><strong>redis.service.ts</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Injectable</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">RedisService</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">InjectRedis</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">private</span> redis<span class=\"token operator\">:</span> Redis<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// Lock 유지 시간 (5분)</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> lockDuration <span class=\"token operator\">=</span> <span class=\"token number\">60</span> <span class=\"token operator\">*</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">setLock</span><span class=\"token punctuation\">(</span>key<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token builtin\">string</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Lock 획득</span>\n    <span class=\"token keyword\">const</span> lock<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>redis<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> <span class=\"token string\">'LOCK'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'EX'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lockDuration<span class=\"token punctuation\">,</span> <span class=\"token string\">'NX'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> lock<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">unLock</span><span class=\"token punctuation\">(</span>key<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Lock 해제</span>\n    <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>redis<span class=\"token punctuation\">.</span><span class=\"token function\">del</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p><strong>scheduler.service.ts</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">Cron</span></span><span class=\"token punctuation\">(</span>CronExpression<span class=\"token punctuation\">.</span><span class=\"token constant\">MONDAY_TO_FRIDAY_AT_9PM</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">async</span> <span class=\"token function\">scheduler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> lockKey <span class=\"token operator\">=</span> <span class=\"token string\">'LOCK_KEY'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> lock <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>redisService<span class=\"token punctuation\">.</span><span class=\"token function\">setLock</span><span class=\"token punctuation\">(</span>lockKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>lock<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 스케쥴링 로직</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{</span> \n    <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>redisService<span class=\"token punctuation\">.</span><span class=\"token function\">unLock</span><span class=\"token punctuation\">(</span>lockKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n</ul>\n<br>\n<br>\n<h2 id=\"-understanding\" style=\"position:relative;\"><a href=\"#-understanding\" aria-label=\" understanding permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🤔 Understanding</h2>\n<hr>\n<p>코드 구현 난이도 자체는 높지 않았다.</p>\n<p>다만, “데이터의 정합성” 이라는 큰 개념아래에서 동시성을 제어하여야 한다는 걸 인지하지 못했다면 평생 해결하지 못할 이슈였다.</p>\n<p>분산 환경에서 고려해야할 것이 많다라는 점을 충분히 인지할 수 있었던 시간이었다.</p>\n<br>\n<br>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EF%B8%8F-today-i-learned\">✍️ <strong>T</strong>oday <strong>I</strong> <strong>L</strong>earned</a></p>\n<ul>\n<li><a href=\"#1-%EB%AC%B8%EC%A0%9C%EC%A0%90\">1. 문제점</a></li>\n<li><a href=\"#2-%ED%95%B4%EA%B2%B0%EB%B0%A9%EC%95%88\">2. 해결방안</a></li>\n<li><a href=\"#3-%EB%B3%80%EA%B2%BD%EC%A0%90\">3. 변경점</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-understanding\">🤔 Understanding</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"2024-04-21","title":"다중 인스턴스 환경에서 동시성을 해결하기 위한 Redis 분산락 구현하기","categories":"TIL","author":"JH8459","emoji":"📚"},"fields":{"slug":"/2024-04-21-TIL/"}},"prev":{"id":"86336a9d-12ba-5c7f-b2f4-9cc04d5aae7d","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECA//EABUBAQEAAAAAAAAAAAAAAAAAAAAF/9oADAMBAAIQAxAAAAHSaSawD//EABYQAAMAAAAAAAAAAAAAAAAAAAABIP/aAAgBAQABBQIU/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAADAAAAAAAAAAAAAAAAAAAAIDH/2gAIAQEABj8CIv8A/8QAGBAAAgMAAAAAAAAAAAAAAAAAAAERIDH/2gAIAQEAAT8hGb2Ff//aAAwDAQACAAMAAAAQHD//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAACAwEAAAAAAAAAAAAAAAABEQAgQVH/2gAIAQEAAT8QjVhju1//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"github-blog.png\"\n        title=\"github-blog.png\"\n        src=\"/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/80e3c/TIL.jpg\"\n        srcset=\"/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/4ec73/TIL.jpg 180w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/158ba/TIL.jpg 360w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/80e3c/TIL.jpg 720w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/47311/TIL.jpg 1080w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/ac614/TIL.jpg 1272w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<br>\n<h2 id=\"️-today-i-learned\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-today-i-learned\" aria-label=\"️ today i learned permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✍️ <strong>T</strong>oday <strong>I</strong> <strong>L</strong>earned</h2>\n<hr>\n<p>엘라스틱 서치를 이용한 검색 엔진을 도입하게 된 배경과 구현 과정의 프로세스에 대해서 간략히 정리하고 공유하기 위해 글을 남긴다.</p>\n<br>\n<br>\n<h3 id=\"1-elasticsearch\" style=\"position:relative;\"><a href=\"#1-elasticsearch\" aria-label=\"1 elasticsearch permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Elasticsearch?</h3>\n<hr>\n<p><strong>Elasticsearch</strong>는 아래와 같이 요약할 수 있다.</p>\n<ul>\n<li><strong>Elasticsearch</strong>는 Apache Lucene기반의 Java 오픈 소스 분산 검색 엔진이다.</li>\n<li><strong>Elasticsearch</strong>를 통해 방대한 양의 데이터를 신속하게(거의 실시간) 저장, 검색, 분석을 수행할 수 있다.</li>\n<li><strong>Elasticsearch</strong>는 검색 엔진으로 단독으로 사용되기도 하며, ELK(Elasticsearch / Logstash / Kibana) 스택으로 사용되기도 한다.</li>\n</ul>\n<p>위와 같은 특성 때문에 이러한 <strong>Elasticsearch</strong>는 대규모 로그 파일 관리나 실시간 검색 서비스 등과 같이 대용량 데이터를 빠르게 처리해야 하는 경우 유용하게 사용될 수 있다.</p>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABlElEQVQoz4WT6Y7jIBCE/f4PGSW7yjm2wZjDNMe3AieZ2ZkfY6lE0xTlUnczAFQq3z9nHVopFr3sWHZopamlvHkpJbz3lGduSDlTK5SaSTUhJRFLYnEO7ewnrO25xTpM8LgQiVLQi+Z0OpFz3gVbEOuGEcu4aiarmZ3GbCs+eZw41mBx0WGjfcJh4n6+qJnj8didisju0NvIOjviGslWSFbIoRB8xq4bdvWsNrA2l0qhppFlvOONQi8Lh8MBYwzOOYacMpvxZBdIzrJME9M48riduZ5P3C9/eFzPPO4XPm5XpmlknhV/zzcutxtKqy7YxGqtDJRCDJHVOEa98mE8xkfCJsiWSLEgAklApHZ4SWybI8lGCIF5nt9NGlpDjHFoG4hl73ZrWC2tUZWca//zf2iELJ3b6tbcxRh7HYecC7lkpJafF38DdKE2Nm3/HptUCtJtfZIb+zdBnoLW2h73Gqa8i5UvpLY2+22k2voa2per+oy/Cr74w36hEkWeQrnHMe618SHs+36+vwxJqcct9xJ6NeUf7PNbbjKQ70UAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"db_engine.png\"\n        title=\"db_engine.png\"\n        src=\"/static/b2ab561d880fb4aa7ea6820700a6606e/37523/db_engine.png\"\n        srcset=\"/static/b2ab561d880fb4aa7ea6820700a6606e/e9ff0/db_engine.png 180w,\n/static/b2ab561d880fb4aa7ea6820700a6606e/f21e7/db_engine.png 360w,\n/static/b2ab561d880fb4aa7ea6820700a6606e/37523/db_engine.png 720w,\n/static/b2ab561d880fb4aa7ea6820700a6606e/76823/db_engine.png 1038w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<center>검색엔진 중 독보적인 사용량을 자랑한다. 👍</center><br>\n<br>\n<p>세부적인 내용은 뒤로하고 이번 포스팅에선 <strong>ELK</strong>(Elasticsearch / Logstash / Kibana) 스택을 도입하게된 배경과 구현 과정의 프로세스에 대해서 간략히 남겨보도록하겠다.</p>\n<blockquote>\n<p>현재 시각화를 위한 Kibana는 아직 도입전이다. 추후 모든 ELK 스택 구현이 완성되면 다시 한번 포스팅을 남기도록하겠다.</p>\n</blockquote>\n<br>\n<br>\n<h3 id=\"2-elk-스택-도입-배경\" style=\"position:relative;\"><a href=\"#2-elk-%EC%8A%A4%ED%83%9D-%EB%8F%84%EC%9E%85-%EB%B0%B0%EA%B2%BD\" aria-label=\"2 elk 스택 도입 배경 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. ELK 스택 도입 배경</h3>\n<hr>\n<p>이전 포스팅 내용 중 회사에서 운영 중인 온라인 채용 서비스는 24시간 내내 실시간으로 응시자들의 문의사항들을 모니터링하고 있다는 사례를 공유한 적 있다.</p>\n<blockquote>\n<p><a href=\"https://blog.jh8459.com/2024-04-01-RETROSPECT/\" target=\"_blank\">백엔드 개발자 2년차 회고 🤔</a></p>\n</blockquote>\n<p>이렇게 쌓이는 Q&#x26;A들은 DB에 쌓고 정기적으로 분석하여 자주 묻는 질문(FAQ) 제작등에 활용되고 있다.</p>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABlElEQVQ4y31Ti3KEIAy8//9JvfOJ70MBX7CdjadjO22dWUmQbMImPgBgnmc8nzGyNMXrs9JP0wRZlgriOJJv3Hu9nmibhqEIwfONEIL4j5OwqhSstQLnLIwxsNbAie/EtuYDayXGew9nBrzfb9lb1/UgpNF2Heq6hipLlGUpVRVFjmEYLvJxHKFHLT5JSLpuG9q2FZ94HGUH9HWBpqrgrIPfdsm+bRuC9zwA+HCsd8jtnCTY9yNGCGnUVQHdd+iUQlU3aJXCPE2HNiEg+CDkBz52CBJ7fx6nmJLNOdHMOoeFGm0bvA/Yd4/7uZ8Pv524CKljnudomkY0oV6HRjuMW/4kPIlO+yKkBmxGnuVC2Pe9iHwP5PX8h8B7/43oGpvT4AESsKtd18mqtb7AGzDpHad+vxLyQFEUSJIESilkWS4J2GmS/affn01hA86rLMuCcdQysNST/n9kp3XNISu5X2VeFvQco64VaM1qV6n2wPJNQ9wJ2U3+o884QhRFSF4xhjaDMUd1rJLDy4qnaYIxk+z/RvgFjML1bedlfqgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"slack.png\"\n        title=\"slack.png\"\n        src=\"/static/408981fb0eab6d5d6603daf74b62cda8/37523/slack.png\"\n        srcset=\"/static/408981fb0eab6d5d6603daf74b62cda8/e9ff0/slack.png 180w,\n/static/408981fb0eab6d5d6603daf74b62cda8/f21e7/slack.png 360w,\n/static/408981fb0eab6d5d6603daf74b62cda8/37523/slack.png 720w,\n/static/408981fb0eab6d5d6603daf74b62cda8/302a4/slack.png 1080w,\n/static/408981fb0eab6d5d6603daf74b62cda8/07a9c/slack.png 1440w,\n/static/408981fb0eab6d5d6603daf74b62cda8/ade5e/slack.png 2188w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<center>한계 없이 DB에 쌓이는 무수한 데이터들..😮</center><br>\n<br>\n<p>기존 서비스는 SQL <code class=\"language-text\">LIKE</code> 쿼리를 이용한 검색 방식을 사용하고 있었다. 이는 띄어쓰기나 단어의 순서등 검색어가 정확히 일치해야했기 때문에 기능적인 측면에서 부족함이 많았다.</p>\n<p>또한, Q&#x26;A 테이블 특성상 한계없이 쌓이기 떄문에 이는 장기적으로 검색 속도에서도 저하가 올거라 예측되었기에 검색 엔진의 도입을 결정하게 되었다.</p>\n<p>독보적인 사용량과 수많은 레퍼런스를 자랑하는 Elasticsearch을 도입하지 않을 이유가 없었다.</p>\n<br>\n<br>\n<h3 id=\"3-elk-스택-도입-과정\" style=\"position:relative;\"><a href=\"#3-elk-%EC%8A%A4%ED%83%9D-%EB%8F%84%EC%9E%85-%EA%B3%BC%EC%A0%95\" aria-label=\"3 elk 스택 도입 과정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. ELK 스택 도입 과정</h3>\n<hr>\n<p><strong>Elasticsearch</strong>과 <strong>Logstash</strong>을 구축하는 과정을 자세하게 남겨보았다. (개발환경에 따라 구축하는 과정은 상이할 수 있기 때문에 참고만 하길 바란다.)</p>\n<br>\n<br>\n<h4 id=\"3-1-elasticsearch-구현\" style=\"position:relative;\"><a href=\"#3-1-elasticsearch-%EA%B5%AC%ED%98%84\" aria-label=\"3 1 elasticsearch 구현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3-1. Elasticsearch 구현</h4>\n<hr>\n<p>우선 간략히 요약하자면 아래와 같은 순서로 진행하였다.</p>\n<ul>\n<li>개발 환경에 맞는 elasticsearch (0.00.0) image 다운로드</li>\n<li>단일 노드 환경 (single-node)으로 설정</li>\n<li><code class=\"language-text\">elasticsearch</code> 컨테이너의 <code class=\"language-text\">data</code> 디렉토리 볼륨 설정</li>\n<li><code class=\"language-text\">traefik</code> 컨테이너가 실행된 후 <code class=\"language-text\">elasticsearch</code> 컨테이너가 실행되도록 <code class=\"language-text\">depends_on</code> 옵션 설정</li>\n</ul>\n<br>\n<details>\n<summary>docker-compose.yml <strong>코드 보기</strong></summary>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\">  // <span class=\"token punctuation\">...</span>(생략)\n\n  <span class=\"token key atrule\">elasticsearch</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> docker.elastic.co/elasticsearch/elasticsearch<span class=\"token punctuation\">:</span>0.00.0\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> node.name=elasticsearch\n      <span class=\"token punctuation\">-</span> cluster.name=es<span class=\"token punctuation\">-</span>docker<span class=\"token punctuation\">-</span>cluster\n      <span class=\"token punctuation\">-</span> discovery.type=single<span class=\"token punctuation\">-</span>node \n      <span class=\"token punctuation\">-</span> bootstrap.memory_lock=true\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"ES_JAVA_OPTS=-Xms512m -Xmx512m\"</span>\n      <span class=\"token punctuation\">-</span> xpack.license.self_generated.type=basic\n      <span class=\"token punctuation\">-</span> xpack.security.enabled=false\n      <span class=\"token punctuation\">-</span> xpack.security.enrollment.enabled=false\n      <span class=\"token punctuation\">-</span> http.host=0.0.0.0\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./elastic/es01/data<span class=\"token punctuation\">:</span>/usr/share/elasticsearch/data<span class=\"token punctuation\">:</span>Z\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> 1111<span class=\"token punctuation\">:</span><span class=\"token number\">9999</span>\n    <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> net_default\n    <span class=\"token key atrule\">depends_on</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> traefik</code></pre></div>\n</details>\n<br>\n<br>\n<h4 id=\"3-2-logstash-구현\" style=\"position:relative;\"><a href=\"#3-2-logstash-%EA%B5%AC%ED%98%84\" aria-label=\"3 2 logstash 구현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3-2. Logstash 구현</h4>\n<hr>\n<p>이 또한 간략히 요약하자면 아래와 같은 순서로 진행하였다.</p>\n<ul>\n<li><code class=\"language-text\">elasticsearch</code> 이미지와 동일한 버전<strong>(중요)</strong>의 <code class=\"language-text\">logstash</code> 이미지를 다운로드한다.</li>\n<li>Logstash와 연결할 DB관련 정보는 <code class=\"language-text\">.env</code> 파일에서 관리되도록 설정</li>\n<li><code class=\"language-text\">path.data</code> : Logstash 데이터 저장 경로 설정</li>\n<li><code class=\"language-text\">elasticsearch</code> 컨테이너가 실행된 후 <code class=\"language-text\">logstash</code> 컨테이너가 실행되도록 <code class=\"language-text\">depends_on</code> 옵션 설정</li>\n<li>MariaDB와 jdbc 플러그인을 연결하기 위한 <a href=\"https://dev.mysql.com/downloads/connector/j/?os=26\" target=\"_blank\">mysql-connector</a> jar 파일 볼륨 설정</li>\n<li><code class=\"language-text\">config</code>, <code class=\"language-text\">pipeline</code>, <code class=\"language-text\">logs</code> 디렉토리 볼륨 설정</li>\n</ul>\n<br>\n<details>\n<summary>docker-compose.yml <strong>코드 보기</strong></summary>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\">  // <span class=\"token punctuation\">...</span>(생략)\n\n  <span class=\"token key atrule\">logstash</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> docker.elastic.co/logstash/logstash<span class=\"token punctuation\">:</span>0.00.0\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> DB_HOST=$DB_HOST\n      <span class=\"token punctuation\">-</span> DB_PORT=$DB_PORT\n      <span class=\"token punctuation\">-</span> DB_DATABASE=$DB_DATABASE\n      <span class=\"token punctuation\">-</span> DB_USERNAME=$DB_USERNAME\n      <span class=\"token punctuation\">-</span> DB_PASSWORD=$DB_PASSWORD\n      <span class=\"token punctuation\">-</span> xpack.monitoring.enabled=false\n      <span class=\"token punctuation\">-</span> xpack.monitoring.elasticsearch.hosts=<span class=\"token punctuation\">[</span><span class=\"token string\">\"http://elasticsearch:9999\"</span><span class=\"token punctuation\">]</span>\n      <span class=\"token punctuation\">-</span> http.host=0.0.0.0\n      <span class=\"token punctuation\">-</span> http.port=8888\n      <span class=\"token punctuation\">-</span> path.data=/usr/share/logstash/data\n\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./elastic/ls/jars/mysql<span class=\"token punctuation\">-</span>connector<span class=\"token punctuation\">-</span>j<span class=\"token punctuation\">-</span>8.3.0.jar/<span class=\"token punctuation\">:</span>/usr/share/logstash/logstash<span class=\"token punctuation\">-</span>core/lib/jars/mysql<span class=\"token punctuation\">-</span>connector<span class=\"token punctuation\">-</span>j<span class=\"token punctuation\">-</span>8.3.0.jar <span class=\"token comment\"># mysql 사용을 위한 jdbc-connector 다운</span>\n      <span class=\"token punctuation\">-</span> ./elastic/ls/config<span class=\"token punctuation\">:</span>/usr/share/logstash/config<span class=\"token punctuation\">:</span>Z\n      <span class=\"token punctuation\">-</span> ./elastic/ls/pipeline<span class=\"token punctuation\">:</span>/usr/share/logstash/pipeline<span class=\"token punctuation\">:</span>Z\n      <span class=\"token punctuation\">-</span> ./logs/logstash<span class=\"token punctuation\">:</span>/usr/share/logstash/logs\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> 8888<span class=\"token punctuation\">:</span><span class=\"token number\">8888</span>\n    <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> net_default\n    <span class=\"token key atrule\">depends_on</span><span class=\"token punctuation\">:</span> \n      <span class=\"token punctuation\">-</span> elasticsearch  </code></pre></div>\n</details>\n<br>\n<br>\n<p>그 후 <code class=\"language-text\">pipelines.yml</code> 파이프라인을 정의한다.</p>\n<ul>\n<li><code class=\"language-text\">path.config</code> : 각 파이프라인 설정 파일이 위치하는 경로</li>\n</ul>\n<br>\n<details>\n<summary>pipelines.yml <strong>코드 보기</strong></summary>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token comment\"># 온라인 문의 데이터 적재 파이프라인</span>\n<span class=\"token punctuation\">-</span> <span class=\"token key atrule\">pipeline.id</span><span class=\"token punctuation\">:</span> main\n  <span class=\"token key atrule\">pipeline.workers</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n  <span class=\"token key atrule\">pipeline.batch.size</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n  <span class=\"token key atrule\">path.config</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'/usr/share/logstash/pipeline/logstash-main.conf'</span>\n\n<span class=\"token comment\"># 파이프라인 추가 가능</span>\n<span class=\"token punctuation\">...</span></code></pre></div>\n</details>\n<br>\n<br>\n<p>그후 파이프라인 설정 파일 <code class=\"language-text\">logstash.conf</code>를 정의한다.</p>\n<ul>\n<li><code class=\"language-text\">input</code>: JDBC 플러그인을 사용하여 데이터베이스와 연결한다. 이 중 <code class=\"language-text\">schedule</code> 설정은 Logstash가 <code class=\"language-text\">statement</code>에 기재된 SQL 쿼리를 실행하는 주기를 설정하는 옵션이다.</li>\n<li><code class=\"language-text\">filter</code>: 이 부분에서는 mutate 필터를 사용하여 자동 생성되는 <code class=\"language-text\">@version</code>과 <code class=\"language-text\">@timestamp</code> 필드를 제거한다.</li>\n<li><code class=\"language-text\">output</code>: 여기서는 Elasticsearch 플러그인을 사용하여 데이터를 Elasticsearch에 색인한다. <code class=\"language-text\">qnaIdx</code> 필드의 값을 가져와서 각 document의 ID로 사용한다.</li>\n</ul>\n<br>\n<details>\n<summary>logstash.conf <strong>코드 보기</strong></summary>\n<div class=\"gatsby-highlight\" data-language=\"conf\"><pre class=\"language-conf\"><code class=\"language-conf\">input {\n  # jdbc 플러그인 → DB 연동 관련\n  jdbc {\n    jdbc_validate_connection =&gt; true\n    jdbc_driver_library =&gt; &quot;/usr/share/logstash/logstash-core/lib/jars/mysql-connector-j-8.3.0.jar&quot;\n    jdbc_driver_class =&gt; &quot;com.mysql.cj.jdbc.Driver&quot;\n    jdbc_connection_string =&gt; &quot;jdbc:mysql://${DB_HOST}:${DB_PORT}/${DB_DATABASE}?useUnicode=true&amp;characterEncoding=utf8&amp;serverTimezone=Asia/Seoul&quot;\n    jdbc_user =&gt; &quot;${DB_USERNAME}&quot;\n    jdbc_password =&gt; &quot;${DB_PASSWORD}&quot;\n    lowercase_column_names =&gt; false\n    use_column_value =&gt; true\n    tracking_column =&gt; &quot;updatedAt&quot;\n    tracking_column_type =&gt; &quot;timestamp&quot;\n    schedule =&gt; &quot;*/5 * * * * *&quot;\n    statement =&gt; &quot;SELECT \n                    qna.qna_idx AS qnaIdx, \n                    ...(생략)\n                    qna.qna_avail AS qnaAvail\n                  FROM \n                    ${DB_DATABASE}.qna AS qna \n                  LEFT JOIN \n                    ${DB_DATABASE}.t1 AS t1 ON qna.t1_idx = t1.t1_idx \n                  LEFT JOIN \n                    ${DB_DATABASE}.t2 AS t2 ON qna.t2_idx = t2.t2_idx\n                  WHERE \n                    (qna.updated_at &gt; :sql_last_value AND qna.updated_at &lt; NOW())\n                  ORDER BY \n                    qna.updated_at ASC&quot;\n    last_run_metadata_path =&gt; &quot;/usr/share/logstash/pipeline/last-run-metadata/last-value-1.yml&quot;\n  }\n}\n\n\nfilter {\n  # mutate → 필드 변환 관련\n  mutate {\n    remove_field =&gt; [&quot;@version&quot;, &quot;@timestamp&quot;]\n  }\n}\n\n\noutput {\n  # elasticsearch 플러그인 → elasticsearch 적재 관련\n  elasticsearch{\n    hosts =&gt; [&quot;http://elasticsearch:9999&quot;]\n    ssl_verification_mode =&gt; none\n    index =&gt; &quot;main-test310&quot;   \n    document_id =&gt; &quot;%{qnaIdx}&quot;\n    template =&gt; &quot;/usr/share/logstash/pipeline/template-main.json&quot;  \n    template_overwrite =&gt; true  \n  }\n}</code></pre></div>\n</details>\n<br>\n<br>\n<p>마지막으로 Elasticsearch의 인덱스 설정을 정의하는 JSON 객체인 <code class=\"language-text\">template.json</code>을 구현한다.</p>\n<ul>\n<li><code class=\"language-text\">max_ngram_diff</code>: <code class=\"language-text\">min_gram</code>과 <code class=\"language-text\">max_gram</code> 사이의 최대 차이를 설정하는 옵션이다. 이 설정은 <code class=\"language-text\">ngram</code> 토크나이저가 생성할 수 있는 n-gram의 크기 범위를 제한한다.\n<ul>\n<li>예를 들어, <code class=\"language-text\">min_gram</code>이 2이고 <code class=\"language-text\">max_gram</code>이 3인 경우, “hello”라는 단어는 [“he”, “el”, “ll”, “lo”, “hel”, “ell”, “llo”]와 같이 2개 또는 3개의 연속된 문자로 분리된다.</li>\n</ul>\n</li>\n<li><code class=\"language-text\">number_of_shards</code>: 인덱스를 구성하는 샤드(Elasticsearch에서 데이터를 분산 저장하는 기본 단위)의 수를 설정하는 옵션</li>\n<li><code class=\"language-text\">number_of_replicas</code>: 데이터의 가용성과 병렬 검색 처리량을 높이 목적을 가진 샤드의 복제본 수를 설정하는 옵션</li>\n<li><code class=\"language-text\">my_ngram_analyzer</code>: 사용자 정의 분석기이며 이 분석기는 <code class=\"language-text\">my_ngram_tokenizer</code>를 사용하여 텍스트를 n-gram으로 분리하고, <code class=\"language-text\">lowercase</code> 필터를 적용하여 모든 토큰을 소문자로 변환한다.</li>\n<li><code class=\"language-text\">my_ngram_tokenizer</code>: <code class=\"language-text\">min_gram</code>과 <code class=\"language-text\">max_gram</code> 사이의 크기를 가진 n-gram을 생성한다. (문자, 숫자, 구두점, 심볼, 공백이 포함된 토큰을 생성한다.)</li>\n</ul>\n<br>\n<details>\n<summary>template.json <strong>코드 보기</strong></summary>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"index_patterns\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"main-*\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"priority\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"template\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"settings\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"max_ngram_diff\"</span><span class=\"token operator\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> \n            <span class=\"token property\">\"number_of_shards\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"number_of_replicas\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"analysis\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n              <span class=\"token property\">\"analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token property\">\"my_ngram_analyzer\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                  <span class=\"token property\">\"tokenizer\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"my_ngram_tokenizer\"</span><span class=\"token punctuation\">,</span>\n                  <span class=\"token property\">\"filter\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"lowercase\"</span><span class=\"token punctuation\">]</span>\n                <span class=\"token punctuation\">}</span>\n              <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n              <span class=\"token property\">\"tokenizer\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token property\">\"my_ngram_tokenizer\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                  <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ngram\"</span><span class=\"token punctuation\">,</span>\n                  <span class=\"token property\">\"min_gram\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n                  <span class=\"token property\">\"max_gram\"</span><span class=\"token operator\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span>\n                  <span class=\"token property\">\"token_chars\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n                      <span class=\"token string\">\"letter\"</span><span class=\"token punctuation\">,</span>\n                      <span class=\"token string\">\"digit\"</span><span class=\"token punctuation\">,</span>\n                      <span class=\"token string\">\"punctuation\"</span><span class=\"token punctuation\">,</span>\n                      <span class=\"token string\">\"symbol\"</span><span class=\"token punctuation\">,</span>\n                      <span class=\"token string\">\"whitespace\"</span>\n                  <span class=\"token punctuation\">]</span>\n                <span class=\"token punctuation\">}</span>\n              <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"mappings\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"properties\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token property\">\"qnaIdx\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"long\"</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token comment\">// ...(생략)</span>\n                <span class=\"token property\">\"createdAt\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"date\"</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"updatedAt\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"date\"</span>\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token property\">\"qnaAvail\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"date\"</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</details>\n<br>\n<br>\n<h2 id=\"-understanding\" style=\"position:relative;\"><a href=\"#-understanding\" aria-label=\" understanding permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🤔 Understanding</h2>\n<hr>\n<p>기존에 사용중인 데이터를 Row(행) 단위로 한 줄씩 저장시키는 상황에서의 <code class=\"language-text\">LIKE</code> 검색 방법은 테이블의 첫행부터 마지막행까지 전체 데이터를 탐색하면서 데이터들을 찾아내야 할 수 밖에없었기에 속도적인 측면에서 점점 더 느려질꺼라 예상되었다.</p>\n<ul>\n<li>\n<p>SQL <code class=\"language-text\">LIKE</code>를 사용하여 DB 테이블을 조회하는 방식</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\">// 문의사항에 '안녕하세요' 텍스트가 포함되어있는 데이터를 출력하는 방식</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> \n<span class=\"token keyword\">FROM</span> qna \n<span class=\"token keyword\">WHERE</span> qna_text <span class=\"token operator\">LIKE</span> <span class=\"token string\">'%안녕하세요%'</span></code></pre></div>\n</li>\n</ul>\n<p>뿐만 아니라, 정확히 <strong>“안녕하세요”</strong>이라는 단어가 포함되어 있어야만 했기에 검색 품질또한 보장받지 못하는 상황이 발생할 수 밖에 없었다.</p>\n<br>\n<br>\n<p>결과적으로 이번 <strong>ELK 스택</strong>의 도입을 계기로 현재 기준으로 약 200-300ms 소요되던 검색 시간을 50-100ms 내외로 감소시켰으며, 검색어를 연속된 문자로 분리하여 검색하기 때문에 검색 품질또한 향상시켰다. (아래와 같이 검색어 중간에 공백이 존재해도 유사한 검색어에 대한 결과를 얻을 수 있게 되었다.)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 430px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAklEQVQoz6WPzU7DMBCE8/5PxJkzHCqBQIH+2GnjuMSx3SS0Dk0+5NJWJVRIiJXGqx3Pzu4mumqJyJQlUxV3kyemomCpHc+vktIHpkKjygaxKg8abVpe5jnGB6p6T1V/nJGotWW2WJFOBfePkpvbCQ+zElcHstWa4s2xNp667ZBLzVwqYs9CKuxmy3sYaLZ72l1/QLLxHiEWpGnKMpNkUhDCjhhNU+OcZej7Q+2sRRcFVWUwxtCFwDiS+GityfMcay1d1zEMww/hNe7EXyLp+wFrHd57cqUoCs1297Vh/OvP4mN95GI+8SPD46RvUy+a/4gkWo3X5nze9TN/i2Rs9l98AifVbfbDldeSAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"request.png\"\n        title=\"request.png\"\n        src=\"/static/d20cee733edb24e45e206912453734fb/05ed2/request.png\"\n        srcset=\"/static/d20cee733edb24e45e206912453734fb/e9ff0/request.png 180w,\n/static/d20cee733edb24e45e206912453734fb/f21e7/request.png 360w,\n/static/d20cee733edb24e45e206912453734fb/05ed2/request.png 430w\"\n        sizes=\"(max-width: 430px) 100vw, 430px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 641px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.55555555555555%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABY0lEQVQoz5WTC2+EIBCE/f9/sUnT193peb4AAWGZaUB7tTW5pptsBhOZ/Uawqm+Kb6crL03HfjC8tj3rVvPpbNl2E7vRsO0UjY00Tv7sKoEUkmkcaD/eGbQm7EzMmgiB/60qSOISQSTAnc9Uz8+YRgMXAJJ4UNzpvasoWA1J+usV88eJvXIUrBM32TZwv/lgdjcMsbwMicK4LIhDD6c0Zi9gSkiSDrTbEOxmrpG/DYFMhZTgLpdMCjtOZe1vN4j3BXAz2Ef+8v9NCEgiIQLftsVoGceiYZpKyzwjav2D8HcdCFM2bGq402k1bBqEYUBUCtEYiHOHmA8jpxjh6roYza8vJe7SdWv3/Z02jCNC3yNa+5gwR850Oaq9rSZiDGKOrHWJnEmLKgWxtnyKrPm5Cl/XJp9yAmOM8E0DX9cIxsAXspUwR88DDpXSvfeGFElYvKdozcU6zks59nzy6z3b9NGf8gmC36ts8riIjwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"response.png\"\n        title=\"response.png\"\n        src=\"/static/a1051b69ae3b0ae94dec55efbbe06a37/c7dcc/response.png\"\n        srcset=\"/static/a1051b69ae3b0ae94dec55efbbe06a37/e9ff0/response.png 180w,\n/static/a1051b69ae3b0ae94dec55efbbe06a37/f21e7/response.png 360w,\n/static/a1051b69ae3b0ae94dec55efbbe06a37/c7dcc/response.png 641w\"\n        sizes=\"(max-width: 641px) 100vw, 641px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<br>\n<p>ELK 스택 도입만으로 속도과 성능 두 마리 토끼를 모두 잡았다 생각한다. <del>(다만, 동시성은 살-짝 잃어버렸다. 🥲)</del></p>\n<p>아직 초기 구현단계라 개선해보고 싶은 사항들이 많다. (시간이 허용한다면, 여러 사용자 정의 분석기들을 비교 분석하여 도입해보고 싶다.)</p>\n<p>앞으로 검색 엔진 개선은 꾸준히 해나가볼 예정이다. 다음에도 좋은 개선 사례가 있다면 블로그 포스팅으로 간략하게 남겨보도록하겠다.</p>\n<br>\n<br>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EF%B8%8F-today-i-learned\">✍️ <strong>T</strong>oday <strong>I</strong> <strong>L</strong>earned</a></p>\n<ul>\n<li>\n<p><a href=\"#1-elasticsearch\">1. Elasticsearch?</a></p>\n</li>\n<li>\n<p><a href=\"#2-elk-%EC%8A%A4%ED%83%9D-%EB%8F%84%EC%9E%85-%EB%B0%B0%EA%B2%BD\">2. ELK 스택 도입 배경</a></p>\n</li>\n<li>\n<p><a href=\"#3-elk-%EC%8A%A4%ED%83%9D-%EB%8F%84%EC%9E%85-%EA%B3%BC%EC%A0%95\">3. ELK 스택 도입 과정</a></p>\n<ul>\n<li><a href=\"#3-1-elasticsearch-%EA%B5%AC%ED%98%84\">3-1. Elasticsearch 구현</a></li>\n<li><a href=\"#3-2-logstash-%EA%B5%AC%ED%98%84\">3-2. Logstash 구현</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-understanding\">🤔 Understanding</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"2024-05-01","title":"ELK Stack 구현하기","categories":"TIL","author":"JH8459","emoji":"📚"},"fields":{"slug":"/2024-05-01-TIL/"}},"site":{"siteMetadata":{"siteUrl":"https://blog.jh8459.com","comments":{"utterances":{"repo":"JH8459/JH8459.github.io"}}}}},"pageContext":{"slug":"/2024-04-24-BOOK/","nextSlug":"/2024-04-21-TIL/","prevSlug":"/2024-05-01-TIL/"}},"staticQueryHashes":["1073350324","1956554647","2938748437"]}