{"componentChunkName":"component---src-templates-blog-template-js","path":"/2025-01-17-TIL/","result":{"data":{"cur":{"id":"08d69a9a-38fb-582f-a2fd-72f7b27016f8","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAID/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAX/2gAMAwEAAhADEAAAAdJomgf/xAAWEAADAAAAAAAAAAAAAAAAAAAAASD/2gAIAQEAAQUCFP8A/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFhAAAwAAAAAAAAAAAAAAAAAAACAx/9oACAEBAAY/AiL/AP/EABgQAAIDAAAAAAAAAAAAAAAAAAABESAx/9oACAEBAAE/IRm9hX//2gAMAwEAAgADAAAAEEw//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGRAAAgMBAAAAAAAAAAAAAAAAAREAIEFR/9oACAEBAAE/EI1YY7tf/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"github-blog.png\"\n        title=\"\"\n        src=\"/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/80e3c/TIL.jpg\"\n        srcset=\"/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/4ec73/TIL.jpg 180w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/158ba/TIL.jpg 360w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/80e3c/TIL.jpg 720w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/47311/TIL.jpg 1080w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/ac614/TIL.jpg 1272w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<br>\n<h2 id=\"️-today-i-learned\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-today-i-learned\" aria-label=\"️ today i learned permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>✍️ <strong>T</strong>oday <strong>I</strong> <strong>L</strong>earned</h2>\n<p>이전 포스팅 중 <a href=\"https://blog.jh8459.com/2024-12-01-TIL/\" target=\"_blank\">Presigned URL S3 파일 업로드</a>에서 사용자들이 사용하는 리소스(녹화영상 및 다수의 이미지 파일)들을 이제 S3로 직접 업로드가 되도록 인프라 구성을 부분적으로 변경하였다.</p>\n<p>또한 파일 타입에 따라 규칙적인 경로 구성을 갖도록 구성했었는데 이러한 일정한 규칙을 근거로 <strong>AWS Lambda + EventBridge</strong>를 사용하여 리소스를 자동으로 관리하는 과정을 간략하게 기록하고자 포스팅을 남긴다.</p>\n<br>\r\n<br>\n<h3 id=\"1-현재-사용중인-aws-s3의-문제점\" style=\"position:relative;\"><a href=\"#1-%ED%98%84%EC%9E%AC-%EC%82%AC%EC%9A%A9%EC%A4%91%EC%9D%B8-aws-s3%EC%9D%98-%EB%AC%B8%EC%A0%9C%EC%A0%90\" aria-label=\"1 현재 사용중인 aws s3의 문제점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 현재 사용중인 AWS S3의 문제점</h3>\n<hr>\n<p>현재 사용자들이 사용하는 모든 리소스들은 아래와 같은 방법으로 <strong>미리 서명된 URL</strong>을 발급 받은 뒤 클라이언트 측에서 직접 AWS S3로 업로드를 하고 있다.</p>\n<img src=\"https://jh8459.s3.ap-northeast-2.amazonaws.com/blog/2024-12-01-TIL/after_infra.png\">\n<br>\n<p>요즘 채용 트렌트가 상,하반기로 나누어 진행하는 이른바 대규모 공개 채용(공채)보다는 365일 수시로 채용하는 경우가 많다.</p>\n<p>수시 채용 특성상 지원자들을 한 장소 혹은 특정일자에 모두 맞춰서 채용 절차를 진행하기 어려우므로 유동적으로 운영하는 경우가 많다. 그렇기에 사내 서비스 또한 이에 맞추어 365일 24시간 중단없이 운영되야한다.</p>\n<br>\r\n<br>\n<img src=\"https://jh8459.s3.ap-northeast-2.amazonaws.com/blog/2025-01-17-TIL/SKCT.png\">\n<br>\n<center><strong>많은 기업에서 위와 같이 일정 기간동안 온라인 인적성 검사를 진행한다.</strong></center><br><br>\n<p>그렇기 때문에 예측하기 어려운 불특정한 일시에 S3에 리소스들이 쌓일 수 밖에 없으며 이로인하여 보관 비용 문제가 누적될 수 밖에 없는 구조이다.</p>\n<br>\r\n<br>\n<h3 id=\"2-aws-lambda-함수-생성\" style=\"position:relative;\"><a href=\"#2-aws-lambda-%ED%95%A8%EC%88%98-%EC%83%9D%EC%84%B1\" aria-label=\"2 aws lambda 함수 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. AWS Lambda 함수 생성</h3>\n<hr>\n<p>우선 AWS Lambda를 통하여 S3의 리소스 관리를 선택한 이유는 아래 이유가 가장 주요하다.</p>\n<br>\n<ol>\n<li>S3의 생명주기 설정은 접두사(prefix) 규칙만으로 제어를 할 수 있기에 커스터마이징에 한계가 있다.</li>\n<li>S3 리소스 정리는 계획상 하루 한번만 동작할 예정이기에 사용량에 따라 과금되는 AWS Lambda 과금 모델은 비용 합리적이다.</li>\n<li>특정 인프라에 종속되지 않는 완전 관리형 서비스이므로 유지보수가 편리하다.</li>\n</ol>\n<br>\n<p>위 이유 외에도 AWS Lambda에서 <code class=\"language-text\">node.js</code>로 Javascript 코드를 실행할 수 있는 것 또한 큰 결정 이유이기도 하다.</p>\n<p>매일 한국시간 기준(KST)으로 자정 정각에 동작할 핸들러 함수는 미리 정의해둔 S3 폴더 규칙에 따라서 입맛에 맞게 구현하였고 리소스가 삭제된 후 슬랙 웹 훅으로 삭제된 리소스들의 대한 알림을 받아 볼 수 있게끔 구현해두었다.</p>\n<br>\r\n<details>\r\n<summary><strong>AWS Lambda 핸들러 함수 코드 샘플</strong></summary>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> S3Client<span class=\"token punctuation\">,</span> ListObjectsV2Command<span class=\"token punctuation\">,</span> DeleteObjectsCommand <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@aws-sdk/client-s3'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> https <span class=\"token keyword\">from</span> <span class=\"token string\">'https'</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// S3 클라이언트 초기화</span>\r\n<span class=\"token keyword\">const</span> s3 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">S3Client</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">region</span><span class=\"token operator\">:</span> <span class=\"token string\">'ap-northeast-2'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// S3 리전 설정</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token constant\">SLACK_WEBHOOK_URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">'...'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Slack 웹훅 URL</span>\r\n\r\n<span class=\"token comment\">/**\r\n * Lambda 핸들러 함수\r\n */</span>\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handler</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> bucketName <span class=\"token operator\">=</span> <span class=\"token string\">'acg-rtc'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// S3 버킷 이름</span>\r\n  <span class=\"token keyword\">const</span> prefixes <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'NEW_ACG/'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ACG/'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'SK/'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'CJ/'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'NEW_LG/'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'LG/'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// S3 접두어 목록</span>\r\n\r\n  <span class=\"token comment\">// 오늘 기준 30일 전 날짜를 계산하여 cutoffDateString 생성 (YYYY-MM-DD 형식)</span>\r\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getCutoffDateString</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> now <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 현재 날짜 가져오기</span>\r\n    now<span class=\"token punctuation\">.</span><span class=\"token function\">setDate</span><span class=\"token punctuation\">(</span>now<span class=\"token punctuation\">.</span><span class=\"token function\">getDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 30일 전으로 이동</span>\r\n    <span class=\"token keyword\">return</span> now<span class=\"token punctuation\">.</span><span class=\"token function\">toISOString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'T'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// YYYY-MM-DD 형식으로 변환</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> cutoffDateString <span class=\"token operator\">=</span> <span class=\"token function\">getCutoffDateString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 기준 날짜 계산</span>\r\n\r\n  <span class=\"token keyword\">let</span> totalDeletedSize <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 총 삭제한 리소스 크기 합산</span>\r\n  <span class=\"token keyword\">const</span> allDeletedKeys <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 삭제된 키 목록</span>\r\n  <span class=\"token keyword\">const</span> deletedClients <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 삭제된 고객사 목록 및 정보</span>\r\n\r\n<span class=\"token comment\">/**\r\n   * 숫자에 1,000 단위로 콤마 추가\r\n   * @param {number} number - 포맷할 숫자\r\n   * @returns {string} 콤마가 추가된 숫자 문자열\r\n   */</span>\r\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">formatNumberWithCommas</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Intl<span class=\"token punctuation\">.</span>NumberFormat</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ko-KR'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span>number<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n  \r\n  <span class=\"token comment\">/**\r\n   * 크기를 적절한 단위로 변환 (MB, GB, TB 등)\r\n   * @param {number} sizeInBytes - 크기 (바이트)\r\n   * @returns {string} 적절한 단위로 변환된 크기 문자열\r\n   */</span>\r\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">formatSize</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">sizeInBytes</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>sizeInBytes <span class=\"token operator\">&lt;</span> <span class=\"token number\">1024</span> <span class=\"token operator\">**</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token punctuation\">(</span>sizeInBytes <span class=\"token operator\">/</span> <span class=\"token number\">1024</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> KB</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>sizeInBytes <span class=\"token operator\">&lt;</span> <span class=\"token number\">1024</span> <span class=\"token operator\">**</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token punctuation\">(</span>sizeInBytes <span class=\"token operator\">/</span> <span class=\"token number\">1024</span> <span class=\"token operator\">**</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> MB</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>sizeInBytes <span class=\"token operator\">&lt;</span> <span class=\"token number\">1024</span> <span class=\"token operator\">**</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token punctuation\">(</span>sizeInBytes <span class=\"token operator\">/</span> <span class=\"token number\">1024</span> <span class=\"token operator\">**</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> GB</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token punctuation\">(</span>sizeInBytes <span class=\"token operator\">/</span> <span class=\"token number\">1024</span> <span class=\"token operator\">**</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> TB</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token comment\">/**\r\n   * S3 객체 삭제 함수\r\n   * 특정 prefix와 cutoffDateString에 따라 삭제할 객체를 필터링하여 삭제\r\n   */</span>\r\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">deleteObjectsByDate</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">prefix<span class=\"token punctuation\">,</span> cutoffDateString</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> deletedKeys <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">let</span> prefixDeletedSize <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 특정 prefix에서 삭제한 크기 합산</span>\r\n    <span class=\"token keyword\">let</span> continuationToken <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">do</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> s3<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>\r\n        <span class=\"token keyword\">new</span> <span class=\"token class-name\">ListObjectsV2Command</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n          <span class=\"token literal-property property\">Bucket</span><span class=\"token operator\">:</span> bucketName<span class=\"token punctuation\">,</span>\r\n          <span class=\"token literal-property property\">Prefix</span><span class=\"token operator\">:</span> prefix<span class=\"token punctuation\">,</span> <span class=\"token comment\">// 탐색할 접두어</span>\r\n          <span class=\"token literal-property property\">MaxKeys</span><span class=\"token operator\">:</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 한 번에 최대 1000개 객체 반환</span>\r\n          <span class=\"token literal-property property\">ContinuationToken</span><span class=\"token operator\">:</span> continuationToken<span class=\"token punctuation\">,</span> <span class=\"token comment\">// 페이징 토큰</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>response<span class=\"token punctuation\">.</span>Contents <span class=\"token operator\">||</span> response<span class=\"token punctuation\">.</span>Contents<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 더 이상 처리할 객체가 없음</span>\r\n      <span class=\"token punctuation\">}</span>\r\n\r\n      <span class=\"token comment\">// 기준 날짜 이전의 객체 필터링</span>\r\n      <span class=\"token keyword\">const</span> objectsToDelete <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span>Contents<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">obj</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> keyParts <span class=\"token operator\">=</span> obj<span class=\"token punctuation\">.</span>Key<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">const</span> datePart <span class=\"token operator\">=</span> keyParts<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 키에서 YYYYMMDD 추출</span>\r\n\r\n        <span class=\"token keyword\">return</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^\\d{8}$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>datePart<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> datePart <span class=\"token operator\">&lt;</span> cutoffDateString<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">-</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">g</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 날짜 조건 확인</span>\r\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      <span class=\"token comment\">// 삭제 요청 수행 (1,000개 단위로 나누어서 삭제)</span>\r\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> objectsToDelete<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i <span class=\"token operator\">+=</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> batchToDelete <span class=\"token operator\">=</span> objectsToDelete<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> i <span class=\"token operator\">+</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 1,000개씩 분할</span>\r\n\r\n        <span class=\"token keyword\">await</span> s3<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>\r\n          <span class=\"token keyword\">new</span> <span class=\"token class-name\">DeleteObjectsCommand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n            <span class=\"token literal-property property\">Bucket</span><span class=\"token operator\">:</span> bucketName<span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">Delete</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n              <span class=\"token literal-property property\">Objects</span><span class=\"token operator\">:</span> batchToDelete<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">obj</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">Key</span><span class=\"token operator\">:</span> obj<span class=\"token punctuation\">.</span>Key <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// 삭제된 객체 키 및 크기 합산</span>\r\n        deletedKeys<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>batchToDelete<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">obj</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> obj<span class=\"token punctuation\">.</span>Key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">const</span> batchDeletedSize <span class=\"token operator\">=</span> batchToDelete<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">sum<span class=\"token punctuation\">,</span> obj</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> sum <span class=\"token operator\">+</span> obj<span class=\"token punctuation\">.</span>Size<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        prefixDeletedSize <span class=\"token operator\">+=</span> batchDeletedSize<span class=\"token punctuation\">;</span>\r\n        totalDeletedSize <span class=\"token operator\">+=</span> batchDeletedSize<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 전체 삭제 크기 합산</span>\r\n      <span class=\"token punctuation\">}</span>\r\n\r\n      continuationToken <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span>NextContinuationToken<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 다음 페이지를 위한 토큰 설정</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>continuationToken<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 더 이상 페이지가 없을 때까지 반복</span>\r\n\r\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> deletedKeys<span class=\"token punctuation\">,</span> prefixDeletedSize <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token comment\">// 모든 Prefix에 대해 삭제 작업 수행</span>\r\n  <span class=\"token keyword\">const</span> deletePromises <span class=\"token operator\">=</span> prefixes<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">prefix</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> deletedKeys<span class=\"token punctuation\">,</span> prefixDeletedSize <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">deleteObjectsByDate</span><span class=\"token punctuation\">(</span>prefix<span class=\"token punctuation\">,</span> cutoffDateString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      allDeletedKeys<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>deletedKeys<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>deletedKeys<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        deletedClients<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n          <span class=\"token literal-property property\">prefix</span><span class=\"token operator\">:</span> prefix<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 접두어 이름</span>\r\n          <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> deletedKeys<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">,</span> <span class=\"token comment\">// 삭제된 객체 수</span>\r\n          <span class=\"token literal-property property\">size</span><span class=\"token operator\">:</span> prefixDeletedSize<span class=\"token punctuation\">,</span> <span class=\"token comment\">// 삭제된 크기</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Failed to process prefix: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>prefix<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> - </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>error<span class=\"token punctuation\">.</span>message<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">await</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span>deletePromises<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>allDeletedKeys<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">statusCode</span><span class=\"token operator\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">body</span><span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">message</span><span class=\"token operator\">:</span> <span class=\"token string\">'No resources to delete.'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token comment\">// S3 전체 사용량 가져오기</span>\r\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getTotalS3Usage</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">let</span> totalSize <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">let</span> continuationToken <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">do</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> s3<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>\r\n        <span class=\"token keyword\">new</span> <span class=\"token class-name\">ListObjectsV2Command</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n          <span class=\"token literal-property property\">Bucket</span><span class=\"token operator\">:</span> bucketName<span class=\"token punctuation\">,</span>\r\n          <span class=\"token literal-property property\">ContinuationToken</span><span class=\"token operator\">:</span> continuationToken<span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      totalSize <span class=\"token operator\">+=</span> response<span class=\"token punctuation\">.</span>Contents<span class=\"token operator\">?.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">sum<span class=\"token punctuation\">,</span> obj</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> sum <span class=\"token operator\">+</span> obj<span class=\"token punctuation\">.</span>Size<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n      continuationToken <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span>NextContinuationToken<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>continuationToken<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">return</span> totalSize<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 바이트 단위 반환</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> totalS3UsageAfterDeletion <span class=\"token operator\">=</span> <span class=\"token function\">formatSize</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token function\">getTotalS3Usage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token comment\">// 삭제된 리소스 정보 내림차순 정렬 (크기 기준)</span>\r\n  deletedClients<span class=\"token punctuation\">.</span><span class=\"token function\">sort</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> b<span class=\"token punctuation\">.</span>size <span class=\"token operator\">-</span> a<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token comment\">// 삭제 정보 문자열 생성</span>\r\n  <span class=\"token keyword\">const</span> deletionDetails <span class=\"token operator\">=</span> deletedClients\r\n    <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">client</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">  - </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>client<span class=\"token punctuation\">.</span>prefix<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">formatNumberWithCommas</span><span class=\"token punctuation\">(</span>client<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">건 / </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">formatSize</span><span class=\"token punctuation\">(</span>client<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token comment\">// Slack 알림 메시지 생성</span>\r\n  <span class=\"token keyword\">const</span> message <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">channel</span><span class=\"token operator\">:</span> <span class=\"token string\">'#rtc-notice'</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">===============================\\n       ‼️ AWS S3 리소스 삭제 알림 ‼️\\n------------------------------------------------\\n1. S3 총 사용량: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>totalS3UsageAfterDeletion<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\\n2. 삭제한 리소스 크기: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">formatSize</span><span class=\"token punctuation\">(</span>\r\n      totalDeletedSize\r\n    <span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> (~ </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>cutoffDateString<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)\\n3. 삭제 정보:\\n</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>deletionDetails<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\\n\\n===============================</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">await</span> <span class=\"token function\">sendSlackNotification</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">statusCode</span><span class=\"token operator\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">body</span><span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">message</span><span class=\"token operator\">:</span> <span class=\"token string\">'Resource cleanup completed'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">/**\r\n * Slack 알림 전송 함수\r\n */</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">sendSlackNotification</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">message</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token operator\">...</span><span class=\"token comment\">// 생략</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n</code></pre></div>\n</details>\r\n<br>\n<p>간단한 200줄 내외의 함수를 구현하였으며 관련 라이브러리 모듈들과 <code class=\"language-text\">package.json</code> 파일을 함께 압축하여 직접 업로드(10MB 미만 가능)하였고, 그렇게하여 등록된 핸들러 함수는 아래의 GUI를 통해 간편하게 테스트를 진행할 수 있었다.</p>\n<img src=\"https://jh8459.s3.ap-northeast-2.amazonaws.com/blog/2025-01-17-TIL/lambda.png\">\n<br>\n<center><strong>테스트 버튼만 누르면 작성한 핸들러 함수를 손쉽게 테스트 해볼 수 있다. 👍</strong></center><br><br>\n<p>테스트 결과 또한 <strong>CloudWatch Logs Live Tail</strong>에서 직관적으로 확인할 수 있었기에 핸들러 함수를 구현하고 동작하는 전반적인 과정을 AWS Lambda GUI Console을 통하여 모두 제어할 수 있어서 손쉽게 금방 구현할 수 있었다.</p>\n<br>\r\n<br>\n<h3 id=\"3-aws-eventbridge-등록\" style=\"position:relative;\"><a href=\"#3-aws-eventbridge-%EB%93%B1%EB%A1%9D\" aria-label=\"3 aws eventbridge 등록 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. AWS EventBridge 등록</h3>\n<hr>\n<p>마지막 단계로 매일 정해진 시간에 AWS Lambda에 등록한 핸들러 함수가 규칙적으로 호출되어 S3 리소스를 자동으로 삭제되게끔 반복시키는 설정이 필요하였고 이를 위해 <strong>AWS EventBridge</strong> 서비스를 추가로 선택하였다.</p>\n<p>이벤트 기반 아키텍처를 구축하기 위해 알려진 서비스이지만 거창한 기능은 사용하지 않았고 미리 작성한 AWS Lambda 함수를 정해진 일정으로 등록하여 반복 실행되게끔 스케쥴링 등록을 해주기 위하여 사용하였다.</p>\n<br>\n<img src=\"https://jh8459.s3.ap-northeast-2.amazonaws.com/blog/2025-01-17-TIL/eventbridge.png\">\n<br>\n<center><strong>Cron 표현식을 사용해서 반복 이벤트 등록이 가능하다.</strong></center><br><br>\n<p>한국 표준시간대로 매일 00시에 AWS Lambda 함수가 호출되게끔 설정해주었고 다음날 AWS Lambda 모니터링 콘솔과 슬랙 웹훅 알림을 확인하여 정상 작동을 확인하였다.</p>\n<br>\n<img src=\"https://jh8459.s3.ap-northeast-2.amazonaws.com/blog/2025-01-17-TIL/monitor.png\">\n<br>\n<center><strong>00:00 로컬 시간대(KST) AWS Lamba 함수 호출 성공 로그 확인 ✅</strong></center><br><br>\n<br>\r\n<br>\n<h2 id=\"-understanding\" style=\"position:relative;\"><a href=\"#-understanding\" aria-label=\" understanding permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🤔 Understanding</h2>\n<p>S3에 누적되는 높은 용량(영상 혹은 이미지 등)을 갖는 리소스들은 비용적인 측면 때문에 무수히 긴 보관 기간을 가질 수는 없다.</p>\n<p>본문에 기재하진 않았지만 이 외에도 개발 환경에서 테스트 목적으로 생성되는 리소스들은 접두사 <code class=\"language-text\">/TEST_</code> 를 붙혀두어서 S3의 생명주기 설정을 통하여 관리하고 있다.</p>\n<p>인프라를 분리하니 특정 서비스들에 종속되지 않고 AWS에서 제공하는 완전 관리형 서버리스 서비스들을 통하여 자원들을 유연하게 관리할 수 있게 되었다. (기존 온프레미스 환경에서는 스토리지 서버를 두 대로 증설하면 똑같은 스크립트를 두 서버 모두 작성해 주어야만 했다. 😂)</p>\n<p>현재 S3에 적재되는 사용자들의 리소스들은 지원자들의 응시 기간이 모두 종료되는 시점 이후에는 녹화 영상등 저장된 리소스들의 필요성이 급감하므로 비용 효율적인 방안이 추가적으로 있을지 한번 살펴볼만한 여지가 있을 듯 하다. (예를 들자면 2주 뒤에는 리소스들을 S3 Glacier 스토리지 클래스로 이동 후 한달 뒤 완전 삭제 등등..? 🤔)</p>\n<p>앞으로는 낮은 비용으로 높은 효율성을 얻을 수 있는 서비스들을 적극적으로 찾아서 도입을 건의 해봐야겠다.</p>\n<br>\r\n<br>\n<div class=\"gatsby-highlight\" data-language=\"toc\"><pre class=\"language-toc\"><code class=\"language-toc\"></code></pre></div>","excerpt":"✍️ Today I Learned 이전 포스팅 중 Presigned URL S3 파일 업로드에서 사용자들이 사용하는 리소스(녹화영상 및 다수의 이미지 파일)들을 이제 S3로 직접 업로드가 되도록 인프라 구성을 부분적으로 변경하였다. 또한 파일 타입에 따라 규칙적인 경로 구성을 갖도록 구성했었는데 이러한 일정한 규칙을 근거로 AWS Lambda + EventBridge를 사용하여 리소스를 자동으로 관리하는 과정을 간략하게 기록하고자 포스팅을 남긴다. 1. 현재 사용중인 AWS S3의 문제점 현재 사용자들이 사용하는 모든 리소스들은 아래와 같은 방법으로 미리 서명된 URL을 발급 받은 뒤 클라이언트 측에서 직접 AWS S3로 업로드를 하고 있다. 요즘 채용 트렌트가 상,하반기로 나누어 진행하는 이른바 대규모 공개 채용(공채)보다는 365일 수시로 채용하는 경우가 많다. 수시 채용 특성상 지원자들을 한 장소 혹은 특정일자에 모두 맞춰서 채용 절차를 진행하기 어려우므로 유동적으로 운영하는 …","timeToRead":6,"tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EF%B8%8F-today-i-learned\">✍️ <strong>T</strong>oday <strong>I</strong> <strong>L</strong>earned</a></p>\n<ul>\n<li><a href=\"#1-%ED%98%84%EC%9E%AC-%EC%82%AC%EC%9A%A9%EC%A4%91%EC%9D%B8-aws-s3%EC%9D%98-%EB%AC%B8%EC%A0%9C%EC%A0%90\">1. 현재 사용중인 AWS S3의 문제점</a></li>\n<li><a href=\"#2-aws-lambda-%ED%95%A8%EC%88%98-%EC%83%9D%EC%84%B1\">2. AWS Lambda 함수 생성</a></li>\n<li><a href=\"#3-aws-eventbridge-%EB%93%B1%EB%A1%9D\">3. AWS EventBridge 등록</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-understanding\">🤔 Understanding</a></p>\n</li>\n</ul>","frontmatter":{"date":"2025.01.17","title":"AWS Lambda + EventBridge를 사용한 S3 리소스 관리","categories":"TIL","author":"JH8459","emoji":"📚"},"fields":{"slug":"/2025-01-17-TIL/"}},"next":{"id":"8b30c5f8-e0b0-5781-b846-0d2339c61078","html":"<p><img src=\"https://jh8459.s3.ap-northeast-2.amazonaws.com/programmers-badge/programmers.jpg\" alt=\"project-slack.jpg\"></p>\n<br>\n<h2 id=\"-프로그래머스-프로필-뱃지-자동-생성-봇\" style=\"position:relative;\"><a href=\"#-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%A8%B8%EC%8A%A4-%ED%94%84%EB%A1%9C%ED%95%84-%EB%B1%83%EC%A7%80-%EC%9E%90%EB%8F%99-%EC%83%9D%EC%84%B1-%EB%B4%87\" aria-label=\" 프로그래머스 프로필 뱃지 자동 생성 봇 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🤖 프로그래머스 프로필 뱃지 자동 생성 봇</h2>\n<h3 id=\"1-개발-목적\" style=\"position:relative;\"><a href=\"#1-%EA%B0%9C%EB%B0%9C-%EB%AA%A9%EC%A0%81\" aria-label=\"1 개발 목적 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 개발 목적</h3>\n<hr>\n<p>백준과 프로그래머스 플랫폼을 알고리즘 문제 풀이시 자주 애용하고 있다.</p>\n<p>알고리즘 풀이 기록을 남기기 위해 <a href=\"https://github.com/BaekjoonHub/BaekjoonHub\">백준 허브</a>라는 익스텐션을 사용해서 자동으로 깃허브 레포지토리에 연동하여 기록으로 남기고 있다.</p>\n<p>백준(Boj) 플랫폼은 <a href=\"https://solved.ac/\">solved.ac</a>라는 곳을 통해 사용자들의 백준 티어를 매기고있다. 이 데이터를 활용해서 백준 프로필 뱃지를 멋지게 만드는 <a href=\"https://github.com/mazassumnida/mazassumnida\">mazassumnida</a> 프로젝트에서 제공하는 프로필 뱃지 이미지를 사용해서 깃허브 프로필에 사용중이다.</p>\n<p>최근 프로그래머스에서도 알고리즘 문제를 풀어보고 있는데 <strong>“프로그래머스 프로필 뱃지 또한 멋지게 만들수 없을까?”</strong>란 생각으로 시작하게된 프로젝트이다.</p>\n<br>\r\n<br>\n<p>아래의 두 레퍼런스 프로젝트를 <strong>참고</strong>하여 만들었다.</p>\n<blockquote>\n<ul>\n<li>프로그래머스 프로필 SVG 자동 생성 프로젝트 (<a href=\"https://github.com/libtv/github-programmers-rank\">https://github.com/libtv/github-programmers-rank</a>)</li>\n<li>백준 프로필 SVG 자동 생성 프로젝트 (<a href=\"https://github.com/mazassumnida/mazassumnida\">https://github.com/mazassumnida/mazassumnida</a>)</li>\n</ul>\n</blockquote>\n<br>\r\n<br>\n<h3 id=\"2-주의-사항\" style=\"position:relative;\"><a href=\"#2-%EC%A3%BC%EC%9D%98-%EC%82%AC%ED%95%AD\" aria-label=\"2 주의 사항 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 주의 사항</h3>\n<hr>\n<ul>\n<li><a href=\"https://github.com/BaekjoonHub/BaekjoonHub\">백준 허브</a> 익스텐션에 연동된 레포지토리 필요.</li>\n<li>깃허브 <strong>PAT(Personal Access Token)</strong> 필요.</li>\n</ul>\n<p>실시간으로 프로그래머스에서 문제 풀이를 완료하면 백준 허브를 통해 연동된 레포지토리에 자동으로 커밋되는 기능을 활용한 프로젝트이므로 백준 허브가 반드시 필요하다. (백준 허브 설치 방법은 이 게시글에서는 설명하지 않습니다.)</p>\n<p>또한 다른 레포지토리 저장소의 Github Actions 워크플로우를 호출해야하므로 깃허브 토큰이 필요하다. (다른 저장소를 호출할 수 있는지 권한을 확인해야 하므로 PAT가 반드시 필요하다.)</p>\n<br>\r\n<br>\n<h3 id=\"3-설치-방법\" style=\"position:relative;\"><a href=\"#3-%EC%84%A4%EC%B9%98-%EB%B0%A9%EB%B2%95\" aria-label=\"3 설치 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 설치 방법</h3>\n<hr>\n<h4 id=\"3-1-프로젝트-포크\" style=\"position:relative;\"><a href=\"#3-1-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%ED%8F%AC%ED%81%AC\" aria-label=\"3 1 프로젝트 포크 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3-1. 프로젝트 포크</h4>\n<ul>\n<li>\n<p><a href=\"https://github.com/JH8459/<strong>PROGRAMMERS-BADGE</strong>\" target=\"_blank\"><strong>PROGRAMMERS-BADGE</strong> 프로젝트</a>를 포크합니다.</p>\n<p><img src=\"https://github.com/user-attachments/assets/0d68e181-41a4-4654-bc4c-32d166f9ce4f\" alt=\"fork\"></p>\n<br/>\n</li>\n</ul>\n<h4 id=\"3-2-액션-시크릿-키-등록\" style=\"position:relative;\"><a href=\"#3-2-%EC%95%A1%EC%85%98-%EC%8B%9C%ED%81%AC%EB%A6%BF-%ED%82%A4-%EB%93%B1%EB%A1%9D\" aria-label=\"3 2 액션 시크릿 키 등록 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3-2. 액션 시크릿 키 등록</h4>\n<ul>\n<li>\n<p><strong>PROGRAMMERS-BADGE</strong> 프로젝트에서 깃허브 액션에 사용될 시크릿 키를 등록합니다.</p>\n<p><img src=\"https://github.com/user-attachments/assets/58cb57f5-c06b-4cc9-b242-2189d10e4a4e\" alt=\"secret_key\"></p>\n<ul>\n<li>\n<p><strong>GH_PAT:</strong> <code class=\"language-text\">GitHub Personal Access Token</code> 값 입니다.</p>\n<blockquote>\n<p><code class=\"language-text\">ghp_....</code> 로 시작하곤합니다.</p>\n</blockquote>\n</li>\n<li>\n<p><strong>GH_REPOSITORY:</strong> <code class=\"language-text\">{Github 계정명}/{레포지토리명}</code></p>\n<blockquote>\n<p>예시로 저의 경우엔 <strong>JH8459/<strong>PROGRAMMERS-BADGE</strong></strong> 입니다.</p>\n</blockquote>\n</li>\n<li>\n<p><strong>PROGRAMMERS_ID:</strong> 프로그래머스 계정 ID입니다.</p>\n<blockquote>\n<p>프로그래머스 이메일 주소이며 소셜 로그인으로 사용중이시더라도 등록해주셔야합니다.</p>\n</blockquote>\n</li>\n<li>\n<p><strong>PROGRAMMERS_PW:</strong> 프로그래머스 계정 PW입니다.</p>\n</li>\n</ul>\n<br/>\n</li>\n</ul>\n<h4 id=\"3-3-액션-활성화\" style=\"position:relative;\"><a href=\"#3-3-%EC%95%A1%EC%85%98-%ED%99%9C%EC%84%B1%ED%99%94\" aria-label=\"3 3 액션 활성화 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3-3. 액션 활성화</h4>\n<ul>\n<li>\n<p><strong>PROGRAMMERS-BADGE</strong> 프로젝트에서 액션을 활성화합니다.</p>\n<p><img src=\"https://github.com/user-attachments/assets/99b7d0fc-8c59-4f0b-85aa-71f591ad01bc\" alt=\"action_enable\"></p>\n<blockquote>\n<p>포크한 레포지토리의 액션은 기본으로 비활성화되어 있으므로 해당 버튼을 클릭하여 액션을 활성화시킵니다.</p>\n</blockquote>\n<br/>\n</li>\n</ul>\n<h4 id=\"3-4-백준허브-저장소-액션-시크릿-키-등록\" style=\"position:relative;\"><a href=\"#3-4-%EB%B0%B1%EC%A4%80%ED%97%88%EB%B8%8C-%EC%A0%80%EC%9E%A5%EC%86%8C-%EC%95%A1%EC%85%98-%EC%8B%9C%ED%81%AC%EB%A6%BF-%ED%82%A4-%EB%93%B1%EB%A1%9D\" aria-label=\"3 4 백준허브 저장소 액션 시크릿 키 등록 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3-4. 백준허브 저장소 액션 시크릿 키 등록</h4>\n<ul>\n<li>\n<p>백준허브에 연동된 레포지토리에서 깃허브 액션에 사용될 시크릿 키를 등록합니다.</p>\n<p><img src=\"https://github.com/user-attachments/assets/e55dc536-4764-4167-9d1e-687262c996b5\" alt=\"action_secret\"></p>\n<ul>\n<li>\n<p><strong>GH_PAT:</strong> <code class=\"language-text\">GitHub Personal Access Token</code> 값 입니다.</p>\n<blockquote>\n<p><code class=\"language-text\">ghp_....</code> 로 시작하곤합니다.</p>\n</blockquote>\n</li>\n</ul>\n<br/>\n</li>\n</ul>\n<h4 id=\"3-5-백준허브-저장소-액션-활성화\" style=\"position:relative;\"><a href=\"#3-5-%EB%B0%B1%EC%A4%80%ED%97%88%EB%B8%8C-%EC%A0%80%EC%9E%A5%EC%86%8C-%EC%95%A1%EC%85%98-%ED%99%9C%EC%84%B1%ED%99%94\" aria-label=\"3 5 백준허브 저장소 액션 활성화 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3-5. 백준허브 저장소 액션 활성화</h4>\n<ul>\n<li>\n<p>백준허브에 연동된 레포지토리에서 액션을 활성화합니다.</p>\n<p><img src=\"https://github.com/user-attachments/assets/b3902eef-cd91-4c89-b5c1-da0038b4ad8e\" alt=\"action_enable\"></p>\n<ul>\n<li>\n<p><strong>set up a workflow yourself</strong> 클릭 후 아래의 <code class=\"language-text\">dispatch_action.yml</code>을 복사해서 넣어줍니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> dispatch_action\r\n\r\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\r\n <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\r\n   <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\r\n     <span class=\"token punctuation\">-</span> master\r\n\r\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\r\n <span class=\"token key atrule\">dispatch</span><span class=\"token punctuation\">:</span>\r\n   <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\r\n   <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\r\n     <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Trigger repository dispatch\r\n       <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> peter<span class=\"token punctuation\">-</span>evans/repository<span class=\"token punctuation\">-</span>dispatch@v1\r\n       <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\r\n         <span class=\"token key atrule\">token</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.GH_PAT <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n         <span class=\"token key atrule\">repository</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>Github 계정명<span class=\"token punctuation\">}</span>/<span class=\"token punctuation\">{</span>레포지토리명<span class=\"token punctuation\">}</span>\r\n         <span class=\"token key atrule\">event-type</span><span class=\"token punctuation\">:</span> trigger<span class=\"token punctuation\">-</span>workflow</code></pre></div>\n<blockquote>\n<p><code class=\"language-text\">repository: {Github 계정명}/{레포지토리명}</code> 예시로 저의 경우엔 <strong>JH8459/<strong>PROGRAMMERS-BADGE</strong></strong> 입니다.</p>\n</blockquote>\n</li>\n</ul>\n<br/>\n</li>\n</ul>\n<h4 id=\"3-6-결과-확인\" style=\"position:relative;\"><a href=\"#3-6-%EA%B2%B0%EA%B3%BC-%ED%99%95%EC%9D%B8\" aria-label=\"3 6 결과 확인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3-6. 결과 확인</h4>\n<ul>\n<li>\n<p>프로그래머스에서 문제 풀이 후 <strong>PROGRAMMERS-BADGE</strong> 프로젝트에서 결과물 확인</p>\n<ul>\n<li>\n<p>프로그래머스 문제 풀이 후 백준 허브에 연동된 레포지토리의 액션 로그를 확인합니다.</p>\n</li>\n<li>\n<p><strong>PROGRAMMERS-BADGE</strong> 프로젝트에서의 액션 로그를 확인합니다.</p>\n</li>\n<li>\n<p>위 과정에서 문제가 없었다면, <strong>PROGRAMMERS-BADGE</strong> 프로젝트에서 <code class=\"language-text\">static</code> 폴더에 .svg 포맷의 프로그래머스 랭킹 뱃지 결과물을 확인합니다.</p>\n</li>\n<li>\n<p>원하는 랭킹 뱃지 유형을 확인 후 깃허브 프로필에 링크를 붙혀넣습니다.</p>\n<blockquote>\n<p><a href=\"https://raw.githubusercontent.com/%7BGithub\">https://raw.githubusercontent.com/{Github</a> 계정명}/{레포지토리명}/master/static/result.svg</p>\n</blockquote>\n</li>\n</ul>\n</li>\n</ul>\n<br>\r\n<br>\n<h3 id=\"4-결과물-미리-보기\" style=\"position:relative;\"><a href=\"#4-%EA%B2%B0%EA%B3%BC%EB%AC%BC-%EB%AF%B8%EB%A6%AC-%EB%B3%B4%EA%B8%B0\" aria-label=\"4 결과물 미리 보기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. 결과물 미리 보기</h3>\n<h4 id=\"기본형\" style=\"position:relative;\"><a href=\"#%EA%B8%B0%EB%B3%B8%ED%98%95\" aria-label=\"기본형 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>기본형</h4>\n<ul>\n<li>\n<p>0 레벨 🍂</p>\n<p><img src=\"/52d21424b0a8dce31cb1943a4a3be600/bronze.svg\" alt=\"0\"></p>\n</li>\n<li>\n<p>1 레벨 💍</p>\n<p><img src=\"/0c03775e228840634d7528a0279bc16c/silver.svg\" alt=\"1\"></p>\n</li>\n<li>\n<p>2 레벨 🏅</p>\n<p><img src=\"/00324d51f64bf873dde65f91877fb73e/gold.svg\" alt=\"2\"></p>\n</li>\n<li>\n<p>3 레벨 💚</p>\n<p><img src=\"/765755d1f8a833d499afeeba4a1d33ee/platinum.svg\" alt=\"3\"></p>\n</li>\n<li>\n<p>4 레벨 💎</p>\n<p><img src=\"/9f628c42a12acf09b459f7d8a38e8663/diamond.svg\" alt=\"4\"></p>\n</li>\n<li>\n<p>5 레벨 🍒</p>\n<p><img src=\"/6afc3d87e64ff574412366f4a032b301/ruby.svg\" alt=\"5\"></p>\n</li>\n</ul>\n<br>\r\n<br>\n<h4 id=\"mini\" style=\"position:relative;\"><a href=\"#mini\" aria-label=\"mini permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MINI</h4>\n<p><img src=\"/ee95c0da82e204363b4f4c1e51277bd2/bronze_mini.svg\" alt=\"0\"></p>\n<p><img src=\"/9d90f52ee757af20167d46480c9145e7/silver_mini.svg\" alt=\"1\"></p>\n<p><img src=\"/00c07164fcdb075a3c3f31faea74b186/gold_mini.svg\" alt=\"2\"></p>\n<p><img src=\"/af05669233e2f63b5b7b4ef30c512ddd/platinum_mini.svg\" alt=\"3\"></p>\n<p><img src=\"/424565f7b60dc684ecd8c1cb0ca91086/diamond_mini.svg\" alt=\"4\"></p>\n<p><img src=\"/0382ed0d451a5b9e2fe6152e6bf8c255/ruby_mini.svg\" alt=\"5\"></p>\n<br>\r\n<br>\n<h2 id=\"-understanding\" style=\"position:relative;\"><a href=\"#-understanding\" aria-label=\" understanding permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🤔 Understanding</h2>\n<p>알고리즘 문제풀이에 동기부여도 되고 무엇보다 Boj 로고와 결을 같이하기 때문에 아래와 같이 어색함이 없이 깃허브 프로필에서 노출될 수 있다.</p>\n<br>\n<p><img src=\"https://jh8459.s3.ap-northeast-2.amazonaws.com/programmers-badge/profile.png\" alt=\"profile\"></p>\n<br>\n<p>사실 프로필 뱃지가 뭐가 중요한가 싶지만 생각난 김에 만들어본 토이 프로젝트이다.</p>\n<br>\r\n<br>\n<div class=\"gatsby-highlight\" data-language=\"toc\"><pre class=\"language-toc\"><code class=\"language-toc\"></code></pre></div>","frontmatter":{"date":"2024.12.22","title":"🤖 프로그래머스 프로필 뱃지 자동 생성 봇","categories":"Project","author":"JH8459","emoji":"🔥"},"fields":{"slug":"/2024-12-22-PROJECT/"}},"prev":{"id":"fd19c316-4dfc-5bf5-8274-9f1bb6efe2b9","html":"<p><img src=\"https://jh8459.s3.ap-northeast-2.amazonaws.com/blog/2025-02-04-PROJECT/github.png\" alt=\"project-github.png\"></p>\n<br>\n<h2 id=\"github-프로필-블로그-포스트-자동-업데이트\" style=\"position:relative;\"><a href=\"#github-%ED%94%84%EB%A1%9C%ED%95%84-%EB%B8%94%EB%A1%9C%EA%B7%B8-%ED%8F%AC%EC%8A%A4%ED%8A%B8-%EC%9E%90%EB%8F%99-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8\" aria-label=\"github 프로필 블로그 포스트 자동 업데이트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Github 프로필 블로그 포스트 자동 업데이트</h2>\n<h3 id=\"1-개발-목적\" style=\"position:relative;\"><a href=\"#1-%EA%B0%9C%EB%B0%9C-%EB%AA%A9%EC%A0%81\" aria-label=\"1 개발 목적 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 개발 목적</h3>\n<hr>\n<p>현재 사용중인 블로그는 소프트웨어 개발을 해오며 겪은 이슈들의 기록 혹은 느낀 감정들의 회고를 작성하려는 목적으로 운영중이다.</p>\n<p>직업이 이렇다 보니 직접 구현하고 싶은 욕심에 <strong>Gatsby</strong>를 활용해서 나만의 블로그를 제작해서 운영중이다. (다시 블로그 서비스를 선택할 수 있는 순간이 돌아온다면 <del>벨로그(Velog)</del> 혹은 <del>미디엄(Medium)</del> 서비스를 선택할꺼다..! 😂)</p>\n<p>하지만 대중적인 서비스를 이용하지 않아 검색 엔진 최적화와는 거리가 멀기 때문에 열심히 작성한 포스트들도 조회수는 처참하다!.. <del>(라고 핑계를 대본다.)</del></p>\n<p>그러던중 <strong>Gatsby</strong> 플러그인을 활용하여 내가 작성한 블로그 포스트들 또한 RSS 피드. 즉, <strong>웹 피드</strong>로 발행할 수 있는 사실을 알았다.</p>\n<p><img src=\"https://jh8459.s3.ap-northeast-2.amazonaws.com/blog/2025-02-04-PROJECT/rss.png\" alt=\"rss.png\">\r\n<br></p>\n<center><strong>현재 유명 개발 블로그들의 최신 트렌드를 슬랙 채널로 RSS 피드를 받아보고 있다. 👀</strong></center><br><br>\n<p>언젠간 위와 같은 유용한 포스트들을 발행할 수 있길 희망해보며 <strong>Gatsby</strong> 블로그에 RSS 피드 발행을 위한 플러그인 설치 및 기본 설정을 마친 뒤 이를 테스트해 볼 겸 Github 프로필에 최신 포스트들이 자동으로 갱신될 수 있도록 간단한 자동화 구현을 해보았다.</p>\n<br>\r\n<br>\n<h3 id=\"2-구현-과정\" style=\"position:relative;\"><a href=\"#2-%EA%B5%AC%ED%98%84-%EA%B3%BC%EC%A0%95\" aria-label=\"2 구현 과정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 구현 과정</h3>\n<hr>\n<p>Github 저장소 중 본인의 닉네임과 같은 이름의 저장소는 <strong>Special Repository</strong>로 분류된다.</p>\n<p><img src=\"https://jh8459.s3.ap-northeast-2.amazonaws.com/blog/2025-02-04-PROJECT/special+repository.png\" alt=\"special repository.png\"></p>\n<p>또한 해당 저장소의 <code class=\"language-text\">README.md</code> 파일은 본인 프로필의 메인 화면에 노출되어 개발자들의 개성을 드러내는 공간으로 활용된다.</p>\n<p>이 <strong>Special Repository</strong>는 일반 저장소들과 동일한 기능들이 마찬가지로 제공되므로 여러 방법으로 활용할 수 있다. 간단한 이벤트 함수 코드를 작성하고 Github Action을 사용하여 이벤트 함수를 매일 지정한 시간에 동작시켜 블로그 RSS 피드를 가져와 <code class=\"language-text\">README.md</code> 파일을 갱신하는 계획을 갖고 구현을 해보았다.</p>\n<br>\r\n<br>\n<h4 id=\"2-1-special-repository-clone\" style=\"position:relative;\"><a href=\"#2-1-special-repository-clone\" aria-label=\"2 1 special repository clone permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-1. Special Repository Clone</h4>\n<hr>\n<p>사실 구현해야 할 코드가 간단하므로 클론을 통해 로컬로 프로젝트를 통째로 가져올 이유는 없다. (취향에 따라 로컬에 작성한 파일들을 직접 Special Repository에 업로드해도 무방하다.)</p>\n<p>나는 <code class=\"language-text\">README.md</code> 파일만 존재하는 상태의 <strong>Special Repository</strong>를 클론하여 로컬로 가져 온 뒤 CLI 명령으로 작업을 진행하였다.</p>\n<br>\r\n<br>\n<h4 id=\"2-2-이벤트-함수-코드-작성\" style=\"position:relative;\"><a href=\"#2-2-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%ED%95%A8%EC%88%98-%EC%BD%94%EB%93%9C-%EC%9E%91%EC%84%B1\" aria-label=\"2 2 이벤트 함수 코드 작성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-2. 이벤트 함수 코드 작성</h4>\n<hr>\n<p>익숙한 언어를 활용하기 위해 <code class=\"language-text\">node.js</code> 기반으로 동작하게끔 <code class=\"language-text\">.js</code>로 이벤트 함수를 간단히 작성하였다.</p>\n<p>많은 라이브러리를 설치할 예정은 아니므로 로컬 프로젝트 저장소 내에 아래 명령어로 패키지 매니저를 사용할 수 있도록 간단히 초기화를 진행한 뒤 아래 패키지들을 설치해주었다.</p>\n<blockquote>\n<p>npm init -y</p>\n<p>npm i dotenv</p>\n<p>npm i rss-parser</p>\n</blockquote>\n<br>\n<p>또한 이벤트 함수 코드를 작성하기 위해 <code class=\"language-text\">readme.js</code> 파일을 추가해주었다. (파일명은 자유롭게 작성해도 된다.) 위 과정을 마치면 아래와 같은 저장소 구조를 갖게 된다.</p>\n<p><img src=\"https://jh8459.s3.ap-northeast-2.amazonaws.com/blog/2025-02-04-PROJECT/readmejs.png\" alt=\"readmejs.png\">\r\n<br></p>\n<center><strong>node_modules 폴더는 저장소 업로드 전 삭제하였다. ❌</strong></center><br><br>\n<p>그 후 아래의 코드를 <code class=\"language-text\">readme.js</code> 파일에 작성해 주었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> dotenv <span class=\"token keyword\">from</span> <span class=\"token string\">'dotenv'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> Parser <span class=\"token keyword\">from</span> <span class=\"token string\">'rss-parser'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> readFileSync<span class=\"token punctuation\">,</span> writeFileSync <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'node:fs'</span><span class=\"token punctuation\">;</span>\r\n\r\ndotenv<span class=\"token punctuation\">.</span><span class=\"token function\">config</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// .env 파일 로드</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token constant\">README_PATH</span> <span class=\"token operator\">=</span> <span class=\"token string\">'README.md'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token constant\">RSS_FEED_URL</span> <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">RSS_FEED_URL</span> <span class=\"token operator\">||</span> <span class=\"token string\">'https://blog.jh8459.com/rss'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token constant\">SECTION_HEADER</span> <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">SECTION_HEADER</span> <span class=\"token operator\">||</span> <span class=\"token string\">'## 📚 &amp;#160;Blog Posts'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token constant\">INSERT_MARKER</span> <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">INSERT_MARKER</span> <span class=\"token operator\">||</span> <span class=\"token string\">'&lt;br>\\n\\n---'</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// 날짜 변환 함수: EX \"Fri, 17 Jan 2025 00:00:00 GMT\" → \"2025/01/17\"</span>\r\n<span class=\"token keyword\">function</span> <span class=\"token function\">formatPubDate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">pubDate</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> date <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>pubDate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> year <span class=\"token operator\">=</span> date<span class=\"token punctuation\">.</span><span class=\"token function\">getUTCFullYear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> month <span class=\"token operator\">=</span> <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">getUTCMonth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">padStart</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 월(1~12)</span>\r\n    <span class=\"token keyword\">const</span> day <span class=\"token operator\">=</span> <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">getUTCDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">padStart</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 일(01~31)</span>\r\n\r\n    <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>year<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>month<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>day<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'날짜 변환 중 오류 발생:'</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 오류 발생 시 빈 문자열 반환</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token comment\">// RSS 피드에서 최신 블로그 글 목록을 가져오는 함수</span>\r\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">fetchRecentPosts</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">feedUrl<span class=\"token punctuation\">,</span> limit <span class=\"token operator\">=</span> <span class=\"token number\">5</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> parser <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Parser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">headers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">Accept</span><span class=\"token operator\">:</span> <span class=\"token string\">'application/rss+xml, application/xml, text/xml; q=0.1'</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> feed <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> parser<span class=\"token punctuation\">.</span><span class=\"token function\">parseURL</span><span class=\"token punctuation\">(</span>feedUrl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">return</span> feed<span class=\"token punctuation\">.</span>items\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> limit<span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> title<span class=\"token punctuation\">,</span> link<span class=\"token punctuation\">,</span> pubDate <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> formattedDate <span class=\"token operator\">=</span> <span class=\"token function\">formatPubDate</span><span class=\"token punctuation\">(</span>pubDate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">- [</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>title<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">](</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>link<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">) - </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>formattedDate<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'RSS 피드 파싱 중 오류 발생:'</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 오류 발생 시 빈 문자열 반환</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token comment\">// README.md 파일의 내용을 읽어오는 함수</span>\r\n<span class=\"token keyword\">function</span> <span class=\"token function\">readReadme</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">filePath</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">,</span> <span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'README.md 파일을 읽는 중 오류 발생:'</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 오류 발생 시 빈 문자열 반환</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token comment\">// README.md 파일을 업데이트하는 함수</span>\r\n<span class=\"token keyword\">function</span> <span class=\"token function\">updateReadme</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">filePath<span class=\"token punctuation\">,</span> newPosts</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>newPosts<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">let</span> content <span class=\"token operator\">=</span> <span class=\"token function\">readReadme</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span><span class=\"token constant\">INSERT_MARKER</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> sectionRegex <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RegExp</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">SECTION_HEADER</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">[\\\\s\\\\S]*?(?=\\n</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">INSERT_MARKER</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">'m'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span>sectionRegex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token comment\">// 기존 SECTION_HEADER가 존재하는 경우, 내용을 교체</span>\r\n      content <span class=\"token operator\">=</span> content<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span>sectionRegex<span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">SECTION_HEADER</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\\n\\n</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>newPosts<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token comment\">// SECTION_HEADER가 존재하지 않는 경우, 새롭게 추가</span>\r\n      content <span class=\"token operator\">=</span> content<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token constant\">INSERT_MARKER</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\\n</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">SECTION_HEADER</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\\n\\n</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>newPosts<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\\n</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">INSERT_MARKER</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token function\">writeFileSync</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">,</span> content<span class=\"token punctuation\">,</span> <span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'✅ README.md 업데이트 완료'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'README.md 파일을 저장하는 중 오류 발생:'</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'⚠️ README.md에서 삽입할 위치를 찾을 수 없습니다.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token comment\">// 실행 함수</span>\r\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> recentPosts <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetchRecentPosts</span><span class=\"token punctuation\">(</span><span class=\"token constant\">RSS_FEED_URL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token function\">updateReadme</span><span class=\"token punctuation\">(</span><span class=\"token constant\">README_PATH</span><span class=\"token punctuation\">,</span> recentPosts<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br>\n<p>작성한 코드는 주석을 통해 설명해두었으며 이 중 아래 변수들은 다음과 같은 주요한 기능들을 담당한다.</p>\n<ol>\n<li>\n<p><code class=\"language-text\">RSS_FEED_URL</code>: 본인 블로그의 RSS 피드 URL 주소.</p>\n</li>\n<li>\n<p><code class=\"language-text\">SECTION_HEADER</code>: 추가될 헤더 문자열.</p>\n<ul>\n<li>⚠️ <code class=\"language-text\">SECTION_HEADER</code>에 담긴 문자열이 <code class=\"language-text\">README.md</code> 파일 내부 존재유무에 따라 최종 결과물에 영향을 미치므로 중복된 문자열이 존재하면 안된다.</li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">INSERT_MARKER</code>: 블로그 최신 글 목록이 삽입할 위치에 해당하는 문자열.</p>\n<ul>\n<li>⚠️ <code class=\"language-text\">INSERT_MARKER</code>는 반드시 <code class=\"language-text\">README.md</code> 파일 내부 존재해야 하며, 해당 문자열이 블로그 최신 글 목록으로 치환된 후 <code class=\"language-text\">INSERT_MARKER</code>가 뒤에 다시 삽입된다.</li>\n</ul>\n</li>\n</ol>\n<br>\n<p>이벤트 함수 작성이 끝난 뒤 작성한 이벤트 함수가 간단한 스크립트로 실행될 수 있도록 <code class=\"language-text\">package.json</code> 파일을 수정하였다.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\r\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"blog-rss-parser\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.0.0\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"블로그 RSS를 사용해서 깃허브 프로필에 최신 포스팅을 자동으로 업데이트합니다.\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"main\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"index.js\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"module\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 프로젝트 단위로 ES 모듈 적용</span>\r\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token property\">\"test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\"</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token property\">\"start\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node readme.js\"</span> <span class=\"token comment\">// 작성한 이벤트 함수 파일명과 동일하게 수정</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"keywords\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"author\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"license\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ISC\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"dependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token property\">\"dotenv\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^16.4.7\"</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token property\">\"rss-parser\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^3.13.0\"</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\r\n<br>\n<h4 id=\"2-3-github-action-스크립트-작성\" style=\"position:relative;\"><a href=\"#2-3-github-action-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%EC%9E%91%EC%84%B1\" aria-label=\"2 3 github action 스크립트 작성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-3. Github Action 스크립트 작성</h4>\n<hr>\n<p>마지막으로 Github Action 스크립트(<code class=\"language-text\">cron_action.yml</code>)를 작성하기 이전에 저장소 설정에 들어가서 환경 변수 설정을 해주어야 한다.</p>\n<p><img src=\"https://jh8459.s3.ap-northeast-2.amazonaws.com/blog/2025-02-04-PROJECT/setting.png\" alt=\"setting.png\">\r\n<br></p>\n<center><strong>GA_PAT는 \"Personal Access Token\" 을 의미한다.</strong></center><br><br>\n<p>스크립트는 위 이벤트 함수가 매일 정해진 시간에 동작될 수 있도록 구현하였다.</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> cron_action\r\n\r\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">schedule</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">cron</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'0 15 * * *'</span>\r\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> master\r\n\r\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\r\n\r\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Checkout repository\r\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v3\r\n\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Set up Node.js\r\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>node@v3\r\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\r\n          <span class=\"token key atrule\">node-version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'20.18.0'</span>\r\n          <span class=\"token key atrule\">cache</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'npm'</span>\r\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\r\n          <span class=\"token key atrule\">GH_PAT</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.GH_PAT <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm install\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\r\n          touch .env\r\n          echo RSS_FEED_URL=${{ secrets.RSS_FEED_URL }} >> .env\r\n          echo SECTION_HEADER=${{ secrets.SECTION_HEADER }} >> .env\r\n          echo INSERT_MARKER=${{ secrets.INSERT_MARKER }} >> .env</span>\r\n\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Start application\r\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\r\n          npm run start &amp;\r\n          sleep 10</span>\r\n\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Commit README\r\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\r\n          git config --local user.name 'BLOG-RSS-PARSER [BOT]'\r\n          git config --local user.email 'JH8459@example.com'\r\n          if [ -n \"$(git status --porcelain README.md)\" ]; then\r\n            git add README.md\r\n            git commit -m 'Update README.md by BLOG-RSS-PARSER [BOT]'\r\n            git push\r\n          else\r\n            echo \"No changes to commit.\"\r\n          fi</span>\r\n\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Terminate workflow\r\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> echo \"Workflow finished after 10 seconds<span class=\"token tag\">!</span>\"\r\n</code></pre></div>\n<br>\n<p>액션의 동작 조건이 코드가 <code class=\"language-text\">master</code> 브런치에 업로드 되는 경우와 특정 시간대 2가지이므로 테스트 또한 간단히 진행이 가능했다.</p>\n<br>\r\n<br>\n<h2 id=\"-understanding\" style=\"position:relative;\"><a href=\"#-understanding\" aria-label=\" understanding permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🤔 Understanding</h2>\n<p>결론적으로 아래와 같은 깃허브 프로필 결과물을 얻을 수 있었다.</p>\n<p><img src=\"https://jh8459.s3.ap-northeast-2.amazonaws.com/blog/2025-02-04-PROJECT/profile.png\" alt=\"profile.png\"></p>\n<p>개발 문화 중 가장 멋지다 생각이 드는건 창작을 하는 집단 중 가장 개방적인 집단이라는 점이다.</p>\n<p>고로 이번 포스팅의 목적 또한 나와 같은 고민을 하는 이가 있다면 조금이라도 도움이 되고자 되도록 간단하고 유연한 구조로 구현하려 노력해보았다. 하지만 아무래도 각기 다른 깃허브 프로필이 존재하므로 모두 대응할 순 없을꺼라 생각한다.</p>\n<p>거창하진 않지만 블로그 유입에 도움이 되지 않을까? 라는 생각이 든 김에 만들어 본 토이 프로젝트이다.</p>\n<br>\r\n<br>\n<div class=\"gatsby-highlight\" data-language=\"toc\"><pre class=\"language-toc\"><code class=\"language-toc\"></code></pre></div>","frontmatter":{"date":"2025.02.04","title":"Github 프로필 블로그 포스트 자동 업데이트","categories":"Project","author":"JH8459","emoji":"🔥"},"fields":{"slug":"/2025-02-04-PROJECT/"}},"site":{"siteMetadata":{"siteUrl":"https://blog.jh8459.com","comments":{"utterances":{"repo":"JH8459/JH8459.github.io"}}}}},"pageContext":{"slug":"/2025-01-17-TIL/","nextSlug":"/2024-12-22-PROJECT/","prevSlug":"/2025-02-04-PROJECT/"}},"staticQueryHashes":["1073350324","1956554647","2938748437"],"slicesMap":{}}