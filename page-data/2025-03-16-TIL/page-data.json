{"componentChunkName":"component---src-templates-blog-template-js","path":"/2025-03-16-TIL/","result":{"data":{"cur":{"id":"4983688a-4820-558e-92d7-4c7a61b27d16","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAID/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAX/2gAMAwEAAhADEAAAAdJomgf/xAAWEAADAAAAAAAAAAAAAAAAAAAAASD/2gAIAQEAAQUCFP8A/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFhAAAwAAAAAAAAAAAAAAAAAAACAx/9oACAEBAAY/AiL/AP/EABgQAAIDAAAAAAAAAAAAAAAAAAABESAx/9oACAEBAAE/IRm9hX//2gAMAwEAAgADAAAAEEw//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGRAAAgMBAAAAAAAAAAAAAAAAAREAIEFR/9oACAEBAAE/EI1YY7tf/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"github-blog.png\"\n        title=\"\"\n        src=\"/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/80e3c/TIL.jpg\"\n        srcset=\"/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/4ec73/TIL.jpg 180w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/158ba/TIL.jpg 360w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/80e3c/TIL.jpg 720w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/47311/TIL.jpg 1080w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/ac614/TIL.jpg 1272w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<br>\n<h2 id=\"ï¸-today-i-learned\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-today-i-learned\" aria-label=\"ï¸ today i learned permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>âœï¸ <strong>T</strong>oday <strong>I</strong> <strong>L</strong>earned</h2>\n<p>ì‚¬ë‚´ ì¸í”„ë¼ëŠ” ë¹„êµì  ì„±ëŠ¥ì´ ì¢‹ì€ ì„œë²„ë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤. <del>(ìˆ˜í‰ì  í™•ì¥ì´ í˜ë“¤ì–´ì„œ.. ğŸ¥²)</del> ê·¸ë ‡ê¸°ì— ì´ˆê¸° ì¸í”„ë¼ë¥¼ êµ¬ì„±í•  ë• ë¦¬ì†ŒìŠ¤ ë¶€ì¡±ì— í—ˆë•ì´ì§„ ì•Šê³ ìˆë‹¤. (ë‹¤ë§Œ, ìš”ì²­ì´ ê¸‰ì¦í• êº¼ë¼ ì˜ˆìƒë  ë•Œ ìˆ˜í‰ì ìœ¼ë¡œ í™•ì¥í•˜ê¸°ëŠ” ì‰½ì§€ ì•Šë‹¤.)</p>\n<p>ì´ëŸ¬í•œ ë°”íƒ•ì„ í† ëŒ€ë¡œ ì˜¨í”„ë ˆë¯¸ìŠ¤ í™˜ê²½ì—ì„œ Docker Composeë¡œ Blue/Green ë°°í¬ ì „ëµì„ êµ¬í˜„í•œ ê³¼ì •ì„ ê°„ëµíˆ í¬ìŠ¤íŒ…ìœ¼ë¡œ ë‚¨ê¸°ë ¤í•œë‹¤.</p>\n<br>\r\n<br>\n<h3 id=\"1-bluegreen-ë°°í¬ë€\" style=\"position:relative;\"><a href=\"#1-bluegreen-%EB%B0%B0%ED%8F%AC%EB%9E%80\" aria-label=\"1 bluegreen ë°°í¬ë€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Blue/Green ë°°í¬ë€?</h3>\n<hr>\n<p>ê°„ë‹¨íˆ ì†Œê°œí•˜ìë©´, ì—¬ëŸ¬ ë¬´ì¤‘ë‹¨ ë°°í¬ ê¸°ë²• ì¤‘ í•˜ë‚˜ì´ë©° ë‘ ê°œì˜ ë…ë¦½ì ì¸ í™˜ê²½ Blue(êµ¬ë²„ì „) í™˜ê²½ê³¼ Green(ì‹ ë²„ì „) í™˜ê²½ì„ ê°€ì§€ê³  ì§„í–‰ë˜ëŠ” ë°°í¬ ì „ëµì´ë‹¤.</p>\n<br>\n<p><img src=\"https://jh8459.s3.ap-northeast-2.amazonaws.com/blog/2025-03-16-TIL/blue_green.jpg\" alt=\"blue/green\"></p>\n<center>ì¶œì²˜ : <a href=\"https://www.samsungsds.com/kr/insights/1256264_4627.html\" target=\"_blank\">ë¬´ì¤‘ë‹¨ ë°°í¬ ì•„í‚¤í…ì²˜(Zero Downtime Deployment)- ê¸€ë¡œë²Œ ì„œë¹„ìŠ¤ ìš´ì˜ì˜ í•„ìˆ˜ ìš”ì†Œ\r\n</a></center><br><br>\n<p>êµ¬ë²„ì „ì´ ìš´ì˜ë˜ëŠ” ë™ì•ˆ ì‹ ë²„ì „ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ êµ¬ì„±í•œ í›„ ë¡œë“œë°¸ëŸ°ì„œë¥¼ í†µí•´ ì‹ ë²„ì „ìœ¼ë¡œ ëª¨ë“  íŠ¸ë˜í”½ì„ ì¼ì‹œì— ì „í™˜í•˜ëŠ” ë°°í¬ ë°©ì‹ì´ë‹¤.</p>\n<p>ì‹ ë²„ì „ì— ë¬¸ì œê°€ ìƒê¸°ëŠ” ê²½ìš° ë¡œë“œë°¸ëŸ°ì„œì˜ ë¼ìš°íŒ…ë§Œ êµ¬ë²„ì „ìœ¼ë¡œ ë³€ê²½í•´ì£¼ë©´ ì† ì‰½ê²Œ ë¡¤ë°±ì´ ê°€ëŠ¥í•œ ì¥ì  ë˜í•œ ìˆì§€ë§Œ ê·¸ ë§Œí¼ ë¦¬ì†ŒìŠ¤ë¥¼ ë§ì´ ì‚¬ìš©í•œë‹¤. (ë™ì¼í•œ í™˜ê²½ìœ¼ë¡œ ê°™ì€ ìˆ˜ì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ ì¶”ê°€ë¡œ í•„ìš”í•˜ë‹¤.)</p>\n<p>ì‚¬ìš©í•œ ë§Œí¼ ì§€ë¶ˆí•˜ëŠ” ì„œë²„ë¦¬ìŠ¤ ì»´í“¨íŒ… í™˜ê²½ì´ë¼ë©´ ì±„íƒ ëª»í• ê±°ê°™ë‹¤. ğŸ¥²</p>\n<br>\r\n<br>\n<h3 id=\"2-docker-compose\" style=\"position:relative;\"><a href=\"#2-docker-compose\" aria-label=\"2 docker compose permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Docker Compose</h3>\n<hr>\n<p>Docker Composeë¡œ êµ¬ì„±í•˜ëŠ” ì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ì€ ìµœì†Œí•œì˜ ë³µì¡ì„±ìœ¼ë¡œ íŒ¨í‚¤ì§€ëœ ì»¨í…Œì´ë„ˆë“¤ì„ ì‰½ê²Œ ìš´ìš©í•  ìˆ˜ ìˆê³  ì´ì‹ì„± ë˜í•œ ë›°ì–´ë‚˜ê¸°ì— í˜„ì¬ ì‚¬ë‚´ ì¸í”„ë¼ êµ¬ì¡°ì—ì„œ ì‚¬ìš©í•˜ê¸° ì•Œë§ëŠ”ë‹¤ ìƒê°í•œë‹¤.</p>\n<p>ì´ë²ˆ ë°°í¬ ì „ëµ ì˜ˆì‹œ ë˜í•œ, ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆë“¤ì„ Docker Compose í™˜ê²½ìœ¼ë¡œ êµ¬ì„±í•˜ì—¬ ì ì ˆí•œ Bash ìŠ¤í¬ë¦½íŒ…ìœ¼ë¡œ <code class=\"language-text\">traefik</code> ì„œë¹„ìŠ¤ì—ì„œ ë¼ìš°íŒ…ì„ ì¡°ì ˆí•˜ëŠ” ë°©ë²•ìœ¼ë¡œ Blue/Green ë°°í¬ ì „ëµì„ êµ¬í˜„í•˜ì˜€ë‹¤.</p>\n<p>ìš°ì„  ìƒ˜í”Œ <code class=\"language-text\">docker-compose.yml</code> íŒŒì¼ì„ ì‚´í´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±í•˜ì˜€ë‹¤. (í•˜ë‚˜í•˜ë‚˜ ì²œì²œíˆ ì‚´í´ ë³¼ ì˜ˆì •ì´ë‹¤.)</p>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">traefik</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> traefik<span class=\"token punctuation\">:</span>latest\r\n    <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>log.level=ERROR\r\n      <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>providers.docker=true\r\n      <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>providers.docker.watch=true\r\n      <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>providers.docker.exposedbydefault=false\r\n      <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>entrypoints.web.address=<span class=\"token punctuation\">:</span><span class=\"token number\">3000</span>\r\n      <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>entrypoints.web.forwardedHeaders.insecure=true\r\n      <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>providers.file.filename=/etc/traefik/dynamic<span class=\"token punctuation\">-</span>config.yml\r\n      <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>providers.file.watch=true\r\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"3000:3000\"</span>\r\n    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> always\r\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> /var/run/docker.sock<span class=\"token punctuation\">:</span>/var/run/docker.sock<span class=\"token punctuation\">:</span>ro\r\n      <span class=\"token punctuation\">-</span> ./dynamic<span class=\"token punctuation\">-</span>config.yml<span class=\"token punctuation\">:</span>/etc/traefik/dynamic<span class=\"token punctuation\">-</span>config.yml\r\n    <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> net_default\r\n\r\n  <span class=\"token key atrule\">web-server-blue</span><span class=\"token punctuation\">:</span> <span class=\"token important\">&amp;web-server-template</span>\r\n    <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token key atrule\">context</span><span class=\"token punctuation\">:</span> .\r\n      <span class=\"token key atrule\">dockerfile</span><span class=\"token punctuation\">:</span> Dockerfile\r\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> ./src<span class=\"token punctuation\">:</span>/myfolder/src\r\n    <span class=\"token key atrule\">env_file</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> ./.env\r\n    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> always\r\n    <span class=\"token key atrule\">deploy</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span>\r\n    <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> traefik.enable=true\r\n      <span class=\"token punctuation\">-</span> traefik.http.services.web<span class=\"token punctuation\">-</span>server<span class=\"token punctuation\">-</span>blue.loadbalancer.server.port=3000\r\n    <span class=\"token key atrule\">healthcheck</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token key atrule\">test</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'CMD'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'curl'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-f'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'http://localhost:3000/health'</span><span class=\"token punctuation\">]</span>\r\n      <span class=\"token key atrule\">interval</span><span class=\"token punctuation\">:</span> 30s\r\n      <span class=\"token key atrule\">timeout</span><span class=\"token punctuation\">:</span> 10s\r\n      <span class=\"token key atrule\">retries</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5</span>\r\n      <span class=\"token key atrule\">start_period</span><span class=\"token punctuation\">:</span> 30s\r\n    <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> net_default\r\n\r\n  <span class=\"token key atrule\">web-server-green</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">&lt;&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token important\">*web-server-template</span>\r\n    <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> traefik.enable=true\r\n      <span class=\"token punctuation\">-</span> traefik.http.services.web<span class=\"token punctuation\">-</span>server<span class=\"token punctuation\">-</span>green.loadbalancer.server.port=3000\r\n\r\n<span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">net_default</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">driver</span><span class=\"token punctuation\">:</span> bridge</code></pre></div>\n<br>\r\n<br>\n<h4 id=\"2-1-traefik\" style=\"position:relative;\"><a href=\"#2-1-traefik\" aria-label=\"2 1 traefik permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-1. traefik</h4>\n<hr>\n<p><code class=\"language-text\">traefik</code> ì»¨í…Œì´ë„ˆëŠ” ë¡œë“œë°¸ëŸ°ì„œ ì—­í• ì„ ë‹´ë‹¹í•¨ìœ¼ë¡œì¨ êµ¬ë²„ì „ í™˜ê²½ê³¼ ì‹ ë²„ì „ í™˜ê²½ì— í˜„ì¬ ë°°í¬ ìš”ì²­ì— ì•Œë§ëŠ” ë¼ìš°íŒ… ì •ì±…ì„ ë‹´ë‹¹í•  ì˜ˆì •ì´ë‹¤.</p>\n<ul>\n<li><code class=\"language-text\">dynamic-config.yml</code> íŒŒì¼ì„ ì œì–´í•´ì„œ ë™ì ìœ¼ë¡œ ë¼ìš°íŒ…ì„ ë³€ê²½í•  ì˜ˆì •ì´ë¯€ë¡œ í•´ë‹¹ íŒŒì¼ ë³¼ë£¸ì„ ê¼­ ì„¤ì •í•´ì£¼ì.</li>\n</ul>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">traefik</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> traefik<span class=\"token punctuation\">:</span>latest\r\n  <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>log.level=ERROR\r\n    <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>providers.docker=true  <span class=\"token comment\">#Docker ì»¨í…Œì´ë„ˆì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ì„œë¹„ìŠ¤ë“¤ì„ ìë™ìœ¼ë¡œ ê°ì§€í•˜ë„ë¡ ì„¤ì •</span>\r\n    <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>providers.docker.watch=true  <span class=\"token comment\">#Dockerì—ì„œ ìƒˆë¡œìš´ ì»¨í…Œì´ë„ˆê°€ ìƒì„±ë˜ê±°ë‚˜ ë³€ê²½ë  ê²½ìš° ìë™ìœ¼ë¡œ ê°ì§€.</span>\r\n    <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>providers.docker.exposedbydefault=false  <span class=\"token comment\">#ê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë“  Docker ì»¨í…Œì´ë„ˆë¥¼ Traefikì´ ë¼ìš°íŒ…í•˜ì§€ ì•Šë„ë¡ ì„¤ì •. (labelsë¥¼ í†µí•´ ê°œë³„ì ìœ¼ë¡œ ë…¸ì¶œí•´ì•¼ í•¨)</span>\r\n    <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>entrypoints.web.address=<span class=\"token punctuation\">:</span><span class=\"token number\">3000</span>\r\n    <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>entrypoints.web.forwardedHeaders.insecure=true\r\n    <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>providers.file.filename=/etc/traefik/dynamic<span class=\"token punctuation\">-</span>config.yml  <span class=\"token comment\">#dynamic-config.yml íŒŒì¼ì—ì„œ ì¶”ê°€ì ì¸ ë™ì  ì„¤ì •ì„ ì½ë„ë¡ ì§€ì •.</span>\r\n    <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>providers.file.watch=true  <span class=\"token comment\">#ì„¤ì • íŒŒì¼(dynamic-config.yml)ì´ ë³€ê²½ë˜ë©´ ìë™ìœ¼ë¡œ ê°ì§€í•˜ì—¬ ì ìš©í•˜ë„ë¡ ì„¤ì •.</span>\r\n  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token punctuation\">-</span> <span class=\"token string\">\"3000:3000\"</span>\r\n  <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> always\r\n  <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token punctuation\">-</span> /var/run/docker.sock<span class=\"token punctuation\">:</span>/var/run/docker.sock<span class=\"token punctuation\">:</span>ro\r\n    <span class=\"token punctuation\">-</span> ./dynamic<span class=\"token punctuation\">-</span>config.yml<span class=\"token punctuation\">:</span>/etc/traefik/dynamic<span class=\"token punctuation\">-</span>config.yml\r\n  <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token punctuation\">-</span> net_default</code></pre></div>\n<br>\n<p><code class=\"language-text\">docker-compose.yml</code> íŒŒì¼ì€ ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰ë  ë•Œë§Œ ì ìš©ë˜ëŠ” ì •ì ì¸ ì„¤ì •ê°’ë“¤ì´ë‹¤. ë•Œë¬¸ì— ë™ì ìœ¼ë¡œ ë³€í•´ì•¼ í•˜ëŠ” ë¼ìš°íŒ… ëŒ€ìƒì€ í˜„ì¬ ìš´ì˜ ì¤‘ì¸ ë²„ì „(Blue / Green)ì´ ë¬´ì—‡ì¸ì§€ë¥¼ í™•ì¸í•´ì„œ ë°°í¬ê°€ ë  ë•Œë§ˆë‹¤ ë³€í™˜ë˜ì–´ì•¼ í•œë‹¤.</p>\n<p>ë™ì  ë¼ìš°íŒ… ë³€ê²½ì€ <code class=\"language-text\">dynamic-config.yml</code> íŒŒì¼ì„ Bash ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ìë™ìœ¼ë¡œ ìƒì„± ë° ìˆ˜ì •ì´ ë˜ê²Œë” êµ¬ì„±í•˜ì—¬ ë¼ìš°íŒ… ì •ì±…ì„ ì œì–´í•  ì˜ˆì •ì´ë‹¤.</p>\n<p>ë”°ë¼ì„œ ì•„ë˜ì˜ ì„¤ì •ê°’ì´ ë°˜ë“œì‹œ ë°˜ì˜ë˜ì–´ì•¼í•œë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>providers.file.filename=/etc/traefik/dynamic<span class=\"token punctuation\">-</span>config.yml  <span class=\"token comment\">#dynamic-config.yml íŒŒì¼ì—ì„œ ì¶”ê°€ì ì¸ ë™ì  ì„¤ì •ì„ ì½ë„ë¡ ì§€ì •.</span>\r\n<span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>providers.file.watch=true  <span class=\"token comment\">#ì„¤ì • íŒŒì¼(dynamic-config.yml)ì´ ë³€ê²½ë˜ë©´ ìë™ìœ¼ë¡œ ê°ì§€í•˜ì—¬ ì ìš©í•˜ë„ë¡ ì„¤ì •.</span></code></pre></div>\n<br>\r\n<br>\n<h4 id=\"2-2-web-server\" style=\"position:relative;\"><a href=\"#2-2-web-server\" aria-label=\"2 2 web server permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-2. web-server</h4>\n<hr>\n<p><code class=\"language-text\">web-server</code> ì„œë¹„ìŠ¤ë“¤ì€ ì˜ˆì‹œë¡œ <code class=\"language-text\">replicas</code>ë¥¼ 2ê°œë¡œ êµ¬ì„±í•´ ë‘ì—ˆë‹¤. ì¦‰, ê°ê° 2ê°œì˜ ì»¨í…Œì´ë„ˆì”© Blue / Green í™˜ê²½ì´ ì¡´ì¬í•œë‹¤ê³  ê°€ì •í–ˆë‹¤.</p>\n<ul>\n<li>ë™ì¼í•œ í™˜ê²½ìœ¼ë¡œ êµ¬ì„±í•´ì•¼í•˜ë¯€ë¡œ Blue ì»¨í…Œì´ë„ˆë¥¼ í…œí”Œë¦¿ìœ¼ë¡œ êµ¬ì„±í•˜ì—¬ Green ì»¨í…Œì´ë„ˆì— ì‚¬ìš©í•˜ì˜€ë‹¤.</li>\n<li>ìƒ˜í”Œì—ì„œëŠ” <code class=\"language-text\">Dockerfile</code>ì„ ì‚¬ìš©í•´ì„œ Bash ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì§ì ‘ ë¹Œë“œí•˜ì—¬ ë°°í¬í•˜ì˜€ì§€ë§Œ, ì´ëŠ” ì—¬ëŸ¬ê°€ì§€ ë°©ë²•ìœ¼ë¡œ ìˆ˜ì •í•´ë„ ë¬´ë°©í•˜ë‹¤.</li>\n</ul>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">web-server-blue</span><span class=\"token punctuation\">:</span> <span class=\"token important\">&amp;web-server-template</span>  <span class=\"token comment\">#&amp;web-server-templateì„ ì‚¬ìš©í•˜ì—¬ YAML ì•µì»¤(Anchor)ë¡œ ì„¤ì •ì„ ì €ì¥. â†’ web-server-greenì´ ì´ ì„¤ì •ì„ ê·¸ëŒ€ë¡œ ê°€ì ¸ë‹¤ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ.</span>\r\n  <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>  <span class=\"token comment\">#í˜„ì¬ ë””ë ‰í† ë¦¬(.)ì—ì„œ Dockerfileì„ ì‚¬ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•¨. (ì´ë¯¸ì§€ íŒŒì¼ì„ ì‚¬ìš©í•´ë„ ëœë‹¤.)</span>\r\n    <span class=\"token key atrule\">context</span><span class=\"token punctuation\">:</span> .\r\n    <span class=\"token key atrule\">dockerfile</span><span class=\"token punctuation\">:</span> Dockerfile\r\n  <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token punctuation\">-</span> ./src<span class=\"token punctuation\">:</span>/myfolder/src\r\n  <span class=\"token key atrule\">env_file</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token punctuation\">-</span> ./.env\r\n  <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> always\r\n  <span class=\"token key atrule\">deploy</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span>\r\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token punctuation\">-</span> traefik.enable=true  <span class=\"token comment\">#ì´ ì»¨í…Œì´ë„ˆê°€ Traefikì˜ ë¼ìš°íŒ… ëŒ€ìƒìœ¼ë¡œ í¬í•¨ë˜ë„ë¡ ì„¤ì •.</span>\r\n    <span class=\"token punctuation\">-</span> traefik.http.services.web<span class=\"token punctuation\">-</span>server<span class=\"token punctuation\">-</span>blue.loadbalancer.server.port=3000\r\n  <span class=\"token key atrule\">healthcheck</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">test</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'CMD'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'curl'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-f'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'http://localhost:3000/health'</span><span class=\"token punctuation\">]</span>\r\n    <span class=\"token key atrule\">interval</span><span class=\"token punctuation\">:</span> 30s\r\n    <span class=\"token key atrule\">timeout</span><span class=\"token punctuation\">:</span> 10s\r\n    <span class=\"token key atrule\">retries</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5</span>\r\n    <span class=\"token key atrule\">start_period</span><span class=\"token punctuation\">:</span> 30s\r\n  <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token punctuation\">-</span> net_default\r\n\r\n<span class=\"token key atrule\">web-server-green</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">&lt;&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token important\">*web-server-template</span>  <span class=\"token comment\">#web-server-greenì€ web-server-blueì™€ ê°™ì€ ì´ë¯¸ì§€, ë³¼ë¥¨, ë„¤íŠ¸ì›Œí¬ ë“±ì„ ì‚¬ìš©.</span>\r\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token punctuation\">-</span> traefik.enable=true\r\n    <span class=\"token punctuation\">-</span> traefik.http.services.web<span class=\"token punctuation\">-</span>server<span class=\"token punctuation\">-</span>green.loadbalancer.server.port=3000</code></pre></div>\n<br>\r\n<br>\n<h4 id=\"2-3-ë°°í¬-ìŠ¤í¬ë¦½íŠ¸\" style=\"position:relative;\"><a href=\"#2-3-%EB%B0%B0%ED%8F%AC-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8\" aria-label=\"2 3 ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-3. ë°°í¬ ìŠ¤í¬ë¦½íŠ¸</h4>\n<hr>\n<p>ìœ„ì—ì„œ ì‘ì„±ì´ ì™„ì„±ëœ <code class=\"language-text\">docker-compose.yml</code> íŒŒì¼ì„ <code class=\"language-text\">docker compose up --build -d</code> ëª…ë ¹ì–´ë¡œ ì‹¤í–‰í•˜ë©´ Blue / Green ì„œë¹„ìŠ¤ë§ˆë‹¤ ì»¨í…Œì´ë„ˆê°€ 2ê°œì”© ìƒì„±ëœë‹¤.</p>\n<p>ì´ëŠ” ì˜ë„í•œë°”ê°€ ì•„ë‹ˆë¯€ë¡œ Bash ìŠ¤í¬ë¦½íŠ¸ë¡œ í˜„ì¬ íƒ€ê²Ÿ ì„œë¹„ìŠ¤ê°€ ë¬´ì—‡ì¸ì§€ í™•ì¸í•˜ë©° ë¼ìš°íŒ… ëŒ€ìƒì„ ë³€ê²½í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë°°í¬ê°€ ì´ë¤„ì§„ë‹¤.</p>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/bash</span>\r\n<span class=\"token comment\"># í™˜ê²½ ë³€ìˆ˜ ì„¤ì •</span>\r\n<span class=\"token assign-left variable\">DYNAMIC_CONFIG</span><span class=\"token operator\">=</span><span class=\"token string\">\"dynamic-config.yml\"</span>\r\n<span class=\"token assign-left variable\">COMPOSE_FILE</span><span class=\"token operator\">=</span><span class=\"token string\">\"docker-compose.yml\"</span>\r\n<span class=\"token assign-left variable\">DOMAIN</span><span class=\"token operator\">=</span><span class=\"token string\">\"localhost\"</span>\r\n<span class=\"token assign-left variable\">SERVICE</span><span class=\"token operator\">=</span><span class=\"token string\">\"web-server\"</span>\r\n<span class=\"token assign-left variable\">BLUE_SERVICE</span><span class=\"token operator\">=</span><span class=\"token string\">\"web-server-blue\"</span>\r\n<span class=\"token assign-left variable\">GREEN_SERVICE</span><span class=\"token operator\">=</span><span class=\"token string\">\"web-server-green\"</span>\r\n<span class=\"token assign-left variable\">PORT</span><span class=\"token operator\">=</span><span class=\"token number\">3000</span>\r\n<span class=\"token assign-left variable\">REPLICAS</span><span class=\"token operator\">=</span><span class=\"token number\">2</span>\r\n\r\n<span class=\"token comment\"># 1ï¸âƒ£ dynamic-config.yml íŒŒì¼(ë™ì  ë¼ìš°íŒ… ë‹´ë‹¹)ì´ ì—†ìœ¼ë©´ ìƒì„±</span>\r\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token operator\">!</span> <span class=\"token parameter variable\">-f</span> <span class=\"token string\">\"<span class=\"token variable\">$DYNAMIC_CONFIG</span>\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\r\n  <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"âš ï¸ <span class=\"token variable\">$DYNAMIC_CONFIG</span> íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ê¸°ë³¸ê°’ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.\"</span>\r\n  <span class=\"token function\">cat</span> <span class=\"token operator\">></span> <span class=\"token variable\">$DYNAMIC_CONFIG</span> <span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">EOL\r\nhttp:\r\n  routers:\r\n    <span class=\"token variable\">$SERVICE</span>:\r\n      entryPoints:\r\n        - \"web\"\r\n      rule: \"Host(\\<span class=\"token variable\">$DOMAIN</span>\\)\"\r\n      service: \"<span class=\"token variable\">$BLUE_SERVICE</span>\"\r\n\r\n  services:\r\n    <span class=\"token variable\">$BLUE_SERVICE</span>:\r\n      loadBalancer:\r\n        servers:\r\n          - url: \"http://<span class=\"token variable\">$BLUE_SERVICE</span>:<span class=\"token variable\">$PORT</span>\"\r\n\r\n    <span class=\"token variable\">$GREEN_SERVICE</span>:\r\n      loadBalancer:\r\n        servers:\r\n          - url: \"http://<span class=\"token variable\">$GREEN_SERVICE</span>:<span class=\"token variable\">$PORT</span>\"\r\nEOL</span>\r\n  <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"âœ… ê¸°ë³¸ <span class=\"token variable\">$DYNAMIC_CONFIG</span> íŒŒì¼ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.\"</span>\r\n<span class=\"token keyword\">fi</span>\r\n\r\n<span class=\"token comment\"># 2ï¸âƒ£ í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ì„œë¹„ìŠ¤ í™•ì¸</span>\r\n<span class=\"token assign-left variable\">BLUE_RUNNING</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">docker</span> <span class=\"token function\">ps</span> <span class=\"token parameter variable\">--filter</span> <span class=\"token string\">\"name=<span class=\"token variable\">$BLUE_SERVICE</span>\"</span> <span class=\"token parameter variable\">--format</span> <span class=\"token string\">\"{{.Names}}\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">wc</span> <span class=\"token parameter variable\">-l</span><span class=\"token variable\">)</span></span>\r\n<span class=\"token assign-left variable\">GREEN_RUNNING</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">docker</span> <span class=\"token function\">ps</span> <span class=\"token parameter variable\">--filter</span> <span class=\"token string\">\"name=<span class=\"token variable\">$GREEN_SERVICE</span>\"</span> <span class=\"token parameter variable\">--format</span> <span class=\"token string\">\"{{.Names}}\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">wc</span> <span class=\"token parameter variable\">-l</span><span class=\"token variable\">)</span></span>\r\n\r\n<span class=\"token assign-left variable\">FIRST_DEPLOY</span><span class=\"token operator\">=</span>false\r\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$BLUE_RUNNING</span>\"</span> <span class=\"token parameter variable\">-eq</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$GREEN_RUNNING</span>\"</span> <span class=\"token parameter variable\">-eq</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\r\n  <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"ğŸ†• ìµœì´ˆ ë°°í¬ì…ë‹ˆë‹¤. Blue ì„œë¹„ìŠ¤ë¶€í„° ì‹œì‘í•©ë‹ˆë‹¤.\"</span>\r\n  <span class=\"token assign-left variable\">TARGET_SERVICE</span><span class=\"token operator\">=</span><span class=\"token variable\">$BLUE_SERVICE</span>\r\n  <span class=\"token assign-left variable\">OLD_SERVICE</span><span class=\"token operator\">=</span><span class=\"token string\">\"\"</span>\r\n  <span class=\"token assign-left variable\">FIRST_DEPLOY</span><span class=\"token operator\">=</span>true\r\n<span class=\"token keyword\">else</span>\r\n  <span class=\"token comment\"># 3ï¸âƒ£ dynamic-config.ymlì—ì„œ OLD_SERVICE ê°€ì ¸ì˜¤ê¸°</span>\r\n  <span class=\"token assign-left variable\">OLD_SERVICE</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">grep</span> <span class=\"token string\">\"service:\"</span> $DYNAMIC_CONFIG <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> -F<span class=\"token string\">'\"'</span> <span class=\"token string\">'{print $2}'</span><span class=\"token variable\">)</span></span>\r\n\r\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token parameter variable\">-z</span> <span class=\"token string\">\"<span class=\"token variable\">$OLD_SERVICE</span>\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\r\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"âŒ í˜„ì¬ ë¼ìš°íŒ…ëœ ì„œë¹„ìŠ¤ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë°°í¬ë¥¼ ì¤‘ë‹¨í•©ë‹ˆë‹¤.\"</span>\r\n    <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span>\r\n  <span class=\"token keyword\">fi</span>\r\n\r\n  <span class=\"token comment\"># 4ï¸âƒ£ í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆ í™•ì¸í•˜ì—¬ OLD_SERVICEê°€ ì•„ë‹Œ ì»¨í…Œì´ë„ˆ ì°¾ê¸°</span>\r\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$OLD_SERVICE</span>\"</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"<span class=\"token variable\">$BLUE_SERVICE</span>\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\r\n    <span class=\"token assign-left variable\">TARGET_SERVICE</span><span class=\"token operator\">=</span><span class=\"token variable\">$GREEN_SERVICE</span>\r\n  <span class=\"token keyword\">else</span>\r\n    <span class=\"token assign-left variable\">TARGET_SERVICE</span><span class=\"token operator\">=</span><span class=\"token variable\">$BLUE_SERVICE</span>\r\n  <span class=\"token keyword\">fi</span>\r\n\r\n  <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"ğŸ”„ í˜„ì¬ ë¼ìš°íŒ…ëœ ì„œë¹„ìŠ¤: <span class=\"token variable\">$OLD_SERVICE</span>\"</span>\r\n  <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"ğŸš€ ìƒˆë¡œìš´ ë°°í¬ ëŒ€ìƒ ì„œë¹„ìŠ¤: <span class=\"token variable\">$TARGET_SERVICE</span>\"</span>\r\n<span class=\"token keyword\">fi</span>\r\n\r\n<span class=\"token comment\"># 5ï¸âƒ£ ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ ë¹Œë“œ</span>\r\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"ğŸš€ Building the new version of the service: <span class=\"token variable\">$TARGET_SERVICE</span>...\"</span>\r\n<span class=\"token function\">docker</span> compose <span class=\"token parameter variable\">-f</span> <span class=\"token variable\">$COMPOSE_FILE</span> build <span class=\"token variable\">$TARGET_SERVICE</span>\r\n\r\n<span class=\"token comment\"># 6ï¸âƒ£ ìƒˆë¡œìš´ ì»¨í…Œì´ë„ˆ ì‹¤í–‰</span>\r\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"ğŸš€ Deploying new service: <span class=\"token variable\">$TARGET_SERVICE</span> with <span class=\"token variable\">$REPLICAS</span> replicas...\"</span>\r\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$FIRST_DEPLOY</span>\"</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\r\n  <span class=\"token function\">docker</span> compose <span class=\"token parameter variable\">-f</span> <span class=\"token variable\">$COMPOSE_FILE</span> up <span class=\"token parameter variable\">-d</span> <span class=\"token parameter variable\">--scale</span> <span class=\"token variable\">$BLUE_SERVICE</span><span class=\"token operator\">=</span><span class=\"token variable\">$REPLICAS</span> <span class=\"token parameter variable\">--scale</span> <span class=\"token variable\">$GREEN_SERVICE</span><span class=\"token operator\">=</span><span class=\"token number\">0</span>\r\n<span class=\"token keyword\">else</span>\r\n  <span class=\"token function\">docker</span> compose <span class=\"token parameter variable\">-f</span> <span class=\"token variable\">$COMPOSE_FILE</span> up <span class=\"token parameter variable\">-d</span> <span class=\"token parameter variable\">--scale</span> <span class=\"token variable\">$TARGET_SERVICE</span><span class=\"token operator\">=</span><span class=\"token variable\">$REPLICAS</span>\r\n<span class=\"token keyword\">fi</span>\r\n\r\n<span class=\"token comment\"># 7ï¸âƒ£ ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ Health Check</span>\r\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"ğŸ› ï¸ Checking health status of <span class=\"token variable\">$TARGET_SERVICE</span>...\"</span>\r\n<span class=\"token function\">sleep</span> <span class=\"token number\">10</span>  <span class=\"token comment\"># ì•ˆì •í™” ì‹œê°„</span>\r\n\r\n<span class=\"token keyword\">for</span> <span class=\"token for-or-select variable\">i</span> <span class=\"token keyword\">in</span> <span class=\"token punctuation\">{</span><span class=\"token number\">1</span><span class=\"token punctuation\">..</span><span class=\"token number\">12</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">do</span>\r\n  <span class=\"token assign-left variable\">HEALTHY_COUNT</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">docker</span> <span class=\"token function\">ps</span> <span class=\"token parameter variable\">--filter</span> <span class=\"token string\">\"name=<span class=\"token variable\">$TARGET_SERVICE</span>\"</span> <span class=\"token parameter variable\">--filter</span> <span class=\"token string\">\"health=healthy\"</span> <span class=\"token parameter variable\">--format</span> <span class=\"token string\">\"{{.Names}}\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">wc</span> <span class=\"token parameter variable\">-l</span><span class=\"token variable\">)</span></span>\r\n\r\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$HEALTHY_COUNT</span>\"</span> <span class=\"token parameter variable\">-gt</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\r\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"âœ… New service <span class=\"token variable\">$TARGET_SERVICE</span> is healthy!\"</span>\r\n    <span class=\"token builtin class-name\">break</span>\r\n  <span class=\"token keyword\">fi</span>\r\n\r\n  <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"â³ Waiting for <span class=\"token variable\">$TARGET_SERVICE</span> to be healthy... (<span class=\"token variable\">$i</span>/12)\"</span>\r\n  <span class=\"token function\">sleep</span> <span class=\"token number\">10</span>\r\n<span class=\"token keyword\">done</span>\r\n\r\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$HEALTHY_COUNT</span>\"</span> <span class=\"token parameter variable\">-eq</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\r\n  <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"âŒ New service <span class=\"token variable\">$TARGET_SERVICE</span> failed to start properly. Rolling back...\"</span>\r\n  <span class=\"token function\">docker</span> compose <span class=\"token parameter variable\">-f</span> <span class=\"token variable\">$COMPOSE_FILE</span> down <span class=\"token variable\">$TARGET_SERVICE</span>\r\n  <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span>\r\n<span class=\"token keyword\">fi</span>\r\n\r\n<span class=\"token comment\"># 8ï¸âƒ£ `dynamic-config.yml` ì—…ë°ì´íŠ¸ (ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ë¡œ ë¼ìš°íŒ… ë³€ê²½)</span>\r\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"ğŸ”„ Updating dynamic-config.yml to point to <span class=\"token variable\">$TARGET_SERVICE</span>...\"</span>\r\n<span class=\"token function\">cat</span> <span class=\"token operator\">></span> <span class=\"token variable\">$DYNAMIC_CONFIG</span> <span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">EOL\r\nhttp:\r\n  routers:\r\n    <span class=\"token variable\">$SERVICE</span>:\r\n      entryPoints:\r\n        - \"web\"\r\n      rule: \"Host(\\<span class=\"token variable\"><span class=\"token variable\">`</span>$DOMAIN<span class=\"token punctuation\">\\</span><span class=\"token variable\">`</span></span>)\"\r\n      service: \"<span class=\"token variable\">$TARGET_SERVICE</span>\"\r\n\r\n  services:\r\n    <span class=\"token variable\">$BLUE_SERVICE</span>:\r\n      loadBalancer:\r\n        servers:\r\n          - url: \"http://<span class=\"token variable\">$BLUE_SERVICE</span>:<span class=\"token variable\">$PORT</span>\"\r\n\r\n    <span class=\"token variable\">$GREEN_SERVICE</span>:\r\n      loadBalancer:\r\n        servers:\r\n          - url: \"http://<span class=\"token variable\">$GREEN_SERVICE</span>:<span class=\"token variable\">$PORT</span>\"\r\nEOL</span>\r\n\r\n<span class=\"token comment\"># 9ï¸âƒ£ Traefikì´ ì„¤ì •ì„ ìë™ ê°ì§€í•˜ë„ë¡ íŠ¸ë¦¬ê±°</span>\r\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"â™»ï¸ Triggering Traefik reload...\"</span>\r\n<span class=\"token function\">touch</span> <span class=\"token variable\">$DYNAMIC_CONFIG</span>\r\n\r\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"ğŸ‰ Deployment complete!\"</span></code></pre></div>\n<br>\n<p>ê°ê° í”„ë¡œì íŠ¸ë§ˆë‹¤ ê³ ìœ í•œ ê°’ë“¤ì€ í™˜ê²½ ë³€ìˆ˜ë¡œ ë§Œë“¤ì–´ ë‘ì—ˆìœ¼ë©° ìŠ¤í¬ë¦½íŠ¸ë¥¼ ê°„ë‹¨íˆ ì„¤ëª…í•˜ìë©´ ì•„ë˜ì˜ ìˆœì„œëŒ€ë¡œ ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë˜ë©° Blue / Green ë°°í¬ê°€ ì§„í–‰ëœë‹¤.</p>\n<ol>\n<li>ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ëœ ë””ë ‰í† ë¦¬ì— <code class=\"language-text\">dynamic-config.yml</code> íŒŒì¼ì´ ì¡´ì¬í•˜ëŠ”ì§€ ê°ì§€í•˜ê³  ì—†ë‹¤ë©´ ê¸°ë³¸ ë¼ìš°íŒ… ì •ì±…(Blue í™˜ê²½ ìš°ì„  ë¼ìš°íŒ…)ì„ ë‹´ì€ íŒŒì¼ì„ ìƒì„±í•œë‹¤.</li>\n<li>í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ Blue / Green ì»¨í…Œì´ë„ˆë“¤ì„ í™•ì¸ í›„ ìµœì´ˆ ë°°í¬ê°€ ì´ë¤„ì§€ëŠ” ê²½ìš°ì¸ì§€ í™•ì¸í•œë‹¤.</li>\n<li>ìµœì´ˆ ë°°í¬ê°€ ì§„í–‰ë˜ëŠ” ê²½ìš°ë¼ë©´ Blue í™˜ê²½ìœ¼ë¡œ ë°°í¬ë¥¼ ì§„í–‰í•œë‹¤. (Green í™˜ê²½ì€ ë°°í¬í•˜ì§€ ì•ŠëŠ”ë‹¤.)</li>\n<li>ìµœì´ˆ ë°°í¬ê°€ ì§„í–‰ë˜ëŠ” ê²½ìš°ê°€ ì•„ë‹ˆë¼ë©´ ìš´ì˜ ì¤‘ì¸ <code class=\"language-text\">dynamic-config.yml</code> íŒŒì¼ì„ í™•ì¸í•˜ì—¬ í˜„ì¬ ë¼ìš°íŒ… ì¤‘ì¸ ì»¨í…Œì´ë„ˆ(OLD_SERVICE) ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.</li>\n<li>ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ë¥¼ ë¹Œë“œí•œë‹¤.</li>\n<li>ë¹Œë“œëœ ì´ë¯¸ì§€ë¡œ ìƒˆë¡œìš´ ì»¨í…Œì´ë„ˆ(TARGET_SERVICE)ë¥¼ ì‹¤í–‰í•œë‹¤.</li>\n<li>ìƒˆë¡œìš´ ì»¨í…Œì´ë„ˆì˜ Health Checkë¥¼ ê¸°ë‹¤ë¦°ë‹¤. (ì‹¤íŒ¨ì‹œ TARGET_SERVICE ì»¨í…Œì´ë„ˆë¥¼ ì‚­ì œ í›„ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì¢…ë£Œ)</li>\n<li><code class=\"language-text\">dynamic-config.yml</code>ì˜ ë¼ìš°íŒ… ëŒ€ìƒì„ ì—…ë°ì´íŠ¸ í•œë‹¤. (OLD_SERVICE â†’ TARGET_SERVICE)</li>\n<li>ì„¤ì • íŒŒì¼ì˜ ë³€ê²½ì„ ìë™ìœ¼ë¡œ ê°ì§€í•  ìˆ˜ ìˆë„ë¡ <code class=\"language-text\">dynamic-config.yml</code> íŒŒì¼ì„ ìˆ˜ì •í•œë‹¤.</li>\n</ol>\n<br>\r\n<br>\n<p>ìœ„ ìˆœì„œëŒ€ë¡œ ë™ì‘í•˜ë¯€ë¡œ ì‹ ë²„ì „(TARGET_SERVICE)ì´ ë°°í¬ë˜ê³  ì•ˆì •í™” ë˜ëŠ” ë™ì•ˆ êµ¬ë²„ì „(OLD_SERVICE)ì´ íŠ¸ë˜í”½ì„ ë°›ì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë¬´ì¤‘ë‹¨ ë°°í¬ê°€ ê°€ëŠ¥í•˜ë©°, Blue / Green í™˜ê²½ì´ ëª¨ë‘ ê³µì¡´í•˜ë¯€ë¡œ ì† ì‰½ê²Œ ë¡¤ë°± ë˜í•œ ê°€ëŠ¥í•˜ë‹¤.</p>\n<br>\r\n<br>\n<h4 id=\"2-4-ë¼ìš°íŒ…-ì •ì±…-ë³€ê²½-ìŠ¤í¬ë¦½íŠ¸\" style=\"position:relative;\"><a href=\"#2-4-%EB%9D%BC%EC%9A%B0%ED%8C%85-%EC%A0%95%EC%B1%85-%EB%B3%80%EA%B2%BD-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8\" aria-label=\"2 4 ë¼ìš°íŒ… ì •ì±… ë³€ê²½ ìŠ¤í¬ë¦½íŠ¸ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2-4. ë¼ìš°íŒ… ì •ì±… ë³€ê²½ ìŠ¤í¬ë¦½íŠ¸</h4>\n<hr>\n<p>ì‹ ë²„ì „(TARGET_SERVICE)ì´ ìƒˆë¡œ ë°°í¬ê°€ ë˜ì—ˆë‹¤ë©´, êµ¬ë²„ì „(OLD_SERVICE) í™˜ê²½ì€ ë”ì´ìƒ íŠ¸ë˜í”½ì„ ë°›ì§€ ëª»í•˜ëŠ” ìœ íœ´ ì»¨í…Œì´ë„ˆë“¤ë¡œ ì¡´ì¬í•œë‹¤.</p>\n<p>ì´ ê²½ìš°ì— ìƒˆë¡œ ë°°í¬í•œ í™˜ê²½ì—ì„œ ë¬¸ì œê°€ ë°œìƒí–ˆë‹¤ë©´ êµ¬ë²„ì „(OLD_SERVICE) í™˜ê²½ìœ¼ë¡œ ë¼ìš°íŒ… ì •ì±…ë§Œ ë³€ê²½í•˜ë©´ ì† ì‰½ê²Œ ë¡¤ë°±ì´ ê°€ëŠ¥í•˜ë‹¤.</p>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/bash</span>\r\n<span class=\"token comment\"># í™˜ê²½ ë³€ìˆ˜ ì„¤ì •</span>\r\n<span class=\"token assign-left variable\">DYNAMIC_CONFIG</span><span class=\"token operator\">=</span><span class=\"token string\">\"dynamic-config.yml\"</span>\r\n<span class=\"token assign-left variable\">COMPOSE_FILE</span><span class=\"token operator\">=</span><span class=\"token string\">\"docker-compose.yml\"</span>\r\n<span class=\"token assign-left variable\">DOMAIN</span><span class=\"token operator\">=</span><span class=\"token string\">\"localhost\"</span>\r\n<span class=\"token assign-left variable\">SERVICE</span><span class=\"token operator\">=</span><span class=\"token string\">\"web-server\"</span>\r\n<span class=\"token assign-left variable\">BLUE_SERVICE</span><span class=\"token operator\">=</span><span class=\"token string\">\"web-server-blue\"</span>\r\n<span class=\"token assign-left variable\">GREEN_SERVICE</span><span class=\"token operator\">=</span><span class=\"token string\">\"web-server-green\"</span>\r\n<span class=\"token assign-left variable\">PORT</span><span class=\"token operator\">=</span><span class=\"token number\">3000</span>\r\n\r\n<span class=\"token comment\"># 1ï¸âƒ£ í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ì„œë¹„ìŠ¤ í™•ì¸</span>\r\n<span class=\"token assign-left variable\">BLUE_RUNNING</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">docker</span> <span class=\"token function\">ps</span> <span class=\"token parameter variable\">--filter</span> <span class=\"token string\">\"name=<span class=\"token variable\">$BLUE_SERVICE</span>\"</span> <span class=\"token parameter variable\">--format</span> <span class=\"token string\">\"{{.Names}}\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">wc</span> <span class=\"token parameter variable\">-l</span><span class=\"token variable\">)</span></span>\r\n<span class=\"token assign-left variable\">GREEN_RUNNING</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">docker</span> <span class=\"token function\">ps</span> <span class=\"token parameter variable\">--filter</span> <span class=\"token string\">\"name=<span class=\"token variable\">$GREEN_SERVICE</span>\"</span> <span class=\"token parameter variable\">--format</span> <span class=\"token string\">\"{{.Names}}\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">wc</span> <span class=\"token parameter variable\">-l</span><span class=\"token variable\">)</span></span>\r\n\r\n<span class=\"token comment\"># ë‘˜ ë‹¤ ì‹¤í–‰ ì¤‘ì´ì–´ì•¼ ë¼ìš°íŒ… ì •ì±… ë³€ê²½ ê°€ëŠ¥ (ë‘˜ ì¤‘ í•˜ë‚˜ë¼ë„ êº¼ì ¸ ìˆìœ¼ë©´ ì¢…ë£Œ)</span>\r\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$BLUE_RUNNING</span>\"</span> <span class=\"token parameter variable\">-eq</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$GREEN_RUNNING</span>\"</span> <span class=\"token parameter variable\">-eq</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\r\n  <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"âŒ Blueì™€ Green ì¤‘ í•˜ë‚˜ë¼ë„ ì‹¤í–‰ë˜ì§€ ì•Šìœ¼ë©´ ë¼ìš°íŒ…ì„ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\"</span>\r\n  <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span>\r\n<span class=\"token keyword\">fi</span>\r\n\r\n<span class=\"token comment\"># 2ï¸âƒ£ í˜„ì¬ dynamic-config.ymlì—ì„œ OLD_SERVICE ê°€ì ¸ì˜¤ê¸°</span>\r\n<span class=\"token assign-left variable\">OLD_SERVICE</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">grep</span> <span class=\"token string\">\"service:\"</span> $DYNAMIC_CONFIG <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> -F<span class=\"token string\">'\"'</span> <span class=\"token string\">'{print $2}'</span><span class=\"token variable\">)</span></span>\r\n\r\n<span class=\"token comment\"># OLD_SERVICEê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ë‹¤ë©´ ì˜¤ë¥˜ ì²˜ë¦¬</span>\r\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token parameter variable\">-z</span> <span class=\"token string\">\"<span class=\"token variable\">$OLD_SERVICE</span>\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\r\n  <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"âŒ í˜„ì¬ ë¼ìš°íŒ…ëœ ì„œë¹„ìŠ¤ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë¼ìš°íŒ… ë³€ê²½ì„ ì¤‘ë‹¨í•©ë‹ˆë‹¤.\"</span>\r\n  <span class=\"token builtin class-name\">exit</span> <span class=\"token number\">1</span>\r\n<span class=\"token keyword\">fi</span>\r\n\r\n<span class=\"token comment\"># 3ï¸âƒ£ OLD_SERVICEê°€ Blueì¸ì§€ Greenì¸ì§€ í™•ì¸í•˜ê³  ë°˜ëŒ€ ì„œë¹„ìŠ¤ë¡œ ì „í™˜</span>\r\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$OLD_SERVICE</span>\"</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"<span class=\"token variable\">$BLUE_SERVICE</span>\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\r\n  <span class=\"token assign-left variable\">TARGET_SERVICE</span><span class=\"token operator\">=</span><span class=\"token variable\">$GREEN_SERVICE</span>\r\n<span class=\"token keyword\">else</span>\r\n  <span class=\"token assign-left variable\">TARGET_SERVICE</span><span class=\"token operator\">=</span><span class=\"token variable\">$BLUE_SERVICE</span>\r\n<span class=\"token keyword\">fi</span>\r\n\r\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"ğŸ”„ í˜„ì¬ ìš´ì˜ ì¤‘ì¸ ì„œë¹„ìŠ¤: <span class=\"token variable\">$OLD_SERVICE</span>\"</span>\r\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"ğŸš€ ìƒˆë¡œìš´ ë¼ìš°íŒ… ëŒ€ìƒ ì„œë¹„ìŠ¤: <span class=\"token variable\">$TARGET_SERVICE</span>\"</span>\r\n\r\n<span class=\"token comment\"># 4ï¸âƒ£ `dynamic-config.yml` ì—…ë°ì´íŠ¸ (ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ë¡œ ë¼ìš°íŒ… ë³€ê²½)</span>\r\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"ğŸ”„ Updating dynamic-config.yml to roll back to <span class=\"token variable\">$TARGET_SERVICE</span>...\"</span>\r\n<span class=\"token function\">cat</span> <span class=\"token operator\">></span> <span class=\"token variable\">$DYNAMIC_CONFIG</span> <span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">EOL\r\nhttp:\r\n  routers:\r\n    <span class=\"token variable\">$SERVICE</span>:\r\n      entryPoints:\r\n        - \"web\"\r\n      rule: \"Host(\\<span class=\"token variable\"><span class=\"token variable\">`</span>$DOMAIN<span class=\"token punctuation\">\\</span><span class=\"token variable\">`</span></span>)\"\r\n      service: \"<span class=\"token variable\">$TARGET_SERVICE</span>\"\r\n\r\n  services:\r\n    <span class=\"token variable\">$BLUE_SERVICE</span>:\r\n      loadBalancer:\r\n        servers:\r\n          - url: \"http://<span class=\"token variable\">$BLUE_SERVICE</span>:<span class=\"token variable\">$PORT</span>\"\r\n\r\n    <span class=\"token variable\">$GREEN_SERVICE</span>:\r\n      loadBalancer:\r\n        servers:\r\n          - url: \"http://<span class=\"token variable\">$GREEN_SERVICE</span>:<span class=\"token variable\">$PORT</span>\"\r\nEOL</span>\r\n\r\n<span class=\"token comment\"># 5ï¸âƒ£ Traefikì´ ì„¤ì •ì„ ìë™ ê°ì§€í•˜ë„ë¡ íŠ¸ë¦¬ê±°</span>\r\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"â™»ï¸ Triggering Traefik reload...\"</span>\r\n<span class=\"token function\">touch</span> <span class=\"token variable\">$DYNAMIC_CONFIG</span>\r\n\r\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"ğŸ‰ Rollback complete! Traffic is now routed to <span class=\"token variable\">$TARGET_SERVICE</span>.\"</span></code></pre></div>\n<br>\r\n<br>\n<h3 id=\"3-ì–´ë ¤ì› ë˜-ì \" style=\"position:relative;\"><a href=\"#3-%EC%96%B4%EB%A0%A4%EC%9B%A0%EB%8D%98-%EC%A0%90\" aria-label=\"3 ì–´ë ¤ì› ë˜ ì  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. ì–´ë ¤ì› ë˜ ì </h3>\n<hr>\n<p>ê°€ì¥ ë§ì´ ê¸°ìˆ ì ìœ¼ë¡œ ì‹œê°„ì„ í• ì• í•œ ë¶€ë¶„ì€ Blue í™˜ê²½ì´ ìš´ì˜ì¤‘ì— Green í™˜ê²½ ì¶”ê°€ë¡œ ì»¨í…Œì´ë„ˆë¡œ ë°°í¬í•˜ë©´ <code class=\"language-text\">traefik</code>ì´ ìë™ìœ¼ë¡œ Green í™˜ê²½ê¹Œì§€ ì¸ì‹í•˜ì—¬ íŠ¸ë˜í”½ì„ ë³´ë‚´ëŠ” ìƒí™©ì„ ê°œì„ í•˜ëŠ” ë¶€ë¶„ì´ì—ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>providers.docker=true  <span class=\"token comment\">#Docker ì»¨í…Œì´ë„ˆì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ì„œë¹„ìŠ¤ë“¤ì„ ìë™ìœ¼ë¡œ ê°ì§€í•˜ë„ë¡ ì„¤ì •</span>\r\n<span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>providers.docker.watch=true  <span class=\"token comment\">#Dockerì—ì„œ ìƒˆë¡œìš´ ì»¨í…Œì´ë„ˆê°€ ìƒì„±ë˜ê±°ë‚˜ ë³€ê²½ë  ê²½ìš° ìë™ìœ¼ë¡œ ê°ì§€.</span></code></pre></div>\n<p><code class=\"language-text\">traefik</code> ì»¨í…Œì´ë„ˆì˜ ìœ„ ë‘ ì„¤ì •ì€ ë°˜ë“œì‹œ í•„ìš”í•˜ì§€ë§Œ ê·¸ë ‡ê¸°ì— Blue / Green í™˜ê²½ì„ ë…ë¦½ì ì¸ í™˜ê²½ìœ¼ë¡œ ê°ê° ë¶„ë¦¬í•˜ê¸°ê°€ ì–´ë µê²Œí•˜ëŠ” ìš”ì¸ ì¤‘ í•˜ë‚˜ì˜€ë‹¤. ğŸ¥²</p>\n<br>\n<p>ìµœì¢…ì ìœ¼ë¡œëŠ” ì»¨í…Œì´ë„ˆë§ˆë‹¤ Blue / Green ë¼ë²¨ì„ ë¶€ì—¬í•´ì„œ ë¼ìš°íŒ…ì„ ë™ì ìœ¼ë¡œ í• ë‹¹í•˜ëŠ” ë°©ë²•ì„ ì±„íƒí•˜ì—¬ ì‚¬ìš©í•˜ì˜€ì§€ë§Œ, ê·¸ ê³¼ì •ì´ ìˆœíƒ„í•˜ì§€ëŠ” ì•Šì•˜ë‹¤.</p>\n<ul>\n<li><strong>TARGET_SERVICE</strong>ë¡œ ì „ë‹¬ë˜ëŠ” íŠ¸ë˜í”½ì„ ì°¨ë‹¨ í•˜ê¸° ìœ„í•´ Docker Networkë¥¼ ì„ì‹œë¡œ ì—°ê²°ì„ ëŠëŠ”ë‹¤. â†’ ì™¸ë¶€ DB ì—°ê²°ì´ ëŠê¸°ë©° ORMì—ì„œ DB ì—°ê²° ì´ˆê¸°í™”ê°€ ë˜ì§€ ì•ŠëŠ” ì´ìŠˆê°€ ë°œìƒí•˜ë©° Health Checkë¥¼ í†µê³¼í•˜ì§€ ëª»í•œë‹¤. ğŸ˜…</li>\n<li><strong>TARGET_SERVICE</strong>ê°€ ìƒˆë¡œ ë°°í¬ í›„ Health Checkë¥¼ í†µê³¼í•˜ë©´ <strong>OLD_SERVICE</strong>ë¥¼ ë°”ë¡œ ì œê±°í•œë‹¤. â†’ ìˆ˜ ì´ˆ ë‚´ì™¸ë¡œ ë‘ ì„œë¹„ìŠ¤ê°€ ê³µì¡´í•˜ëŠ” ìˆœê°„ì´ ë°œìƒí•  ìˆ˜ ë°–ì— ì—†ìœ¼ë©°, ì´ìƒì ì¸ Blue / Green ë°°í¬ ì „ëµê³¼ëŠ” ê±°ë¦¬ê°€ ë©€ë‹¤. ğŸ˜…</li>\n</ul>\n<br>\n<p>ìƒê°ë‚˜ëŠ”ëŒ€ë¡œ ì ì–´ë³´ë‹ˆ ìœ„ì™€ ê°™ì€ ê²½ìš°ë“¤ì´ ìƒê°ì´ ë‚œë‹¤.</p>\n<br>\r\n<br>\n<h2 id=\"-understanding\" style=\"position:relative;\"><a href=\"#-understanding\" aria-label=\" understanding permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ¤” Understanding</h2>\n<p>ì‚¬ì‹¤ ì‹¤ì œë¡œ ê°€ì¥ ë§ì€ ì‹œê°„ì„ í• ì• í•œ ë¶€ë¶„ì€ ê¸°ìˆ  ê²€ì¦ì´ì—ˆë‹¤.</p>\n<ul>\n<li>ìœ íœ´ ì»¨í…Œì´ë„ˆë“¤ë¡œ ì¸í•´ ë¦¬ì†ŒìŠ¤ ë‚­ë¹„ê°€ ë°œìƒí•  ìˆ˜ ë°–ì— ì—†ëŠ”ë° ì´ëŠ” ì–¼ë§ˆë‚˜ í° ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ê°€?</li>\n<li>ê¸°ì¡´ì— ë°°í¬í•˜ëŠ” ë°©ì‹(Recreated)ì— ë¹„í•´ ì–´ë–¤ì ì´ ì–¼ë§ˆë‚˜ ê°œì„ í•˜ëŠ”ì§€ì— ëŒ€í•œ ì •ëŸ‰ì ì¸ ìˆ˜ì¹˜í™”</li>\n<li>ë°°í¬ ì‹¤íŒ¨ì‹œ í”ŒëœB ê³„íš</li>\n</ul>\n<p>ì´ ì™¸ì— ë¬´ì¤‘ë‹¨ ë°°í¬ë¥¼ í™œìš©í•  ìˆ˜ ìˆëŠ” íŒŒì´í”„ë¼ì¸ (Hotfix) ì¶”ê°€ ë“±ë“±.. ê°œë°œ ì™¸ì ì¸ ë¶€ë¶„ë“¤ì—ì„œ ë”ìš± ë” ì‹œê°„ê³¼ ì‹ ê²½ì„ ë§ì´ ì¼ë˜ê±° ê°™ë‹¤.</p>\n<br>\r\n<br>\n<div class=\"gatsby-highlight\" data-language=\"toc\"><pre class=\"language-toc\"><code class=\"language-toc\"></code></pre></div>","excerpt":"âœï¸ Today I Learned ì‚¬ë‚´ ì¸í”„ë¼ëŠ” ë¹„êµì  ì„±ëŠ¥ì´ ì¢‹ì€ ì„œë²„ë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤. (ìˆ˜í‰ì  í™•ì¥ì´ í˜ë“¤ì–´ì„œ.. ğŸ¥²) ê·¸ë ‡ê¸°ì— ì´ˆê¸° ì¸í”„ë¼ë¥¼ êµ¬ì„±í•  ë• ë¦¬ì†ŒìŠ¤ ë¶€ì¡±ì— í—ˆë•ì´ì§„ ì•Šê³ ìˆë‹¤. (ë‹¤ë§Œ, ìš”ì²­ì´ ê¸‰ì¦í• êº¼ë¼ ì˜ˆìƒë  ë•Œ ìˆ˜í‰ì ìœ¼ë¡œ í™•ì¥í•˜ê¸°ëŠ” ì‰½ì§€ ì•Šë‹¤.) ì´ëŸ¬í•œ ë°”íƒ•ì„ í† ëŒ€ë¡œ ì˜¨í”„ë ˆë¯¸ìŠ¤ í™˜ê²½ì—ì„œ Docker Composeë¡œ Blue/Green ë°°í¬ ì „ëµì„ êµ¬í˜„í•œ ê³¼ì •ì„ ê°„ëµíˆ í¬ìŠ¤íŒ…ìœ¼ë¡œ ë‚¨ê¸°ë ¤í•œë‹¤. 1. Blue/Green ë°°í¬ë€? ê°„ë‹¨íˆ ì†Œê°œí•˜ìë©´, ì—¬ëŸ¬ ë¬´ì¤‘ë‹¨ ë°°í¬ ê¸°ë²• ì¤‘ í•˜ë‚˜ì´ë©° ë‘ ê°œì˜ ë…ë¦½ì ì¸ í™˜ê²½ Blue(êµ¬ë²„ì „) í™˜ê²½ê³¼ Green(ì‹ ë²„ì „) í™˜ê²½ì„ ê°€ì§€ê³  ì§„í–‰ë˜ëŠ” ë°°í¬ ì „ëµì´ë‹¤. blue/green êµ¬ë²„ì „ì´ ìš´ì˜ë˜ëŠ” ë™ì•ˆ ì‹ ë²„ì „ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ êµ¬ì„±í•œ í›„ ë¡œë“œë°¸ëŸ°ì„œë¥¼ í†µí•´ ì‹ ë²„ì „ìœ¼ë¡œ ëª¨ë“  íŠ¸ë˜í”½ì„ ì¼ì‹œì— ì „í™˜í•˜ëŠ” ë°°í¬ ë°©ì‹ì´ë‹¤. ì‹ ë²„ì „ì— ë¬¸ì œê°€ ìƒê¸°ëŠ” ê²½ìš° ë¡œë“œë°¸ëŸ°ì„œì˜ ë¼ìš°íŒ…ë§Œ êµ¬ë²„ì „ìœ¼ë¡œ ë³€ê²½í•´ì£¼ë©´ ì† ì‰½ê²Œ ë¡¤ë°±ì´ ê°€ëŠ¥í•œ ì¥ì  ë˜í•œ ìˆì§€ë§Œ ê·¸ ë§Œí¼ ë¦¬ì†ŒìŠ¤ë¥¼ ë§ì´ â€¦","timeToRead":8,"tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EF%B8%8F-today-i-learned\">âœï¸ <strong>T</strong>oday <strong>I</strong> <strong>L</strong>earned</a></p>\n<ul>\n<li>\n<p><a href=\"#1-bluegreen-%EB%B0%B0%ED%8F%AC%EB%9E%80\">1. Blue/Green ë°°í¬ë€?</a></p>\n</li>\n<li>\n<p><a href=\"#2-docker-compose\">2. Docker Compose</a></p>\n<ul>\n<li><a href=\"#2-1-traefik\">2-1. traefik</a></li>\n<li><a href=\"#2-2-web-server\">2-2. web-server</a></li>\n<li><a href=\"#2-3-%EB%B0%B0%ED%8F%AC-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8\">2-3. ë°°í¬ ìŠ¤í¬ë¦½íŠ¸</a></li>\n<li><a href=\"#2-4-%EB%9D%BC%EC%9A%B0%ED%8C%85-%EC%A0%95%EC%B1%85-%EB%B3%80%EA%B2%BD-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8\">2-4. ë¼ìš°íŒ… ì •ì±… ë³€ê²½ ìŠ¤í¬ë¦½íŠ¸</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#3-%EC%96%B4%EB%A0%A4%EC%9B%A0%EB%8D%98-%EC%A0%90\">3. ì–´ë ¤ì› ë˜ ì </a></p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-understanding\">ğŸ¤” Understanding</a></p>\n</li>\n</ul>","frontmatter":{"date":"2025.03.16","title":"Docker Composeì™€ Traefikì„ í™œìš©í•œ Blue/Green ë°°í¬ ì „ëµ","categories":"TIL","author":"JH8459","emoji":"ğŸ“š"},"fields":{"slug":"/2025-03-16-TIL/"}},"next":{"id":"167d23d4-8f42-5908-bf81-be67083c9ef8","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAID/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAX/2gAMAwEAAhADEAAAAdJomgf/xAAWEAADAAAAAAAAAAAAAAAAAAAAASD/2gAIAQEAAQUCFP8A/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFhAAAwAAAAAAAAAAAAAAAAAAACAx/9oACAEBAAY/AiL/AP/EABgQAAIDAAAAAAAAAAAAAAAAAAABESAx/9oACAEBAAE/IRm9hX//2gAMAwEAAgADAAAAEEw//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGRAAAgMBAAAAAAAAAAAAAAAAAREAIEFR/9oACAEBAAE/EI1YY7tf/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"github-blog.png\"\n        title=\"\"\n        src=\"/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/80e3c/TIL.jpg\"\n        srcset=\"/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/4ec73/TIL.jpg 180w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/158ba/TIL.jpg 360w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/80e3c/TIL.jpg 720w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/47311/TIL.jpg 1080w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/ac614/TIL.jpg 1272w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<br>\n<h2 id=\"ï¸-today-i-learned\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-today-i-learned\" aria-label=\"ï¸ today i learned permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>âœï¸ <strong>T</strong>oday <strong>I</strong> <strong>L</strong>earned</h2>\n<p>í”„ë¡œê·¸ë˜ë¨¸ìŠ¤ <a href=\"https://school.programmers.co.kr/learn/courses/30/lessons/42860\" target=\"_blank\">ì¡°ì´ìŠ¤í‹±</a> ì•Œê³ ë¦¬ì¦˜ ë¬¸ì œ í’€ì´ ê³¼ì • ì¤‘ ê·¸ë¦¬ë”” ì•Œê³ ë¦¬ì¦˜ì„ í’€ì´í•˜ë©° ëŠë‚€ì ì„ ê°„ë‹¨íˆ í¬ìŠ¤íŒ…ìœ¼ë¡œ ë‚¨ê¸°ë ¤í•œë‹¤.</p>\n<br>\r\n<br>\n<h3 id=\"1-ë¬¸ì œ\" style=\"position:relative;\"><a href=\"#1-%EB%AC%B8%EC%A0%9C\" aria-label=\"1 ë¬¸ì œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. ë¬¸ì œ</h3>\n<hr>\n<p>ë¬¸ì œ ì„¤ëª…</p>\n<ul>\n<li>\n<p>ì¡°ì´ìŠ¤í‹±ìœ¼ë¡œ ì•ŒíŒŒë²³ ì´ë¦„ì„ ì™„ì„±í•˜ì„¸ìš”. ë§¨ ì²˜ìŒì—” Aë¡œë§Œ ì´ë£¨ì–´ì ¸ ìˆìŠµë‹ˆë‹¤. ex) ì™„ì„±í•´ì•¼ í•˜ëŠ” ì´ë¦„ì´ ì„¸ ê¸€ìë©´ AAA, ë„¤ ê¸€ìë©´ AAAA</p>\n<p>ì¡°ì´ìŠ¤í‹±ì„ ê° ë°©í–¥ìœ¼ë¡œ ì›€ì§ì´ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">â–² - ë‹¤ìŒ ì•ŒíŒŒë²³\r\nâ–¼ - ì´ì „ ì•ŒíŒŒë²³ (Aì—ì„œ ì•„ë˜ìª½ìœ¼ë¡œ ì´ë™í•˜ë©´ Zë¡œ)\r\nâ—€ - ì»¤ì„œë¥¼ ì™¼ìª½ìœ¼ë¡œ ì´ë™ (ì²« ë²ˆì§¸ ìœ„ì¹˜ì—ì„œ ì™¼ìª½ìœ¼ë¡œ ì´ë™í•˜ë©´ ë§ˆì§€ë§‰ ë¬¸ìì— ì»¤ì„œ)\r\nâ–¶ - ì»¤ì„œë¥¼ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì´ë™ (ë§ˆì§€ë§‰ ìœ„ì¹˜ì—ì„œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì´ë™í•˜ë©´ ì²« ë²ˆì§¸ ë¬¸ìì— ì»¤ì„œ)</code></pre></div>\n<p>ì˜ˆë¥¼ ë“¤ì–´ ì•„ë˜ì˜ ë°©ë²•ìœ¼ë¡œ â€œJAZâ€ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">- ì²« ë²ˆì§¸ ìœ„ì¹˜ì—ì„œ ì¡°ì´ìŠ¤í‹±ì„ ìœ„ë¡œ 9ë²ˆ ì¡°ì‘í•˜ì—¬ Jë¥¼ ì™„ì„±í•©ë‹ˆë‹¤.\r\n- ì¡°ì´ìŠ¤í‹±ì„ ì™¼ìª½ìœ¼ë¡œ 1ë²ˆ ì¡°ì‘í•˜ì—¬ ì»¤ì„œë¥¼ ë§ˆì§€ë§‰ ë¬¸ì ìœ„ì¹˜ë¡œ ì´ë™ì‹œí‚µë‹ˆë‹¤.\r\n- ë§ˆì§€ë§‰ ìœ„ì¹˜ì—ì„œ ì¡°ì´ìŠ¤í‹±ì„ ì•„ë˜ë¡œ 1ë²ˆ ì¡°ì‘í•˜ì—¬ Zë¥¼ ì™„ì„±í•©ë‹ˆë‹¤. ë”°ë¼ì„œ 11ë²ˆ ì´ë™ì‹œì¼œ \"JAZ\"ë¥¼ ë§Œë“¤ ìˆ˜ ìˆê³ , ì´ë•Œê°€ ìµœì†Œ ì´ë™ì…ë‹ˆë‹¤.</code></pre></div>\n<p>ë§Œë“¤ê³ ì í•˜ëŠ” ì´ë¦„ nameì´ ë§¤ê°œë³€ìˆ˜ë¡œ ì£¼ì–´ì§ˆ ë•Œ, ì´ë¦„ì— ëŒ€í•´ ì¡°ì´ìŠ¤í‹± ì¡°ì‘ íšŸìˆ˜ì˜ ìµœì†Ÿê°’ì„ return í•˜ë„ë¡ solution í•¨ìˆ˜ë¥¼ ë§Œë“œì„¸ìš”.</p>\n</li>\n</ul>\n<p>ì œí•œì‚¬í•­</p>\n<ul>\n<li>nameì€ ì•ŒíŒŒë²³ ëŒ€ë¬¸ìë¡œë§Œ ì´ë£¨ì–´ì ¸ ìˆìŠµë‹ˆë‹¤.</li>\n<li>nameì˜ ê¸¸ì´ëŠ” 1 ì´ìƒ 20 ì´í•˜ì…ë‹ˆë‹¤.</li>\n</ul>\n<p>ì…ì¶œë ¥ ì˜ˆ</p>\n<ul>\n<li>\n<table>\n<thead>\n<tr>\n<th>name</th>\n<th>return</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>â€œJEROENâ€</td>\n<td>56</td>\n</tr>\n<tr>\n<td>â€œJANâ€</td>\n<td>23</td>\n</tr>\n</tbody>\n</table>\n</li>\n</ul>\n<br>\r\n<br>\n<h3 id=\"2-í’€ì´\" style=\"position:relative;\"><a href=\"#2-%ED%92%80%EC%9D%B4\" aria-label=\"2 í’€ì´ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. í’€ì´</h3>\n<hr>\n<p>ìœ„ì•„ë˜(â–², â–¼)ë¡œ ì¡°ì´ìŠ¤í‹±ì„ ì¡°ì‘í•˜ëŠ” ê²½ìš°ì™€ ì¢Œìš°(â—€, â–¶)ë¡œ ì¡°ì‘í•˜ëŠ” ê²½ìš°ë¥¼ ê°ê° ê³„ì‚°í•´ì„œ í•©ì‚°í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•˜ì˜€ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">solution</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">let</span> answer <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> length <span class=\"token operator\">=</span> name<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// ì•ŒíŒŒë²³ ë³€ê²½ íšŸìˆ˜ ê³„ì‚° í•¨ìˆ˜</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getUpDownCnt</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">char</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> upCnt <span class=\"token operator\">=</span> char<span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token string\">'A'</span><span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">const</span> downCnt <span class=\"token operator\">=</span> <span class=\"token string\">'Z'</span><span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> char<span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">return</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">min</span><span class=\"token punctuation\">(</span>upCnt<span class=\"token punctuation\">,</span> downCnt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// â–², â–¼ ì•ŒíŒŒë²³ ë³€ê²½ íšŸìˆ˜ ê³„ì‚°</span>\r\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        answer <span class=\"token operator\">+=</span> <span class=\"token function\">getUpDownCnt</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token comment\">// ì´ë¦„ì— 'A'ê°€ ì—†ëŠ” ê²½ìš° ìš°ì¸¡(â–¶)ìœ¼ë¡œë§Œ ì´ë™í•˜ëŠ” ê¸°ë³¸ ì´ë™ íšŸìˆ˜</span>\r\n    <span class=\"token keyword\">let</span> minMove <span class=\"token operator\">=</span> length <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n    \r\n    <span class=\"token comment\">// â—€, â–¶ ì»¤ì„œ ì´ë™ ìµœì†Œ ê±°ë¦¬ ê³„ì‚°</span>\r\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">let</span> next <span class=\"token operator\">=</span> i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n        \r\n        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>next <span class=\"token operator\">&lt;</span> length <span class=\"token operator\">&amp;&amp;</span> name<span class=\"token punctuation\">[</span>next<span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token string\">'A'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            next<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n        \r\n        <span class=\"token comment\">// ì¢Œ, ìš° ì–´ëŠìª½ì´ ìµœì†Œê°’ ì´ë™ì¸ì§€ íŒë‹¨</span>\r\n        <span class=\"token keyword\">const</span> move <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">min</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">*</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> length <span class=\"token operator\">-</span> next<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>length <span class=\"token operator\">-</span> next<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span> <span class=\"token operator\">+</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        minMove <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">min</span><span class=\"token punctuation\">(</span>minMove<span class=\"token punctuation\">,</span> move<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token keyword\">return</span> answer <span class=\"token operator\">+</span> minMove<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ìœ„ì•„ë˜ë¡œ ì¡°ì‘í•˜ëŠ” ê²½ìš°ëŠ” ê°„ë‹¨íˆ êµ¬í˜„í•˜ì˜€ìœ¼ë‚˜ ìµœì†Œ ì»¤ì„œ ì´ë™íšŸìˆ˜ë¥¼ êµ¬í•˜ëŠ”ë° ì‹œê°„ì´ ì˜¤ë˜ê±¸ë ¸ë‹¤.</p>\n<ol>\n<li>í˜„ì¬ ìœ„ì¹˜ <code class=\"language-text\">i</code> ì´í›„ì—ì„œ â€˜Aâ€™ê°€ ì•„ë‹Œ ì²«ë²ˆì§¸ ë¬¸ìì˜ ì¸ë±ìŠ¤ë¥¼ ì°¾ê¸° ìœ„í•œ ë³€ìˆ˜ <code class=\"language-text\">next</code> ì„ ì–¸.</li>\n<li><code class=\"language-text\">next</code>ëŠ” â€˜Aâ€™ë¥¼ ê±´ë„ˆ ë›°ë©° â€˜Aâ€™ê°€ ì•„ë‹Œ ë¬¸ìê°€ ë‚˜ì˜¬ ë•Œê¹Œì§€ ì¦ê°€í•œë‹¤.</li>\n<li>ë§ˆì§€ë§‰ìœ¼ë¡œ ë‘ê°€ì§€ ì´ë™ ë°©ì‹ì„ ë¹„êµí•´ì•¼í•œë‹¤. (ì˜¤ë¥¸ìª½ í›„ ì™¼ìª½, ì™¼ìª½ í›„ ì˜¤ë¥¸ìª½)</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">name <span class=\"token operator\">=</span> <span class=\"token string\">\"JAZAAAZ\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br>\n<p>ìœ„ ê²½ìš°ì—” ì²˜ìŒ ì»¤ì„œ ìœ„ì¹˜ì—ì„œ ìš°ë¡œ 2ë²ˆ (â–¶, â–¶) ì´í›„ ì¢Œë¡œ 3ë²ˆ (â—€, â—€, â—€) ì›€ì§ì—¬ì„œ ë§ˆì§€ë§‰ Zë¡œ ë„ì°©í•˜ëŠ” ê²½ìš°ì˜ ìˆ˜ê°€ ê°€ì¥ ë¹ ë¥´ë‹¤. (ì´ ë°˜ë¡€ê°€ ìˆë‹¤ëŠ”ê±¸ ìƒê°ì„ ëª»í–ˆë‹¤.)</p>\n<br>\r\n<br>\n<h2 id=\"-understanding\" style=\"position:relative;\"><a href=\"#-understanding\" aria-label=\" understanding permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ¤” Understanding</h2>\n<p>ë‹¨ìˆœí•´ë³´ì˜€ëŠ”ë° ê½¤ë‚˜ ì• ë¥¼ ë¨¹ì—ˆë‹¤. (ê¸°ë³¸ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ëŠ” ë°˜ë¡€ë¥¼ ê³ ë ¤í•˜ì§€ ì•Šì•„ë„ ëª¨ë‘ í†µê³¼í–ˆê¸° ë•Œë¬¸ì—..ğŸ¥²)</p>\n<p>ë°˜ë¡€ë¥¼ ì°¾ì€ ë’¤ì—ì•¼ í’€ì´ê°€ ê°€ëŠ¥í–ˆë‹¤.</p>\n<br>\r\n<br>\n<div class=\"gatsby-highlight\" data-language=\"toc\"><pre class=\"language-toc\"><code class=\"language-toc\"></code></pre></div>","frontmatter":{"date":"2025.03.13","title":"í”„ë¡œê·¸ë˜ë¨¸ìŠ¤ - ì¡°ì´ìŠ¤í‹± (JS)","categories":"TIL","author":"JH8459","emoji":"ğŸ“š"},"fields":{"slug":"/2025-03-13-TIL/"}},"prev":{"id":"45a5dca2-a8e0-5043-b4f4-936e507bb529","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAID/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAX/2gAMAwEAAhADEAAAAdJomgf/xAAWEAADAAAAAAAAAAAAAAAAAAAAASD/2gAIAQEAAQUCFP8A/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFhAAAwAAAAAAAAAAAAAAAAAAACAx/9oACAEBAAY/AiL/AP/EABgQAAIDAAAAAAAAAAAAAAAAAAABESAx/9oACAEBAAE/IRm9hX//2gAMAwEAAgADAAAAEEw//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGRAAAgMBAAAAAAAAAAAAAAAAAREAIEFR/9oACAEBAAE/EI1YY7tf/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"github-blog.png\"\n        title=\"\"\n        src=\"/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/80e3c/TIL.jpg\"\n        srcset=\"/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/4ec73/TIL.jpg 180w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/158ba/TIL.jpg 360w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/80e3c/TIL.jpg 720w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/47311/TIL.jpg 1080w,\n/static/7c4bbfe7d1a9d6bc02891c94bfe039dc/ac614/TIL.jpg 1272w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<br>\n<h2 id=\"ï¸-today-i-learned\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-today-i-learned\" aria-label=\"ï¸ today i learned permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>âœï¸ <strong>T</strong>oday <strong>I</strong> <strong>L</strong>earned</h2>\n<p><code class=\"language-text\">Docker</code> íŒŒì¼ì„ ì‘ì„±í•  ë•Œ ìŠµê´€ì²˜ëŸ¼ í° ì˜ì‹¬ì—†ì´ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•˜ê³¤í•œë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">...</span>\r\n<span class=\"token comment\"># 3ë‹¨ê³„: ë¹Œë“œ</span>\r\nRUN npm run build\r\n\r\nCMD <span class=\"token punctuation\">[</span><span class=\"token string\">\"node\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"./dist/main.js\"</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p><code class=\"language-text\">package.json</code>ì— ë³„ë‹¤ë¥¸ ì„¤ì •ì„ ì•ˆí•´ë‘ì—ˆë‹¤ë©´ ì•„ë˜ì™€ ê°™ì„êº¼ë¼ <strong>npm run start:prod</strong> ëª…ë ¹ê³¼ ê°™ì€ ëª…ë ¹ì–´ì´ì§€ë§Œ ìŠµê´€(?)ì²˜ëŸ¼ <code class=\"language-text\">Dockerfile</code>ì„ ì‘ì„±í•  ë• â€œ./dist/main.jsâ€ë¥¼ ì§ì ‘ ì‹¤í–‰ì‹œí‚¤ê³  ìˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n  ...\r\n  <span class=\"token property\">\"start:prod\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node dist/main\"</span><span class=\"token punctuation\">,</span>\r\n  ...</code></pre></div>\n<br>\r\n<br>\n<p>í”„ë ˆì„ì›Œí¬ì—ì„œ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ëŠ” <strong>nest start</strong> CLI ëª…ë ¹ì–´ ë˜í•œ ì„œë²„ë¥¼ êµ¬ë™ì‹œí‚¤ëŠ” ëª…ë ¹ì–´ì¸ë°, ë¹Œë“œëœ .js íŒŒì¼ì„ ì§ì ‘ ì‹¤í–‰ì‹œí‚¤ëŠ” ê²ƒê³¼ ì–´ë–¤ ì°¨ì´ê°€ ìˆì„ì§€ ê¶ê¸ˆí•´ì„œ ì°¾ì•„ë³¸ ê²°ê³¼ë¥¼ ê°„ëµíˆ ë‚¨ê¸°ë ¤í•œë‹¤.</p>\n<br>\r\n<br>\n<h3 id=\"1-ëˆˆì—-ë„ëŠ”-ì°¨ì´ì ì€\" style=\"position:relative;\"><a href=\"#1-%EB%88%88%EC%97%90-%EB%9D%84%EB%8A%94-%EC%B0%A8%EC%9D%B4%EC%A0%90%EC%9D%80\" aria-label=\"1 ëˆˆì— ë„ëŠ” ì°¨ì´ì ì€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. ëˆˆì— ë„ëŠ” ì°¨ì´ì ì€?</h3>\n<hr>\n<p>ì‚¬ì‹¤ ì…ì‚¬ ì´ˆê¸°ì— ë¡œì»¬ í™˜ê²½ì—ì„œ ì“°ë˜ <code class=\"language-text\">Docker</code> íŒŒì¼ì´ ê·¸ëŒ€ë¡œ ìš´ì˜ í™˜ê²½<del>(ì‹¬ì§€ì–´ â€”watch ì˜µì…˜ê¹Œì§€)</del>ê¹Œì§€ ì´ì–´ì§„ ê²½í—˜ì´ ìˆì–´ì„œ Nest CLI ëª…ë ¹ì–´ëŠ” ì–´ë–¤ ì‚¬ì´ë“œ ì´í™íŠ¸ë¥¼ ë°œìƒì‹œí‚¤ëŠ”ì§€ ì´ë¯¸ ëª¸ì†Œ ì²´í—˜í•´ë³¸ì ì´ ìˆë‹¤. ğŸ¥²</p>\n<p>ê°„ë‹¨íˆ ê°™ì€ ì½”ë“œ ë² ì´ìŠ¤ë¡œ Nest CLI ëª…ë ¹ì–´ì™€ ë¹Œë“œëœ .js íŒŒì¼ì„ ì§ì ‘ ì‹¤í–‰í•œ í™˜ê²½ìœ¼ë¡œ ë‚˜ëˆ„ì–´ì„œ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ëˆˆìœ¼ë¡œë„ í™•ì¸ì´ ê°€ëŠ¥í• ë§Œí•œ ì°¨ì´ì ì„ ë³´ì´ëŠ” ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.</p>\n<br>\n<img src=\"https://jh8459.s3.ap-northeast-2.amazonaws.com/blog/2025-03-19-TIL/Initial.png\">\n<center>Nest CLIë¡œ \"nest start\"ë¡œ ì‹¤í–‰í•œ ì»¨í…Œì´ë„ˆëŠ” ì´ˆê¸°í™” ê³¼ì •ì—ì„œ CPU ì ìœ ìœ¨ë„ ì—„ì²­ë‚˜ë‹¤ ğŸ˜²</center><br><br>\n<br>\n<img src=\"https://jh8459.s3.ap-northeast-2.amazonaws.com/blog/2025-03-19-TIL/Stabilization.png\">\n<center>ì´ˆê¸°í™” ê³¼ì • ì´í›„ì—ë„ ë©”ëª¨ë¦¬ ì ìœ ìœ¨ì´ 2ë°°ê°€ ë„˜ê²Œ ì°¨ì´ê°€ ë‚œë‹¤.</center><br><br>\n<p>ìœ ì˜ë¯¸í•œ ì„±ëŠ¥ ì°¨ì´ê°€ ì¡´ì¬í•œë‹¤ëŠ” ì ì€ ì•Œê³  ìˆì—ˆìœ¼ë‚˜ ìƒê°í–ˆì—ˆë˜ ìˆ˜ì¹˜ë³´ë‹¤ ë” í¬ê²Œ ë²Œì–´ì§„ê±¸ ëˆˆìœ¼ë¡œ ì§ì ‘ë³´ë‹ˆ ë†€ë¼ì› ë‹¤.</p>\n<br>\r\n<br>\n<h3 id=\"2-nest-cli\" style=\"position:relative;\"><a href=\"#2-nest-cli\" aria-label=\"2 nest cli permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Nest CLI</h3>\n<hr>\n<p>ì™œ ì´ëŸ° í° ì„±ëŠ¥ ì°¨ì´ë¥¼ ë³´ì´ëŠ”ì§€ëŠ” Nest CLIì˜ actionsì— ì •ì˜ëœ <code class=\"language-text\">start.action.ts</code> íŒŒì¼ì„ ëœ¯ì–´ë³´ë©´ ì•Œ ìˆ˜ ìˆë‹¤.</p>\n<blockquote>\n<p><a href=\"https://github.com/nestjs/nest-cli/blob/c152351bba98b0562958b0d0223b7636c0183cb3/actions/start.action.ts#L17\" target=\"_blank\">nest-cli/actions/start.action.ts</a></p>\n</blockquote>\n<br>\r\n<br>\n<p>Nest CLI ëª…ë ¹ìœ¼ë¡œ ì‹¤í–‰í•œ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ì„±ëŠ¥ ì €í•˜ í¬ì¸íŠ¸ë“¤ì„ ìš”ì•½í•˜ìë©´ ì•„ë˜ì™€ ê°™ë‹¤.</p>\n<ol>\n<li>\n<p>NestJS ì„¤ì • íŒŒì¼ ë¡œë“œ</p>\n<ul>\n<li>\n<p><strong>commandOptions</strong>ì—ì„œ config ì˜µì…˜ì„ ì°¾ê³ , ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ <strong>this.loader.load(configFileName)</strong>ì„ í˜¸ì¶œí•˜ì—¬ <code class=\"language-text\">nestjs-cli.json</code> íŒŒì¼ì„ ë¡œë“œí•œë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\r\n  <span class=\"token property\">\"$schema\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://json.schemastore.org/nest-cli\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"collection\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"@nestjs/schematics\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"sourceRoot\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"src\"</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n</ul>\n</li>\n<li>\n<p>TS ì»´íŒŒì¼ëŸ¬ ì„¤ì • ë¡œë“œ</p>\n<ul>\n<li>\n<p><strong>getTscConfigPath()</strong>ë¥¼ í†µí•´ <code class=\"language-text\">tsconfig.json</code> ê²½ë¡œë¥¼ ì°¾ê³ , JSON ê°’ì„ íŒŒì‹±í•œ ê²°ê³¼ ì¤‘ outDir ê°’ì„ ê°€ì ¸ì˜¨ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\r\n  <span class=\"token property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token property\">\"module\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"commonjs\"</span><span class=\"token punctuation\">,</span>\r\n    ...\r\n    <span class=\"token property\">\"outDir\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"./dist\"</span><span class=\"token punctuation\">,</span>\r\n    ...\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n</ul>\n</li>\n<li>\n<p>ë¹Œë“œ ë° ì‹¤í–‰</p>\n<ul>\n<li>\n<p><strong>BuildAction.runBuild()</strong>ê°€ ì‹¤í–‰ë˜ë©° TypeScriptë¥¼ ë¹Œë“œí•œë‹¤.</p>\n</li>\n<li>\n<p>ë¹Œë“œ í›„ <strong>createOnSuccessHook()</strong>ì´ ì‹¤í–‰ë˜ë©° ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ëœë‹¤.</p>\n<ul>\n<li><strong>spawnChildProcess()</strong>ë¥¼ í†µí•´ <strong>child_process.spawn()</strong>ì„ ì‚¬ìš©í•˜ì—¬ ìƒˆë¡œìš´ í”„ë¡œì„¸ìŠ¤ë¡œ ê°ì‹¸ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•œë‹¤.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n<br>\r\n<br>\n<p>ì¦‰, Nest CLI ëª…ë ¹ì–´ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ë©´ ì—¬ëŸ¬ ì„¤ì • íŒŒì¼ë“¤ì„ ë¡œë“œí•˜ë©° ìƒˆë¡œì´ ë¹Œë“œí•œ ê²°ê³¼ë¬¼ì„ ìƒˆë¡œìš´ í”„ë¡œì„¸ì„œë¡œ ê°ì‹¸ì„œ ì‹¤í–‰í•˜ê³  ìˆëŠ” ìƒí™©ì´ë‹¤.</p>\n<br>\n<table>\n<thead>\n<tr>\n<th>í•­ëª©</th>\n<th><strong>â€œnest startâ€</strong></th>\n<th><strong>â€œnode dist/main.jsâ€</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>ì„¤ì • íŒŒì¼ ë¡œë“œ</strong></td>\n<td>Nest CLI ì„¤ì • íŒŒì¼ (<code class=\"language-text\">nest-cli.json</code>)ì„ ë¡œë“œí•¨</td>\n<td>ì„¤ì • íŒŒì¼ì„ ë¡œë“œí•˜ì§€ ì•ŠìŒ</td>\n</tr>\n<tr>\n<td><strong>ë¹Œë“œ ê³¼ì •</strong></td>\n<td>TS ì„¤ì • íŒŒì¼(<code class=\"language-text\">tsconfig.json</code>)ë¡œ TypeScript ë¹Œë“œ</td>\n<td>ì´ë¯¸ ë¹Œë“œëœ JS íŒŒì¼ ì‹¤í–‰</td>\n</tr>\n<tr>\n<td><strong>í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬</strong></td>\n<td><strong>spawnChildProcess()</strong>ë¥¼ í†µí•´ ë³„ë„ í”„ë¡œì„¸ìŠ¤ë¥¼ ìƒì„±</td>\n<td><strong>node</strong> í”„ë¡œì„¸ìŠ¤ë¥¼ ì§ì ‘ ì‹¤í–‰</td>\n</tr>\n<tr>\n<td><strong>ì˜µì…˜</strong></td>\n<td><code class=\"language-text\">--watch</code> ì˜µì…˜ ì§€ì› (í•« ë¦¬ë¡œë“œ)</td>\n<td>ì—†ìŒ</td>\n</tr>\n</tbody>\n</table>\n<br>\r\n<br>\n<h2 id=\"-understanding\" style=\"position:relative;\"><a href=\"#-understanding\" aria-label=\" understanding permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ¤” Understanding</h2>\n<p>ìŠµê´€ì²˜ëŸ¼ ì‚¬ìš©í•˜ê³  ìˆì—ˆë˜ ëª…ë ¹ì–´ë“¤ì„ ì´ì   ì–´ë– í•œ ì´ìœ ë¡œ ì¸í•´ ì‚¬ìš© í•´ì•¼í•˜ëŠ”ì§€ ì•Œê³  ì“¸ ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤.</p>\n<p>Nest CLI ëª…ë ¹ì–´ëŠ” ì—¬ëŸ¬ ê°œë°œ í¸ì˜ ì˜µì…˜ë“¤ì„ ì§€ì› í•˜ê³  ë³„ë„ì˜ ë¹Œë“œ ê³¼ì •ì—†ì´ ë¹ ë¥¸ ì‹¤í–‰ì„ ê°€ëŠ¥í•˜ê²Œ í•œë‹¤ëŠ” ì ì€ ì•Œê³  ìˆì—ˆì§€ë§Œ, ì„¸ë¶€ì ì¸ ì½”ë“œ íë¦„ì„ ëˆˆìœ¼ë¡œ ë³´ë‹ˆ ì™œ ì´ˆê¸°í™” ë‹¨ê³„ì—ì„œ ì™œ ë†’ì€ CPU ì‚¬ìš©ëŸ‰ê³¼ ë©”ëª¨ë¦¬ ì ìœ ìœ¨ì„ ë³´ì´ëŠ”ì§€ ì´í•´í•  ìˆ˜ ìˆì—ˆë‹¤.</p>\n<br>\r\n<br>\n<div class=\"gatsby-highlight\" data-language=\"toc\"><pre class=\"language-toc\"><code class=\"language-toc\"></code></pre></div>","frontmatter":{"date":"2025.03.19","title":"Nest CLI ëœ¯ì–´ë³´ê¸° (nest start)","categories":"TIL","author":"JH8459","emoji":"ğŸ“š"},"fields":{"slug":"/2025-03-19-TIL/"}},"site":{"siteMetadata":{"siteUrl":"https://blog.jh8459.com","comments":{"utterances":{"repo":"JH8459/JH8459.github.io"}}}}},"pageContext":{"slug":"/2025-03-16-TIL/","nextSlug":"/2025-03-13-TIL/","prevSlug":"/2025-03-19-TIL/"}},"staticQueryHashes":["1073350324","1956554647","2938748437"],"slicesMap":{}}