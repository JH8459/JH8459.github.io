{"componentChunkName":"component---src-templates-blog-template-tsx","path":"/2026-02-15-JAVASCRIPT/","result":{"data":{"cur":{"id":"49a4546e-b13a-5cc0-9712-2ca3b1e7535e","html":"<img src=\"https://jh8459.s3.ap-northeast-2.amazonaws.com/blog/2026-02-15/JAVASCRIPT/thumbnail.png\">\n<h2 id=\"-overview\" style=\"position:relative;\"><a href=\"#-overview\" aria-label=\" overview permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📚 Overview</h2>\n<p>Map을 쓰다 보면 “키가 없으면 기본값을 넣고, 그 값을 바로 사용한다”는 패턴을 끝없이 반복하게 된다. 이 패턴은 간단하지만 코드가 지저분해지고, 팀마다 구현 방식이 달라지면서 가독성이 더 떨어진다.</p>\n<p><strong>Map.prototype.getOrInsert()</strong> / <strong>getOrInsertComputed()</strong> 는 이 반복을 표준 API로 정리한다. 이 기능은 ECMAScript 2026 스펙에 포함될 예정이며, 이제 출시를 앞둔 시점이다. 오래 기다렸던 만큼 사용법과 주의점, 그리고 안전하게 도입하는 요령을 정리해두려 한다.</p>\n<blockquote>\n<p>“없으면 넣고 꺼내기”는 사소한 개선처럼 보이지만, 서비스 코드에서는 가장 자주 등장하는 반복 중 하나다.</p>\n</blockquote>\n<br>\n<br>\n<h3 id=\"1-map을-사용할-때-가장-많이-반복되는-코드가-있다\" style=\"position:relative;\"><a href=\"#1-map%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%A0-%EB%95%8C-%EA%B0%80%EC%9E%A5-%EB%A7%8E%EC%9D%B4-%EB%B0%98%EB%B3%B5%EB%90%98%EB%8A%94-%EC%BD%94%EB%93%9C%EA%B0%80-%EC%9E%88%EB%8B%A4\" aria-label=\"1 map을 사용할 때 가장 많이 반복되는 코드가 있다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Map을 사용할 때 가장 많이 반복되는 코드가 있다</h3>\n<hr>\n<p>대부분의 코드베이스에서 Map을 쓰는 이유는 명확하다. “키 → 값” 관계를 빠르게 조회하고 싶기 때문이다. 문제는 값이 없는 경우다.</p>\n<p>예를 들어, 그룹핑(카테고리별로 리스트 만들기)을 구현하면 대개 이런 코드가 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> groups <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>category<span class=\"token punctuation\">,</span> item<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>groups<span class=\"token punctuation\">.</span><span class=\"token function\">has</span><span class=\"token punctuation\">(</span>category<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    groups<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>category<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  groups<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>category<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 패턴의 본질은 단순하다.</p>\n<ul>\n<li>키가 있으면 기존 값을 가져온다.</li>\n<li>키가 없으면 기본값을 넣는다.</li>\n<li>그 값을 반환받아 이어서 사용한다.</li>\n</ul>\n<p>하지만 표현은 늘 장황하다. has → set → get이 함께 묶여 다닌다.</p>\n<p>실수도 자주 발생한다. set만 하고 get을 빼먹거나, if/else가 늘어나거나, 기본값 생성이 비싸도 무조건 실행되는 형태가 만들어진다.</p>\n<br>\n<br>\n<h3 id=\"2-getorinsert는-의도를-코드로-직접-드러낸다\" style=\"position:relative;\"><a href=\"#2-getorinsert%EB%8A%94-%EC%9D%98%EB%8F%84%EB%A5%BC-%EC%BD%94%EB%93%9C%EB%A1%9C-%EC%A7%81%EC%A0%91-%EB%93%9C%EB%9F%AC%EB%82%B8%EB%8B%A4\" aria-label=\"2 getorinsert는 의도를 코드로 직접 드러낸다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. getOrInsert는 “의도”를 코드로 직접 드러낸다</h3>\n<hr>\n<p>ECMAScript 2026에는 아래 메서드가 추가된다.</p>\n<ul>\n<li>Map.prototype.getOrInsert(key, value)</li>\n<li>Map.prototype.getOrInsertComputed(key, fn)</li>\n<li>WeakMap.prototype.getOrInsert(key, value)</li>\n<li>WeakMap.prototype.getOrInsertComputed(key, fn)</li>\n</ul>\n<p>핵심 동작은 이렇게 정리된다.</p>\n<ul>\n<li>키가 있으면 기존 값을 반환한다.</li>\n<li>키가 없으면 새 값을 넣고 그 값을 반환한다.</li>\n<li>기존 값을 덮어쓰지 않는다.</li>\n</ul>\n<br>\n<p><strong>getOrInsert()</strong> 는 아래 코드와 같은 의미다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>map<span class=\"token punctuation\">.</span><span class=\"token function\">has</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nmap<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> defaultValue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">return</span> defaultValue<span class=\"token punctuation\">;</span></code></pre></div>\n<p>이제 그룹핑 코드는 이렇게 바뀐다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> groups <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>category<span class=\"token punctuation\">,</span> item<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  groups<span class=\"token punctuation\">.</span><span class=\"token function\">getOrInsertComputed</span><span class=\"token punctuation\">(</span>category<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>조건문이 사라지고, “없으면 생성해서 넣는다”는 의도가 코드에 직접 드러나기 때문에 읽는 사람이 코드의 목적을 더 빨리 이해할 수 있다.</p>\n<br>\n<br>\n<h3 id=\"3-getorinsert와-getorinsertcomputed의-차이\" style=\"position:relative;\"><a href=\"#3-getorinsert%EC%99%80-getorinsertcomputed%EC%9D%98-%EC%B0%A8%EC%9D%B4\" aria-label=\"3 getorinsert와 getorinsertcomputed의 차이 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. getOrInsert와 getOrInsertComputed의 차이</h3>\n<hr>\n<p>두 메서드는 비슷해 보이지만, 용도가 명확히 갈린다.</p>\n<ul>\n<li>\n<p><strong>getOrInsert(key, value)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> map <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nmap<span class=\"token punctuation\">.</span><span class=\"token function\">getOrInsert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mode\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dark\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// \"dark\"</span>\nmap<span class=\"token punctuation\">.</span><span class=\"token function\">getOrInsert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mode\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"light\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// \"dark\" (기존 값이 있으므로 덮어쓰지 않음)</span>\nmap<span class=\"token punctuation\">.</span><span class=\"token function\">getOrInsert</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> <span class=\"token function\">expensive</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 주의 필요</span></code></pre></div>\n<p>여기서 동작을 정확히 이해해야 한다. getOrInsert는 “키가 없을 때 값을 삽입”하지만, 함수 인자는 호출 전에 평가된다. 따라서 <code class=\"language-text\">getOrInsert(key, expensive())</code>는 키가 있어도 <code class=\"language-text\">expensive()</code>가 실행된다. <code class=\"language-text\">expensive()</code>가 값이 비싼 함수라면, 지연 생성이 필요하며 그럴 경우엔 <code class=\"language-text\">getOrInsertComputed(key, fn)</code>을 사용해야 한다.</p>\n</li>\n</ul>\n<br>\n<ul>\n<li>\n<p><strong>getOrInsertComputed(key, fn)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\">map<span class=\"token punctuation\">.</span><span class=\"token function\">getOrInsertComputed</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"config\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">loadBigConfig</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>getOrInsertComputed는 키가 없을 때만 fn을 실행한다. 기본값 생성이 비싸거나(파일 읽기, 파싱, 큰 객체 생성) 부작용이 있으면(로그 남김, 외부 호출) getOrInsertComputed()를 쓰는 편이 맞다.</p>\n</li>\n</ul>\n<br>\n<br>\n<h3 id=\"4-바로-쓰는-예제-2가지\" style=\"position:relative;\"><a href=\"#4-%EB%B0%94%EB%A1%9C-%EC%93%B0%EB%8A%94-%EC%98%88%EC%A0%9C-2%EA%B0%80%EC%A7%80\" aria-label=\"4 바로 쓰는 예제 2가지 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. 바로 쓰는 예제 2가지</h3>\n<hr>\n<h4 id=\"4-1-그룹핑멀티맵\" style=\"position:relative;\"><a href=\"#4-1-%EA%B7%B8%EB%A3%B9%ED%95%91%EB%A9%80%ED%8B%B0%EB%A7%B5\" aria-label=\"4 1 그룹핑멀티맵 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4-1. 그룹핑(멀티맵)</h4>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> groups <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>category<span class=\"token punctuation\">,</span> item<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  groups<span class=\"token punctuation\">.</span><span class=\"token function\">getOrInsertComputed</span><span class=\"token punctuation\">(</span>category<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"db\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"PostgreSQL\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"db\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Redis\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"lang\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"JavaScript\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>groups<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"db\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// [\"PostgreSQL\", \"Redis\"]</span></code></pre></div>\n<p>“없으면 배열을 만들고, 있으면 기존 배열을 쓰고, 바로 push한다”가 한 줄로 표현된다.</p>\n<br>\n<br>\n<h4 id=\"4-2-카운터집계-만들기\" style=\"position:relative;\"><a href=\"#4-2-%EC%B9%B4%EC%9A%B4%ED%84%B0%EC%A7%91%EA%B3%84-%EB%A7%8C%EB%93%A4%EA%B8%B0\" aria-label=\"4 2 카운터집계 만들기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4-2. 카운터/집계 만들기</h4>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> counts <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">hit</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  counts<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> counts<span class=\"token punctuation\">.</span><span class=\"token function\">getOrInsert</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">hit</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"login\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">hit</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"login\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">hit</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"purchase\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>counts<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"login\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 2</span></code></pre></div>\n<p>이 패턴은 각종 집계(이벤트 집계, 상태 카운팅)에 그대로 쓸 수 있다.</p>\n<br>\n<br>\n<h3 id=\"5-주의점이-있다\" style=\"position:relative;\"><a href=\"#5-%EC%A3%BC%EC%9D%98%EC%A0%90%EC%9D%B4-%EC%9E%88%EB%8B%A4\" aria-label=\"5 주의점이 있다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. 주의점이 있다</h3>\n<p>이 기능은 단순하지만, 자주 밟는 함정이 존재한다.</p>\n<ul>\n<li>\n<p><strong>getOrInsert(key, [])</strong> 는 “불필요한 객체 생성”이 반복될 수 있다</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\">map<span class=\"token punctuation\">.</span><span class=\"token function\">getOrInsert</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 불필요한 객체 생성이 반복될 수 있다.</span>\nmap<span class=\"token punctuation\">.</span><span class=\"token function\">getOrInsertComputed</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>키가 이미 있어도 []는 호출 시점마다 생성된다. 사용되지 않아도 객체 생성 비용은 남는다. 이 경우는 아래가 정답이다.</p>\n</li>\n</ul>\n<br>\n<ul>\n<li>\n<p>“키가 없는 것”과 “값이 <strong>undefined</strong> 인 것”은 다르다</p>\n<p><code class=\"language-text\">Map</code>은 값으로 <code class=\"language-text\">undefined</code>를 가질 수 있다. 따라서 아래 패턴은 의도와 다르게 동작할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\">map<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 이 패턴은 \"undefined면 default\"로 취급한다.</span>\n<span class=\"token comment\">// 그런데 \"키는 있지만 값이 undefined\"인 경우까지 default로 바꿔버린다.</span>\nmap<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">,</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">??</span> <span class=\"token string\">\"default\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>getOrInsert()는 <strong>값이 아니라 “키 존재 여부”</strong> 로 판단하므로 이 점을 주의하자.</p>\n</li>\n</ul>\n<p>스펙에 포함되었다고 해서 바로 사용할 수 있는 것은 아니다. 실제 사용 가능 여부는 브라우저와 Node 버전에 따라 달라진다. 따라서 도입 전에 지원 여부를 먼저 확인하는 편이 안전하다.</p>\n<br>\n<br>\n<h3 id=\"6-최신-스펙을-미리-알아보는-방법\" style=\"position:relative;\"><a href=\"#6-%EC%B5%9C%EC%8B%A0-%EC%8A%A4%ED%8E%99%EC%9D%84-%EB%AF%B8%EB%A6%AC-%EC%95%8C%EC%95%84%EB%B3%B4%EB%8A%94-%EB%B0%A9%EB%B2%95\" aria-label=\"6 최신 스펙을 미리 알아보는 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. 최신 스펙을 미리 알아보는 방법</h3>\n<hr>\n<p>스펙을 깊게 파는 것보다, “변화의 신호”를 빨리 잡는 편이 효율적이다. 아래 루틴만 챙겨도 대부분의 새 기능은 놓치지 않는다.</p>\n<h3 id=\"6-1-github는-관심-키워드만-star로-모아둔다\" style=\"position:relative;\"><a href=\"#6-1-github%EB%8A%94-%EA%B4%80%EC%8B%AC-%ED%82%A4%EC%9B%8C%EB%93%9C%EB%A7%8C-star%EB%A1%9C-%EB%AA%A8%EC%95%84%EB%91%94%EB%8B%A4\" aria-label=\"6 1 github는 관심 키워드만 star로 모아둔다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6-1. GitHub는 “관심 키워드만” Star로 모아둔다</h3>\n<p>GitHub는 스펙 변화가 가장 먼저 모이는 곳이다. 다만 모든 Discussion을 따라가려 하면 금방 지친다. 그래서 나는 “인덱스 저장소 + 관심 제안 저장소”만 Star로 모아두는 방식으로 관리한다.</p>\n<p>먼저, 기준이 되는 인덱스 2개만 잡아둔다.</p>\n<ul>\n<li><a href=\"https://github.com/tc39/proposals\">tc39/proposals</a>는 진행 중인 ECMAScript 제안들을 추적하는 목록이다.</li>\n<li><a href=\"https://github.com/tc39/ecma262\">tc39/ecma262</a>는 표준 스펙 본문이 모이는 저장소이며, 제안은 proposals에서 관리된다는 안내가 들어 있다.</li>\n</ul>\n<p>그리고 “내가 관심 있는 기능”만 추가로 Star한다. 예를 들어 이번 글의 주제는 아래 저장소에서 시작했다.</p>\n<blockquote>\n<p>tc39/proposal-upsert (결과적으로 getOrInsert / getOrInsertComputed로 정리된 제안)</p>\n</blockquote>\n<p>GitHub는 Star한 저장소를 List로 분류할 수 있다. 나는 이 기능을 Spec Radar 같은 이름으로 써서 관심 있는 스펙 관련 저장소만 따로 모아둔다. 아래는 내가 샘플로 Star해서 Spec Radar 리스트에 넣어둔 구성 예시다. (관심사에 맞게 바꾸면 된다.)</p>\n<img src=\"https://jh8459.s3.ap-northeast-2.amazonaws.com/blog/2026-02-15/JAVASCRIPT/radar.png\">\n<p>이 정도만 모아둬도 “요즘 자바스크립트가 어디로 가는지” 감이 생긴다.</p>\n<p>추가로, 알림(Watch)은 최소로 켜는 편이 낫다. 알림이 많아지면 결국 다 꺼버리게 된다. 그래서 나는 Star + 리스트로 정리하고, 정말 관심 있는 저장소만 선별적으로 Watch한다.</p>\n<br>\n<h3 id=\"6-2-결국은-런타임-릴리즈-노트를-본다\" style=\"position:relative;\"><a href=\"#6-2-%EA%B2%B0%EA%B5%AD%EC%9D%80-%EB%9F%B0%ED%83%80%EC%9E%84-%EB%A6%B4%EB%A6%AC%EC%A6%88-%EB%85%B8%ED%8A%B8%EB%A5%BC-%EB%B3%B8%EB%8B%A4\" aria-label=\"6 2 결국은 런타임 릴리즈 노트를 본다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6-2. 결국은 런타임 릴리즈 노트를 본다</h3>\n<p>스펙에 들어갔다고 끝이 아니다. 실제로는 브라우저/Node 릴리즈에 들어가는 순간부터가 실전이다. 따라서 “내가 배포하는 런타임”의 릴리즈 노트를 가끔 훑는 습관이 가장 강력하다. 스펙보다 런타임이 더 현실이다.</p>\n<br>\n<br>\n<h2 id=\"-understanding\" style=\"position:relative;\"><a href=\"#-understanding\" aria-label=\" understanding permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🤔 Understanding</h2>\n<p><strong>Map.getOrInsert()</strong> 는 거대한 기능이 아니다. 하지만 언어가 가는 방향을 또렷하게 보여주는 변화다. 자바스크립트는 계속해서 “가능은 했지만 늘 장황했던 패턴”을 표준 API로 끌어올리고 있다. 그 결과 코드의 의도가 더 명확해진다는 점이 중요하다.</p>\n<p>비슷한 경험을 ES2024의 <strong>Object.groupBy / Map.groupBy</strong> 에서도 느꼈다.</p>\n<blockquote>\n<p><a href=\"https://blog.jh8459.com/2025-11-08-JAVASCRIPT/\">Object.groupBy / Map.groupBy (ES2024)</a></p>\n</blockquote>\n<p>과거에는 그룹핑을 하려면 <code class=\"language-text\">reduce</code>로 누적 객체를 만들고, 키가 없으면 초기화하고, 그 다음 push하는 흐름을 직접 작성해야 했다. 동작 자체는 단순했지만 표현이 길고, 구현 방식도 팀마다 달랐다. <code class=\"language-text\">groupBy</code>가 들어오면서 “그룹핑을 한다”는 의도가 코드에 직접 드러나기 시작했다.</p>\n<p>이번 getOrInsert도 같은 결이다. has → set → get을 반복하는 대신 “없으면 넣고 꺼낸다”는 의도가 한 줄로 고정된다. 특히 getOrInsertComputed는 기본값 생성 비용까지 의도에 맞게 지연시키면서, 코드가 말하고자 하는 바를 더 정확히 표현한다.</p>\n<p>이런 변화가 마음에 든다. 자바스크립트는 여전히 유연한 언어이지만, 자주 쓰는 패턴을 표준 API로 정리해 읽는 사람 중심의 코드로 유도하고 있다. 구현을 숨기는 것이 아니라, 반복되는 의도를 공통 언어로 올려주는 방향이다. groupBy와 getOrInsert는 그 흐름을 잘 보여주는 한 쌍의 사례라 생각된다.</p>\n<br>\n<br>","excerpt":"📚 Overview Map을 쓰다 보면 “키가 없으면 기본값을 넣고, 그 값을 바로 사용한다”는 패턴을 끝없이 반복하게 된다. 이 패턴은 간단하지만 코드가 지저분해지고, 팀마다 구현 방식이 달라지면서 가독성이 더 떨어진다. Map.prototype.getOrInsert() / getOrInsertComputed() 는 이 반복을 표준 API로 정리한다. 이 기능은 ECMAScript 2026 스펙에 포함될 예정이며, 이제 출시를 앞둔 시점이다. 오래 기다렸던 만큼 사용법과 주의점, 그리고 안전하게 도입하는 요령을 정리해두려 한다. “없으면 넣고 꺼내기”는 사소한 개선처럼 보이지만, 서비스 코드에서는 가장 자주 등장하는 반복 중 하나다. 1. Map을 사용할 때 가장 많이 반복되는 코드가 있다 대부분의 코드베이스에서 Map을 쓰는 이유는 명확하다. “키 → 값” 관계를 빠르게 조회하고 싶기 때문이다. 문제는 값이 없는 경우다. 예를 들어, 그룹핑(카테고리별로 리스트 만들기)을 구현하…","timeToRead":4,"tableOfContents":"<ul>\n<li>\n<p><a href=\"#-overview\">📚 Overview</a></p>\n<ul>\n<li>\n<p><a href=\"#1-map%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%A0-%EB%95%8C-%EA%B0%80%EC%9E%A5-%EB%A7%8E%EC%9D%B4-%EB%B0%98%EB%B3%B5%EB%90%98%EB%8A%94-%EC%BD%94%EB%93%9C%EA%B0%80-%EC%9E%88%EB%8B%A4\">1. Map을 사용할 때 가장 많이 반복되는 코드가 있다</a></p>\n</li>\n<li>\n<p><a href=\"#2-getorinsert%EB%8A%94-%EC%9D%98%EB%8F%84%EB%A5%BC-%EC%BD%94%EB%93%9C%EB%A1%9C-%EC%A7%81%EC%A0%91-%EB%93%9C%EB%9F%AC%EB%82%B8%EB%8B%A4\">2. getOrInsert는 “의도”를 코드로 직접 드러낸다</a></p>\n</li>\n<li>\n<p><a href=\"#3-getorinsert%EC%99%80-getorinsertcomputed%EC%9D%98-%EC%B0%A8%EC%9D%B4\">3. getOrInsert와 getOrInsertComputed의 차이</a></p>\n</li>\n<li>\n<p><a href=\"#4-%EB%B0%94%EB%A1%9C-%EC%93%B0%EB%8A%94-%EC%98%88%EC%A0%9C-2%EA%B0%80%EC%A7%80\">4. 바로 쓰는 예제 2가지</a></p>\n<ul>\n<li><a href=\"#4-1-%EA%B7%B8%EB%A3%B9%ED%95%91%EB%A9%80%ED%8B%B0%EB%A7%B5\">4-1. 그룹핑(멀티맵)</a></li>\n<li><a href=\"#4-2-%EC%B9%B4%EC%9A%B4%ED%84%B0%EC%A7%91%EA%B3%84-%EB%A7%8C%EB%93%A4%EA%B8%B0\">4-2. 카운터/집계 만들기</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#5-%EC%A3%BC%EC%9D%98%EC%A0%90%EC%9D%B4-%EC%9E%88%EB%8B%A4\">5. 주의점이 있다</a></p>\n</li>\n<li>\n<p><a href=\"#6-%EC%B5%9C%EC%8B%A0-%EC%8A%A4%ED%8E%99%EC%9D%84-%EB%AF%B8%EB%A6%AC-%EC%95%8C%EC%95%84%EB%B3%B4%EB%8A%94-%EB%B0%A9%EB%B2%95\">6. 최신 스펙을 미리 알아보는 방법</a></p>\n</li>\n<li>\n<p><a href=\"#6-1-github%EB%8A%94-%EA%B4%80%EC%8B%AC-%ED%82%A4%EC%9B%8C%EB%93%9C%EB%A7%8C-star%EB%A1%9C-%EB%AA%A8%EC%95%84%EB%91%94%EB%8B%A4\">6-1. GitHub는 “관심 키워드만” Star로 모아둔다</a></p>\n</li>\n<li>\n<p><a href=\"#6-2-%EA%B2%B0%EA%B5%AD%EC%9D%80-%EB%9F%B0%ED%83%80%EC%9E%84-%EB%A6%B4%EB%A6%AC%EC%A6%88-%EB%85%B8%ED%8A%B8%EB%A5%BC-%EB%B3%B8%EB%8B%A4\">6-2. 결국은 런타임 릴리즈 노트를 본다</a></p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#-understanding\">🤔 Understanding</a></p>\n</li>\n</ul>","frontmatter":{"date":"2026.02.15","title":"Map에 드디어 생긴 getOrInsert: “없으면 넣고, 있으면 꺼내기”","categories":"JavaScript","author":"JH8459","emoji":"📚"},"fields":{"slug":"/2026-02-15-JAVASCRIPT/"}},"next":{"id":"311855c8-7c8c-5833-946b-fae867cd3363","frontmatter":{"date":"2026.01.06","title":"이벤트 소싱을 적용하기 전에 반드시 고민해봤어야 할 것들","categories":"Backend","author":"JH8459","emoji":"📚"},"fields":{"slug":"/2026-01-06-BACKEND/"}},"prev":null,"site":{"siteMetadata":{"siteUrl":"https://blog.jh8459.com","comments":{"giscus":{"repo":"JH8459/JH8459.github.io","repoId":"R_kgDOI03HgA","category":"Comments","categoryId":"DIC_kwDOI03HgM4CtuXL"}}}}},"pageContext":{"slug":"/2026-02-15-JAVASCRIPT/","nextSlug":"/2026-01-06-BACKEND/","prevSlug":""}},"staticQueryHashes":["1073350324","1918895448","327795442","962130685"],"slicesMap":{}}